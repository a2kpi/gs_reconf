if (undefined === window.Kameleoon){Kameleoon={processOmniture:function(a){Kameleoon.API.processOmniture(a)}};Kameleoon.API={runWhenElementPresent:function(a,c,b){var d=Kameleoon.Utils.querySelectorAll(a);if(0<d.length){Kameleoon.Utils.runProtectedFunction(c)}else{if(!Kameleoon.Internals.pageLoaded){window.setTimeout(function(){Kameleoon.API.runWhenElementPresent.apply(Kameleoon,[a,c,b])},b?b:200)}}},runWhenConditionTrue:function(b,c,a){if(b()){Kameleoon.Utils.runProtectedFunction(c)}else{if(!Kameleoon.Internals.pageLoaded){window.setTimeout(function(){Kameleoon.API.runWhenConditionTrue.apply(Kameleoon,[b,c,a])},a?a:200)}}},processRedirect:function(b,a){if(window.location.href!=b){if(Kameleoon.Internals.configuration.googleAnalytics&&Kameleoon.Internals.gathererRun&&(1==Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.timesStartedPages.length)){b=Kameleoon.Utils.addParameterToURL(b,"utm_referrer="+encodeURIComponent(document.referrer),Kameleoon.Internals.configuration.googleAnalyticsAllowAnchor)}if(Kameleoon.Internals.configuration.adobeOmniture&&Kameleoon.Internals.configuration.adobeOmniture.anchorReferrer&&Kameleoon.Internals.gathererRun&&(1==Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.timesStartedPages.length)){b=Kameleoon.Utils.addParameterToURL(b,"sc_referrer="+encodeURIComponent(document.referrer),true)}if(a){b=Kameleoon.Utils.addParameterToURL(b,"kameleoonAVTE-"+Kameleoon.API.currentContainer.id+"="+Kameleoon.API.currentContainer.registeredVariation.id,true);b=Kameleoon.Utils.addParameterToURL(b,"kameleoonRedirect-"+Kameleoon.API.currentContainer.id+"=true",true)}if(window.location.href!=b){Kameleoon.Utils.createLocalData("kameleoonRedirect-"+Kameleoon.API.currentContainer.id,window.location.href,1,null,null,false);Kameleoon.API.forceNoFlicker("*");Kameleoon.Internals.Analyst.applyRedirect=true;window.location.replace(b)}}},triggerEvent:function(a){Kameleoon.API.runWhenConditionTrue(function(){return Kameleoon.Internals.setupAfterLocalDataRetrieval===true},function(){Kameleoon.API.events.push(a);Kameleoon.Analyst.processAllContainers();if(Kameleoon.Internals.simulationMode&&Kameleoon.Loader.refreshTargetingPanel){Kameleoon.Loader.refreshTargetingPanel()}},100)},processConversion:function(e,a){var g=Kameleoon.Internals.configuration.goals;for(var f=0,b=g.length;f<b;++f){var h=g[f];if((e==h.id)||(e==h.name)){var c=[{goal:h,revenue:a}];if(!h.linkedExperimentId){for(var d=0;d<b;++d){var k=g[d];if(k.linkedExperimentId&&(k.masterGoalId==h.id)){c.push({goal:k,revenue:a})}}}Kameleoon.Analyst.processConversions(c);break}}},processOmniture:function(d){if(Kameleoon.API.experiments){for(var c=0,b=Kameleoon.API.experiments.length;c<b;++c){var a=Kameleoon.API.experiments[c];if(a.adobeOmnitureTracking&&a.adobeOmnitureTracking.active){if(a.adobeOmnitureTracking.omnitureAlreadyLoaded){d.linkTrackVars=((!d.linkTrackVars||"None"==d.linkTrackVars)?"":(d.linkTrackVars+","))+"eVar"+a.adobeOmnitureTracking.eVar}d["eVar"+a.adobeOmnitureTracking.eVar]=a.name+" / "+a.registeredVariation.name}}}},waitToProcessElements:function(b,d){if(!(b instanceof Array)){b=[b]}var e=[];for(var h=0,c=b.length;h<c;++h){var g=null;for(var f=0,a=Kameleoon.Internals.pageElementSets.length;f<a;++f){if(Kameleoon.Internals.pageElementSets[f].selector==b[h]){g=f;break}}if(null!==g){e.push(Kameleoon.Internals.pageElementSets[g])}}if(!Kameleoon.Analyst.setupDOMStructure({elementSets:e},false,false,false)&&!Kameleoon.Internals.pageLoaded){window.setTimeout(function(){Kameleoon.API.waitToProcessElements.apply(Kameleoon,[b,d])},d?d:200)}},forceNoFlicker:function(c){var b=document.createElement("style");b.setAttribute("id","kameleoonPageLoading");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("media","screen");var a=c+" { visibility: hidden !important; background-image: none !important; }";if(b.styleSheet){b.styleSheet.cssText=a}else{b.appendChild(document.createTextNode(a))}Kameleoon.Internals.headNode.appendChild(b)},refresh:function(){Kameleoon.Analyst.refreshForScreenResize()},loadScriptSequentially:function(b){if(b){var a=document.createElement("script");a.src=b;a.setAttribute("onload","Kameleoon.API.loadScriptSequentially();");Kameleoon.Internals.waitingScripts.push(a);if(1==Kameleoon.Internals.waitingScripts.length){Kameleoon.Internals.headNode.appendChild(Kameleoon.Internals.waitingScripts[0])}}else{Kameleoon.Internals.waitingScripts.shift();if(0<Kameleoon.Internals.waitingScripts.length){Kameleoon.Internals.headNode.appendChild(Kameleoon.Internals.waitingScripts[0])}}},processPageLoaded:function(){Kameleoon.Internals.pageLoaded=true;Kameleoon.Utils.removeBlockingStyleSheet();for(var b=0,a=Kameleoon.Internals.configuration.variations.length;b<a;++b){if(Kameleoon.Internals["enginePollerForVariation"+Kameleoon.Internals.configuration.variations[b].id]){window.clearInterval(Kameleoon.Internals["enginePollerForVariation"+Kameleoon.Internals.configuration.variations[b].id]);Kameleoon.Internals["enginePollerForVariation"+Kameleoon.Internals.configuration.variations[b].id]=null}}},setCustomData:function(c,g,f){if(Kameleoon.Internals.gathererRun){var e=Kameleoon.Internals.configuration.Gatherer;var b=null;for(var d=0,a=e.customData.length;d<a;++d){if(e.customData[d].name==c){b=d;break}}if(b!=null){if(f==null){f=false}Kameleoon.Gatherer.trackCustomData([b],[g],[f])}}}};Kameleoon.Analyst={load:function(){Kameleoon.Utils.domReady(function(){Kameleoon.Internals.domReady=true});if(!Kameleoon.Internals.configuration.useWideDomainSupport){try{if(window.localStorage){localStorage.setItem("kameleoonPrivateMode","false");localStorage.removeItem("kameleoonPrivateMode")}else{Kameleoon.Internals.noLocalStorage=true}}catch(b){Kameleoon.Internals.noLocalStorage=true}}try{var a;Kameleoon.Utils.createLocalData("kameleoonTestCookie","test",null,"CURRENT_HOST","COOKIE",false,null,true);if(Kameleoon.Utils.readLocalData("kameleoonTestCookie","COOKIE",false)!="test"){a=false}else{a=true;Kameleoon.Utils.eraseLocalData("kameleoonTestCookie","CURRENT_HOST","COOKIE")}if(!a){Kameleoon.Internals.noCookie=true}}catch(b){Kameleoon.Internals.noCookie=true}if(window.kameleoonDisplayPage){if(!Kameleoon.Internals.configuration.disableWhenTimeout||document.getElementById("kameleoonLoadingStyleSheet")){window.clearTimeout(window.kameleoonDisplayPageTimeOut)}else{if(!Kameleoon.Internals.noLocalStorage&&Kameleoon.Internals.configuration.disableVisitWhenTimeout){sessionStorage.setItem("kameleoonDisableForVisit","true")}}try{window.kameleoonDisplayPage()}catch(b){}}if(Kameleoon.Internals.noLocalStorage||Kameleoon.Internals.noCookie||sessionStorage.getItem("kameleoonDisableForVisit")){return}this.setupKameleoon(Kameleoon.Internals.configuration.siteCode,Kameleoon.Internals.configuration.memberCode)},setupKameleoon:function(k,h){Kameleoon.Internals.environment="PRODUCTION";Kameleoon.Internals.QOOXDOO_ESTIMATED_LOADING_TIME=2000;Kameleoon.Internals.SERVER_CALL_ESTIMATED_LOADING_TIME=500;Kameleoon.Internals.GUI_ESTIMATED_LOADING_TIME=3000;Kameleoon.Internals.DOMAIN="kameleoon.com";Kameleoon.Internals.BASE_EDITOR_URL="//static."+Kameleoon.Internals.DOMAIN+"/js/editor/";Kameleoon.Internals.NIRROR_SITECODE="555483a6e8760e9f08a8c1c8";if(Kameleoon.Internals.Analyst==null){Kameleoon.Internals.Analyst={}}if(Kameleoon.Internals.configuration.localDataLegalControl&&(Kameleoon.Utils.readLocalData("kameleoonLocalDataConsent","LS",false)==null)&&((Kameleoon.Internals.configuration.localDataConsentCookieName==null)||(Kameleoon.Utils.readLocalData(Kameleoon.Internals.configuration.localDataConsentCookieName,"COOKIE",false)==null))){Kameleoon.Internals.saveLocalDataAllowed=false;Kameleoon.Internals.allowSaveLocalData=function(){document.removeEventListener("mousedown",Kameleoon.Internals.allowSaveLocalData,false);window.removeEventListener("scroll",Kameleoon.Internals.allowSaveLocalData,false);Kameleoon.Internals.saveLocalDataAllowed=true;Kameleoon.Utils.createLocalData("kameleoonLocalDataConsent",true,1000,null,"LS",false,null,true);var e=(Kameleoon.Internals.localDataMap==null?null:Kameleoon.Internals.localDataMap.LS);var j=(Kameleoon.Internals.localDataMap==null?null:Kameleoon.Internals.localDataMap.COOKIE);if(e!=null){for(var i in e){Kameleoon.Utils.createLocalData(e[i].name,e[i].value,e[i].days,e[i].domain,e[i].forceLocalAccess,e[i].jsonFormat,null,true)}}if(j!=null){for(var i in j){Kameleoon.Utils.createLocalData(j[i].name,j[i].value,j[i].days,j[i].domain,j[i].forceLocalAccess,j[i].jsonFormat,null,true)}}Kameleoon.Internals.localDataMap=null}.bind(this);document.addEventListener("mousedown",Kameleoon.Internals.allowSaveLocalData,false);window.addEventListener("scroll",Kameleoon.Internals.allowSaveLocalData,false)}else{Kameleoon.Internals.saveLocalDataAllowed=true}Kameleoon.Internals.JS_EDITOR_URL=Kameleoon.Internals.BASE_EDITOR_URL+"script/editor.js";Kameleoon.Internals.EDITOR_HOST_NAME = "editor";Kameleoon.Internals.PAGE_LOADING_POLL_DELAY=75;Kameleoon.Internals.PAGE_LOADED_POLL_DELAY=250;Kameleoon.Internals.GEOLOCATION_URL="//tracker.kameleoon.com/geolocation.gif?";Kameleoon.Internals.internetExplorer=bowser.msie;Kameleoon.Internals.modernInternetExplorer=Kameleoon.Internals.internetExplorer&&(bowser.version>=10);Kameleoon.Internals.unsupportedBrowser=(Kameleoon.Internals.internetExplorer&&(bowser.version<9))||(bowser.opera&&(bowser.version<13));Kameleoon.Internals.parameters=Kameleoon.Utils.parseParameters();Kameleoon.Internals.siteCode=k;if(Kameleoon.Internals.parameters.kameleoonOptout){Kameleoon.Utils.createLocalData("kameleoonOptout",true,45,null,"COOKIE",false)}if(Kameleoon.Internals.configuration.checkTraffic){if(!Kameleoon.Utils.readLocalData("kameleoonTraffic","COOKIE",false)){var a="//server1.counter."+Kameleoon.Internals.DOMAIN+"/_.gif?siteCode="+Kameleoon.Internals.siteCode+"&totalTraffic=true";Kameleoon.Utils.performBeaconServerCall(a);Kameleoon.Utils.createLocalData("kameleoonTraffic","true",30,null,"COOKIE",false)}}if(this.shouldAbortSetup()){return}if(Kameleoon.Internals.configuration.goals==null){Kameleoon.Internals.configuration.goals=[]}var g=Kameleoon.Internals.configuration.goals;for(var d=0,b=g.length;d<b;++d){var m=g[d];if(!m.linkedExperimentId){for(var c=0;c<b;++c){var o=g[c];if(o.linkedExperimentId&&(o.masterGoalId==m.id)){for(var n in m){if((n!="id")&&(n!="mentalistWeight")&&(n!="masterGoalId")&&(n!="masterGoalName")&&(n!="linkedExperimentId")){o[n]=m[n]}}}}}}if((Kameleoon.Mentalist!=null)&&(!Kameleoon.Mentalist.computeIsSecure())){Kameleoon.Mentalist=null}Kameleoon.Internals.headNode=document.getElementsByTagName("head")[0];Kameleoon.Internals.waitingScripts=[];Kameleoon.Internals.pageElementSets=[];Kameleoon.Internals.editorMode=("true"==Kameleoon.Internals.parameters.kameleoon);Kameleoon.Internals.proxyMode=(("proxy."+Kameleoon.Internals.DOMAIN)===window.location.hostname);Kameleoon.Internals.disableCache=("true"==Kameleoon.Internals.parameters.kameleoonDisableCache)||Kameleoon.Internals.parameters.kameleoonVariationId;Kameleoon.Internals.memberCode=h;Kameleoon.Internals.configuration.activePersonalizations=[];Kameleoon.Internals.configuration.displayedPersonalizations=[];for(var d=0,b=Kameleoon.Internals.configuration.personalizations.length;d<b;++d){var p=Kameleoon.Internals.configuration.personalizations[d];p.targeting=undefined}Kameleoon.Internals.currentTime=new Date().getTime();Kameleoon.Internals.virtualRootElement=document.createElement("div");if(Kameleoon.Internals.parameters.kameleoonVariationId){Kameleoon.Internals.configuration.variations=[{id:"reference",name:"Reference",builtCssCodeLevel2:"",elementSets:[]}];Kameleoon.Internals.configuration.personalizations.push({id:"",name:"Visualization",forceTargeting:true,forceExposition:true,targetingSegment:null,associatedVariation:{name:"",id:Kameleoon.Internals.parameters.kameleoonVariationId}})}Kameleoon.Internals.apiPersonalizations=new Kameleoon.Analyst.APIPersonalizations();if(window.parent!=window){try{Kameleoon.Internals.editorMode=Kameleoon.Internals.editorMode||(window.parent.location.search&&-1!=window.parent.location.search.indexOf("kameleoon=true"))}catch(f){}}if(Kameleoon.Internals.configuration.abtestingSetup||Kameleoon.Internals.configuration.personalizationSetup){Kameleoon.API.events=[];Kameleoon.API.experiments=Kameleoon.Internals.parameters.kameleoonVariationId?[]:Kameleoon.Internals.configuration.experiments;for(var d=0,b=Kameleoon.API.experiments.length;d<b;++d){Kameleoon.API.experiments[d].targeting=undefined}this.obtainSimulationModeData()}else{this.setupAfterLocalDataRetrieval()}window.addEventListener("message",Kameleoon.Utils.processMessageEvent,false)},APIPersonalizations:function(){var c=[];var b,a;var e=function(){b=Kameleoon.Internals.configuration.personalizations;Kameleoon.API.activePersonalizations=[];Kameleoon.API.displayedPersonalizations=[];d()};var d=function(){a=Kameleoon.API.personalizations=[];a=Kameleoon.Utils.api.mapAll(c,b,a);Kameleoon.API.displayedPersonalizations=Kameleoon.Internals.configuration.displayedPersonalizations;Kameleoon.API.activePersonalizations=Kameleoon.Internals.configuration.activePersonalizations};var f=function(){Kameleoon.API.displayedPersonalizations=Kameleoon.Internals.configuration.displayedPersonalizations;Kameleoon.API.activePersonalizations=Kameleoon.Internals.configuration.activePersonalizations};e();return{update:f,updateAll:d}},shouldAbortSetup:function(){if((typeof document.visibilityState!="undefined")&&(document.visibilityState=="prerender")){return true}if(Kameleoon.Internals.parameters.kameleoonDisabled||Kameleoon.Internals.configuration.kameleoonDisabled){return true}if(Kameleoon.Internals.unsupportedBrowser){return true}if(Kameleoon.Utils.readLocalData("kameleoonOptout","COOKIE",false)){return true}return false},obtainSimulationModeData:function(){if(Kameleoon.Internals.parameters["kameleoon-simulation"]){Kameleoon.Internals.newSimulationModeData=true;if(0==Kameleoon.Internals.parameters["kameleoon-simulation"].indexOf("server-call-")){var a="//api."+Kameleoon.Internals.DOMAIN+"/api?task=retrieveSimulationData&siteCode="+Kameleoon.Internals.siteCode+"&simulationCode="+Kameleoon.Internals.parameters["kameleoon-simulation"].substring(12);var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","utf-8");b.setAttribute("src",a);Kameleoon.Internals.headNode.appendChild(b);return}Kameleoon.Internals.simulationModeData=Kameleoon.Utils.JSONParse(Kameleoon.Internals.parameters["kameleoon-simulation"])}this.setupLocalData()},setupLocalData:function(){if(Kameleoon.Internals.configuration.useWideDomainSupport){Kameleoon.Internals.externalIframe=document.getElementById("kameleoonExternalIframe");Kameleoon.Internals.postMessageOrigin=Kameleoon.Internals.configuration.customIFrameURL?Kameleoon.Internals.configuration.customIFrameURL:"https://"+Kameleoon.Internals.siteCode+".kameleoon.eu";Kameleoon.Internals.postMessageCallbacks={};this.setupLocalDataCallback(Kameleoon.Internals.externalIframeData);delete (Kameleoon.Internals.externalIframeData)}else{this.setupLocalDataCallback(null)}},loadKameleoonFull:function(d){if(Kameleoon.Internals.kameleoonFull!=null){this.updateAndEvaluateKameleoonFull(Kameleoon.Internals.kameleoonFull,d)}else{if(Kameleoon.Internals.configuration.useWideDomainSupport){var a=Kameleoon.Utils;a.postMessageToExternalIframe(a.JSONStringify({type:"kameleoonfull",domain:Kameleoon.Internals.DOMAIN,betaCode:Kameleoon.Internals.configuration.betaCode,cache:Kameleoon.Utils.obtainRandomString(16),callbackId:a.addPostMessageCallback(function(e){Kameleoon.Analyst.updateAndEvaluateKameleoonFull(e,d)})}))}else{var c=sessionStorage.getItem("kameleoonFull");var b=sessionStorage.getItem("kameleoonFullTime");if((null==c)||(null==b)||(new Date().getTime()-parseInt(b)>=12*60*60*1000)){Kameleoon.Utils.performBeaconServerCall("//static."+Kameleoon.Internals.DOMAIN+"/kameleoon-full"+(Kameleoon.Internals.configuration.betaCode?"-beta":"")+".js?cache="+Kameleoon.Utils.obtainRandomString(16),function(){if((undefined===this.readyState)||((this.readyState==4)&&(this.status==200))){sessionStorage.setItem("kameleoonFull",this.responseText);sessionStorage.setItem("kameleoonFullTime",new Date().getTime());Kameleoon.Analyst.updateAndEvaluateKameleoonFull(this.responseText,d)}})}else{this.updateAndEvaluateKameleoonFull(c,d)}}}},updateAndEvaluateKameleoonFull:function(kameleoonFull,callback){Kameleoon.Internals.kameleoonFull=kameleoonFull;eval(kameleoonFull);callback&&callback()},setupLocalDataCallback:function(p){Kameleoon.Utils.removeBlockingStyleSheet();if(Kameleoon.Internals.newSimulationModeData){Kameleoon.Utils.createLocalData("kameleoonSimulationMode",Kameleoon.Internals.simulationModeData,1/24,null,"LS",true);Kameleoon.Utils.createLocalData("kameleoonSimulationModeShortURL",Kameleoon.Internals.simulationModeShortURL,1/24,null,"LS",true)}else{Kameleoon.Internals.simulationModeData=p?p.kameleoonSimulationMode:Kameleoon.Utils.readLocalData("kameleoonSimulationMode","LS",true);Kameleoon.Internals.simulationModeShortURL=p?p.kameleoonSimulationModeShortURL:Kameleoon.Utils.readLocalData("kameleoonSimulationModeShortURL","LS",true)}if(Kameleoon.Internals.simulationModeData){Kameleoon.Internals.simulationMode=true;Kameleoon.Internals.disableCache=true;Kameleoon.Internals.configuration.variations=[{id:"reference",name:"Reference",builtCssCodeLevel2:"",elementSets:[]}];this.loadKameleoonFull(function(){Kameleoon.Loader.enableKameleoonEditor.apply(Kameleoon.Loader);Kameleoon.Analyst.processSimulations.apply(Kameleoon.Analyst)})}for(var y=0,v=Kameleoon.API.experiments.length;y<v;++y){var f=Kameleoon.API.experiments[y];var b=false;var o=p?p["kameleoonRedirect-"+f.id]:Kameleoon.Utils.readLocalData("kameleoonRedirect-"+f.id,null,false)?true:false;o=o?true:(Kameleoon.Internals.parameters["kameleoonRedirect-"+f.id]?true:false);f.previousRequestRedirected=o;var k=p?p["kameleoonExperiment-"+f.id]:Kameleoon.Utils.readLocalData("kameleoonExperiment-"+f.id,null,false);for(var E in Kameleoon.Internals.parameters){if(0==E.indexOf("kameleoonAVTE-"+f.id)){k=Kameleoon.Internals.parameters[E]+"/"+new Date().getTime()+"/"+false;b=true}}if(k){var t=k.split("/");f.registeredVariationId=t[0];f.assignmentTime=t[1];f.counterActive=(t[2]=="true"&&(new Date().getTime()-f.assignmentTime<2592000000))?true:false}else{f.counterActive=false}if(f.registeredVariationId&&-1!=f.registeredVariationId.indexOf("-mentalist")){f.registeredVariationId=f.registeredVariationId.replace("-mentalist","");f.mentalistEnabled=true}if(b){Kameleoon.Analyst.writeExperimentLocalData(f)}}if(Kameleoon.Internals.configuration.personalizations.length>0){var c;var k=p?p.kameleoonPersonalizations:Kameleoon.Utils.readLocalData("kameleoonPersonalizations");if(k){var t=k.split("/");c=(t[0]=="true")?true:false}else{if(Math.random()<Kameleoon.Internals.configuration.personalizationsDeviation){c=true}else{c=false}k=c+"/"+new Date().getTime();Kameleoon.Utils.createLocalData("kameleoonPersonalizations",k,380,null,null,false)}if(Kameleoon.API.visitor==null){Kameleoon.API.visitor={}}if(Kameleoon.Internals.simulationMode&&null==Kameleoon.Internals.simulationModeData.experiments){c=true}Kameleoon.API.visitor.personalizationsActive=c}var d;var C=Kameleoon.Utils;if(p){try{var h=p.kameleoonData;if(!C.LOCAL_STORAGE_OBFUSCATED_KEYS.kameleoonData){d=h}else{var n;if(h.slice(0,2)==="2"&&h.slice(-1)===""){n=C.unobfuscateString(h)}else{n=C.decodeString(h)}d=n&&C.JSONParse(n)||{}}}catch(B){d=null}}else{d=C.readLocalData("kameleoonData","LS",true)}Kameleoon.Internals.storedData=d||{};Kameleoon.Analyst.setupAfterLocalDataRetrieval();var a={simulation:true};for(var y=0,v=Kameleoon.API.experiments.length;y<v;++y){a[Kameleoon.API.experiments[y].id]=true}for(var y=0,v=Kameleoon.Internals.configuration.pausedExperiments.length;y<v;++y){a[Kameleoon.Internals.configuration.pausedExperiments[y]]=true}var g=[];var x=document.cookie.split(new RegExp("; *"));for(var y=0,v=x.length;y<v;++y){var z=x[y].substring(0,x[y].indexOf("="));var r=z.indexOf("kameleoonExperiment-");if(r==0){var A=z.substring("kameleoonExperiment-".length);if(a[A]==null){g.push(z)}}}var s=window.location.hostname.split(".");for(var y=0,v=g.length;y<v;++y){var D=g[y];var q="";for(var w=0,u=s.length;w<u;w++){if(w>0){q="."+q}q=s[u-w-1]+q;Kameleoon.Utils.eraseLocalData(D,q,"COOKIE")}}},setupAfterLocalDataRetrieval:function(){Kameleoon.Internals.setupAfterLocalDataRetrieval=true;if((!Kameleoon.Internals.simulationMode)&&Kameleoon.Internals.parameters.kameleoonHeatMap&&Kameleoon.Internals.parameters.kameleoonVariationId){var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("charset","utf-8");var f="//api."+Kameleoon.Internals.DOMAIN+"/heatmap";d.setAttribute("src",f);d.setAttribute("onload","Kameleoon.API.getHeatMap()");Kameleoon.Internals.headNode.appendChild(d)}if(Kameleoon.Analyst.processScriptActivityTracking){Kameleoon.Analyst.processScriptActivityTracking()}if(Kameleoon.Internals.configuration.abtestingSetup||Kameleoon.Internals.configuration.personalizationSetup){if(Kameleoon.Gatherer&&Kameleoon.Internals.configuration.Gatherer){Kameleoon.Gatherer.run();Kameleoon.Internals.gathererRun=true}else{Kameleoon.Utils.saveStoredData()}if(Kameleoon.Internals.configuration.geolocation||Kameleoon.Internals.simulationMode){Kameleoon.Utils.performBeaconServerCall(Kameleoon.Internals.GEOLOCATION_URL,function(){Kameleoon.Analyst.trackGeolocationCallback(this)},null)}}if(Kameleoon.API.experiments){for(var c=0,b=Kameleoon.API.experiments.length;c<b;++c){this.setupExperiment(Kameleoon.API.experiments[c])}}if(Kameleoon.Internals.configuration.personalizations){for(var c=0,b=Kameleoon.Internals.configuration.personalizations.length;c<b;++c){this.setupPersonalization(Kameleoon.Internals.configuration.personalizations[c])}}this.processAllContainers();if(Kameleoon.API.experiments){var e=[];for(var c=0,b=Kameleoon.API.experiments.length;c<b;++c){var a=Kameleoon.API.experiments[c];if(true!==a.targeting&&a.redirectProcessed){this.performVariationAssignment(a,true);e.push(a)}else{if(a.preAssignVariation){this.performVariationAssignment(a,true)}}}this.performTracking(e)}this.checkKameleoonGoals();Kameleoon.Utils.domReady(function(){Kameleoon.Internals.domReady=true;if(!(true===Kameleoon.Internals.configuration.disableEditorLaunchViaKeys)){Kameleoon.Loader.enableKameleoonEditorListener()}if(Kameleoon.Internals.editorMode&&!Kameleoon.Internals.editorEnabled&&Kameleoon.Internals.configuration.abtestingSetup){Kameleoon.Analyst.loadKameleoonFull(function(){Kameleoon.Loader.enableKameleoonEditor.apply(Kameleoon.Loader)})}Kameleoon.Analyst.processTrackingScript.apply(Kameleoon.Analyst);if(Kameleoon.Internals.simulationMode&&Kameleoon.Loader.refreshTargetingPanel){Kameleoon.Loader.refreshTargetingPanel()}})},setupExperiment:function(a){if(a.previousRequestRedirected){a.redirectProcessed=true;if(Kameleoon.Internals.configuration.adobeOmniture){var b=Kameleoon.Internals.configuration.adobeOmniture.object?Kameleoon.Internals.configuration.adobeOmniture.object:"s";if(Kameleoon.Internals.parameters.sc_referrer){window[b].referrer=Kameleoon.Internals.parameters.sc_referrer}}Kameleoon.Utils.eraseLocalData("kameleoonRedirect-"+a.id,null,null)}},setupPersonalization:function(a){this.associateContainerAndVariation(a,"reference","DISPLAYED_VARIATION")},trackGeolocationCallback:function(a){if((a.readyState==4)&&(a.status==204)){Kameleoon.Internals.geolocation={country:a.getResponseHeader("geoip_country_name")||a.getResponseHeader("geoip_city_country_name"),region:a.getResponseHeader("geoip_region_name"),city:a.getResponseHeader("geoip_city"),latitude:a.getResponseHeader("geoip_latitude"),longitude:a.getResponseHeader("geoip_longitude")};if(Kameleoon.Internals.gathererRun){Kameleoon.Gatherer.trackGeolocation(Kameleoon.Internals.geolocation.country,Kameleoon.Internals.geolocation.region,Kameleoon.Internals.geolocation.city,Kameleoon.Internals.geolocation.latitude,Kameleoon.Internals.geolocation.longitude);if(Kameleoon.Internals.configuration.weather&&(undefined!=Kameleoon.Internals.geolocation.latitude)&&(undefined!=Kameleoon.Internals.geolocation.longitude)){Kameleoon.Gatherer.trackWeather(Kameleoon.Internals.geolocation.latitude,Kameleoon.Internals.geolocation.longitude,function(){Kameleoon.Analyst.processAllContainers()})}else{this.processAllContainers()}}else{this.processAllContainers()}}},performVariationAssignment:function(experiment,onlyRegisteredVariation){if(experiment.displayedVariation&&!onlyRegisteredVariation){return}var registeredVariationId=experiment.registeredVariationId,assignmentTime=experiment.assignmentTime;if(registeredVariationId&&assignmentTime){for(var i=0,l=experiment.variations.length;i<l;++i){if(registeredVariationId==experiment.variations[i].id&&experiment.variations[i].respoolTime>assignmentTime||("none"==registeredVariationId&&experiment.untrackedRespoolTime>assignmentTime)){if(Kameleoon.Internals.gathererRun){var debugMessage="registeredVariationId = "+registeredVariationId+", assignmentTime = "+assignmentTime+", respoolTime = ";if(registeredVariationId==experiment.variations[i].id){debugMessage+=experiment.variations[i].respoolTime}else{debugMessage+=experiment.untrackedRespoolTime}Kameleoon.Gatherer.logDebugMessage(debugMessage,Kameleoon.Gatherer.DEBUG_LEVEL.ERROR,"Respooling")}registeredVariationId=null;break}}}if("none"!=registeredVariationId&&!Kameleoon.Internals.simulationMode&&!this.findVariation(registeredVariationId)){registeredVariationId=null}if(!registeredVariationId||"true"==Kameleoon.Internals.parameters.kameleoonEraseCookies){var customVariationSelectionFunction=null;if(experiment.customVariationSelectionScript){try{eval(experiment.customVariationSelectionScript)}catch(exception){}}if(experiment.mentalistDeviation&&Kameleoon.Internals.gathererRun&&(Kameleoon.Mentalist!=null)){var deviationRandom=Math.random();if(deviationRandom<=experiment.mentalistDeviation){experiment.mentalistEnabled=true}}if(experiment.mentalistEnabled){var idList=[];for(var i=0,l=experiment.variations.length;i<l;++i){if("reference"!=experiment.variations[i].id){idList.push(experiment.variations[i].id)}}registeredVariationId=Kameleoon.Mentalist.computeBestActionToApply(idList);if(!registeredVariationId){registeredVariationId="reference"}}else{if(customVariationSelectionFunction){registeredVariationId=customVariationSelectionFunction(experiment)}else{var deviationRandom=Math.random();var total=0;for(var i=0,l=experiment.variations.length;i<l;++i){total+=experiment.variations[i].deviation;if(deviationRandom<=total){registeredVariationId=experiment.variations[i].id;break}}registeredVariationId=registeredVariationId?registeredVariationId:"none"}}experiment.registeredVariationId=registeredVariationId;experiment.assignmentTime=new Date().getTime();this.writeExperimentLocalData(experiment)}this.associateContainerAndVariation(experiment,registeredVariationId,onlyRegisteredVariation?"REGISTERED_VARIATION":"BOTH")},processAllContainers:function(){var a=[];if(Kameleoon.API.experiments){a=a.concat(Kameleoon.API.experiments)}if(Kameleoon.Internals.configuration.personalizations){a=a.concat(Kameleoon.Internals.configuration.personalizations)}this.processContainers(a)},processContainers:function(d){this.internalProcessContainers(d);if(!Kameleoon.Internals.domReady){var e=[];for(var c=0,b=d.length;c<b;++c){var a=d[c];if(!a.domReadyCallback){a.domReadyCallback=true;e.push(a)}}Kameleoon.Utils.domReady(function(){Kameleoon.Internals.domReady=true;Kameleoon.Analyst.internalProcessContainers(e)})}},internalProcessContainers:function(e){this.checkTargeting(e);var d=[];for(var c=0,b=e.length;c<b;++c){var a=e[c];if(true===a.targeting){a.domReadyCallback=true;if(a.experimentContainer){this.performVariationAssignment(a,false)}else{this.associateContainerAndVariation(a,a.exposition?a.associatedVariation.id:"reference","BOTH")}if(a.displayedVariation&&a.displayedVariation.elementSets){if(a.experimentContainer){if(("reference"!=a.displayedVariation.id)||a.executeCodeForReference){if(a.cssCode&&(!a.cssCodeEvaluated)){this.addCSSStyleSheet(a.cssCode,a,null);a.cssCodeEvaluated=true}if(a.javaScriptCode&&(!a.javaScriptCodeEvaluated)){Kameleoon.Utils.callJavaScriptCode(a.javaScriptCode);a.javaScriptCodeEvaluated=true}}}this.initVariationCommands(a.displayedVariation);d.push(a)}}}this.performTracking(d);Kameleoon.Internals.apiPersonalizations.updateAll()},loadVariationData:function(b,c){var h=b.displayedVariation.id;if(c){sessionStorage.removeItem("kameleoonVariation"+h)}var j=sessionStorage.getItem("kameleoonVariation"+h);if(j){Kameleoon.Internals.configuration.variations.push(Kameleoon.Utils.JSONParse(j));Kameleoon.Analyst.associateContainerAndVariation(b,h,"BOTH");return}if(!Kameleoon.Internals.requestedVariations[h]){Kameleoon.Internals.requestedVariations[h]={containers:[]};if("reference"!=h){var a="//static."+Kameleoon.Internals.DOMAIN+"/css/customers/"+Kameleoon.Internals.siteCode+"/"+Kameleoon.Internals.memberCode+"/";if(b.simulationMode&&b.multiVariateTest){a+="simulation/"+h+"-data.js"}else{a+=h+"/data.js"}if(Kameleoon.Internals.disableCache){a+="?cache="+Kameleoon.Utils.obtainRandomString(16)}var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("charset","utf-8");d.setAttribute("src",a);Kameleoon.Internals.headNode.appendChild(d)}}if(c){Kameleoon.Internals.requestedVariations[h].simulation=true}else{var g=b.id;var k=false;for(var f=0,e=Kameleoon.Internals.requestedVariations[h].containers.length;f<e;++f){if(g==Kameleoon.Internals.requestedVariations[h].containers[f].id){k=true;break}}if(!k){Kameleoon.Internals.requestedVariations[h].containers.push(b)}}},checkKameleoonGoals:function(){var f=[];for(var d=0,b=Kameleoon.Internals.configuration.goals.length;d<b;++d){var c=Kameleoon.Internals.configuration.goals[d];var e={goal:c};if("URL"==c.type){var a=new RegExp(c.url);if(a.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())){f.push(e)}}if("PAGE_VIEWS"==c.type){if(Kameleoon.Internals.gathererRun){if(Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.timesStartedPages.length>=c.pageViews){f.push(e)}}}}if(f.length>0){this.processConversions(f)}Kameleoon.Internals.conversionsProcessingEngagement=[];for(var d=0,b=Kameleoon.Internals.configuration.goals.length;d<b;++d){var c=Kameleoon.Internals.configuration.goals[d];if("ENGAGEMENT"==c.type){Kameleoon.Internals.conversionsProcessingEngagement.push({goal:c})}}document.addEventListener("mousedown",function(g){Kameleoon.Analyst.processConversions(Kameleoon.Internals.conversionsProcessingEngagement)},true);window.setInterval(function(){if(Kameleoon.Internals.gathererRun){var k=[];for(var j=0,g=Kameleoon.Internals.configuration.goals.length;j<g;++j){var h=Kameleoon.Internals.configuration.goals[j];if("TIME_SPENT"==h.type){if(Kameleoon.Internals.Visitor.currentVisit.timeLastActivity-Kameleoon.Internals.Visitor.currentVisit.timeStarted>=h.timeSpent*1000){k.push({goal:h})}}}if(k.length>0){this.processConversions(k)}}}.bind(this),1000)},processConversions:function(d){if(Kameleoon.Internals.gathererRun){var h=[];for(var f=0,b=Kameleoon.API.currentVisit.activeExperiments.length;f<b;++f){h.push(Kameleoon.API.currentVisit.activeExperiments[f].id)}var g=[];for(var e=0,a=d.length;e<a;++e){var c=d[e];var k=c.goal;if(((("PAGE_VIEWS"!=k.type)&&("TIME_SPENT"!=k.type)&&("ENGAGEMENT"!=k.type))||(Kameleoon.Internals.Visitor.currentVisit.obtainNumberConversions(k.id)==0))&&((!k.linkedExperimentId)||(-1!=h.indexOf(k.linkedExperimentId)))){g.push({goalId:k.id,revenue:(c.revenue?c.revenue:0)})}}if(g.length>0){Kameleoon.Gatherer.trackConversions(g)}}},checkTargeting:function(w){if(Kameleoon.Internals.configuration.personalizations){for(var G=0,C=Kameleoon.Internals.configuration.personalizations.length;G<C;++G){var J=Kameleoon.Internals.configuration.personalizations[G];J.previousExposition=J.exposition}}var e=[];for(var G=0,C=w.length;G<C;++G){var v=w[G];if(v.numberTargetingCheckings==null){v.numberTargetingCheckings=0}if(this.checkIfTargetingMustBeComputed(v.targeting,v.rescheduleTargeting||(0==v.numberTargetingCheckings),(!v.experimentContainer)&&("CUMULATIVE_WEIGHT"==v.personalizationCheckConditionsRule))){e.push(v)}}w=e;for(var G=0,C=w.length;G<C;++G){var v=w[G];if(true===v.forceTargeting){v.targeting=true}else{var g=(!v.experimentContainer)&&("CUMULATIVE_WEIGHT"==v.personalizationCheckConditionsRule);var t=this.checkTargetingTree(v,v.targetingSegment,g);if(g){v.targeting=(t.weight>=v.cumulativeWeightOfConditions)}else{v.targeting=t.targeting}v.rescheduleTargeting=t.rescheduleTargeting;v.numberTargetingCheckings++}if(true===v.targeting){if(v.experimentContainer){Kameleoon.Internals.targetedExperiments=true}else{Kameleoon.Internals.targetedPersonalizations=true}}}var f=[];for(var G=0,C=w.length;G<C;++G){var v=w[G];if(!v.experimentContainer){if(true===v.targeting){f.push(v)}else{v.exposition=false;v.notExposedReason="TARGETING"}}}var y=function(M){var n=[];for(var m=0,j=Kameleoon.Internals.configuration.personalizations.length;m<j;++m){var k=Kameleoon.Internals.configuration.personalizations[m];if(M!=k.id){n.push(k)}}return n};var H=new Date().getTime();for(var G=0,C=f.length;G<C;++G){var J=f[G];if(true===J.forceExposition){J.exposition=true}else{J.exposition=true;if((true===J.exposition)&&(!Kameleoon.API.visitor.personalizationsActive)){J.exposition=false;J.notExposedReason="INACTIVE_PERSONALIZATIONS"}if((true===J.exposition)&&J.globalCappingNumberVisitors&&(J.numberVisitorsExposed>=J.maxNumberVisitorsExposed)){J.exposition=false;J.notExposedReason="GLOBAL_CAPPING_NUMBER_VISITORS"}if(true===J.exposition){switch(J.customExpositionRate){case 1:break;case 0:J.exposition=false;break;default:var p=Kameleoon.Utils.readLocalData("kameleoonPersonalizationTargeted-"+J.id,"COOKIE",false);if(p!=null){var A=p.split("/");J.exposition=(A[0]=="true")}else{J.exposition=(Math.random()<J.customExpositionRate);Kameleoon.Utils.createLocalData("kameleoonPersonalizationTargeted-"+J.id,J.exposition+"/"+new Date().getTime(),380,null,"COOKIE",false)}break}if(false===J.exposition){J.notExposedReason="CUSTOM_EXPOSITION_RATE"}if(true===J.exposition){if(Kameleoon.Internals.gathererRun&&((J.expositionFrequencySameVisit!=null)&&(Kameleoon.Visitor.obtainPersonalizationNumberActivations(J.id,1,H,null,true,false)>=J.expositionFrequencySameVisit))||((J.expositionFrequencySameVisitor!=null)&&(J.expositionFrequencySameVisitorDelaySeconds!=null)&&(Kameleoon.Visitor.obtainPersonalizationNumberActivations(J.id,1,H,J.expositionFrequencySameVisitorDelaySeconds*1000,true,true)>=J.expositionFrequencySameVisitor))||(J.cappingPerVisitorNumberExpositions&&(Kameleoon.Visitor.obtainPersonalizationNumberActivations(J.id,1,H,null,true,true)>=J.expositionFrequencySameVisitorMax))||(J.cappingPerVisitorConvertGoal&&(Kameleoon.Visitor.obtainNumberConversions(J.cappingPerVisitorGoalId)>0))||((J.expositionFrequencyDelaySecondsBetweenTwoExpositions!=null)&&(Kameleoon.Visitor.obtainPersonalizationNumberActivations(J.id,1,H,J.expositionFrequencyDelaySecondsBetweenTwoExpositions*1000,true,true)>=1))){J.exposition=false;J.notExposedReason="EXPOSITION_FREQUENCY"}}if((true===J.exposition)&&(null!=J.personalizationsInteractionConditions)){for(var E=0,B=J.personalizationsInteractionConditions.length;E<B;++E){var a=J.personalizationsInteractionConditions[E];if(("SAME_PAGE"!=a.personalizationsInteractionVisitsConfiguration)&&(!Kameleoon.Internals.gathererRun)){continue}var o;var I;var c;switch(a.personalizationsInteractionConfiguration){case"NO_OTHER_PERSO":o=y(J.id);I=0;c=0;break;case"AT_LEAST_ONE_OTHER_PERSO":o=y(J.id);I=1;c=o.length;break;case"NUMBER_OF_OTHER_PERSOS":o=y(J.id);switch(a.personalizationsInteractionNumberOtherPersosMatchType){case"GREATER":I=a.personalizationsInteractionNumberOtherPersos+1;c=o.length;break;case"LOWER":I=0;c=a.personalizationsInteractionNumberOtherPersos-1;break;case"GREATER_THAN_EQUAL":I=a.personalizationsInteractionNumberOtherPersos;c=o.length;break;case"LOWER_THAN_EQUAL":I=0;c=a.personalizationsInteractionNumberOtherPersos;break;case"EQUAL":default:I=a.personalizationsInteractionNumberOtherPersos;c=a.personalizationsInteractionNumberOtherPersos;break}break;case"ALL_OTHER_PERSOS":o=y(J.id);I=o.length;c=o.length;break;case"ID_PERSO":o=[];for(var D=0,z=Kameleoon.Internals.configuration.personalizations.length;D<z;++D){var L=Kameleoon.Internals.configuration.personalizations[D];if(L.id==a.personalizationsInteractionIdPerso){o.push(L);break}}if(o.length==0){o.push({id:a.personalizationsInteractionIdPerso,previousExposition:false})}I=1;c=1;break;default:o=[];I=1;c=1;break}var r=0;for(var D=0,z=o.length;D<z;++D){var u=o[D];var d;switch(a.personalizationsInteractionVisitsConfiguration){case"SAME_PAGE":d=(true===u.previousExposition);break;case"CURRENT_VISIT":d=Kameleoon.Visitor.obtainPersonalizationIsActive(u.id,1,true,false);break;case"PREVIOUS_VISIT":d=Kameleoon.Visitor.obtainPersonalizationIsActive(u.id,1,false,true);break;case"ALL_VISITS":d=Kameleoon.Visitor.obtainPersonalizationIsActive(u.id,1,true,true);break;default:d=false;break}if(!a.personalizationsInteractionDisplayOthersPersos){d=!d}if(d){r++}}var b=(r>=I)&&(r<=c);if((b&&(!a.personalizationsInteractionDisplayPerso))||((!b)&&a.personalizationsInteractionDisplayPerso)){J.exposition=false;J.notExposedReason="INTERACTIONS";break}}}}}}var K={};for(var G=0,C=w.length;G<C;++G){var v=w[G];if((!v.experimentContainer)&&(true===v.exposition)){var s=v.personalizationConfiguration;var x=K[s];if((x==null)||(v.priority>x[0].priority)){K[s]=[v]}else{if(v.priority==x[0].priority){x.push(v)}}}}var h={};for(var s in K){var x=K[s];var q={};if(!Kameleoon.Internals.configuration.disablePersonalizationsOfTheSameType){for(var G=0,C=x.length;G<C;++G){q[x[G].id]=true}}else{q[x[Math.floor(Math.random()*x.length)].id]=true}h[s]=q}K=null;for(var G=0,C=f.length;G<C;++G){var J=f[G];if((true===J.exposition)&&(true!==J.forceExposition)){if(h[J.personalizationConfiguration][J.id]==null){J.exposition=false;J.notExposedReason="PRIORITY"}}}h=null;var F=[];for(var G=0,C=w.length;G<C;++G){var v=w[G];if((false===v.targeting)||((!v.experimentContainer)&&(true===v.targeting)&&(false===v.exposition))){this.associateContainerAndVariation(v,"reference","DISPLAYED_VARIATION");this.removeCSSStyleSheet(v)}if(this.checkIfTargetingMustBeComputed(v.targeting,v.rescheduleTargeting,(!v.experimentContainer)&&("CUMULATIVE_WEIGHT"==v.personalizationCheckConditionsRule))){F.push(v)}}if(F.length>0){window.setTimeout(function(){Kameleoon.Analyst.processContainers.apply(Kameleoon.Analyst,[F])},Kameleoon.Internals.PAGE_LOADING_POLL_DELAY)}},checkTargetingTree:function(a,f,d){var i;if(null==f){i={targeting:true,rescheduleTargeting:false};if(d){i.weight=0}}else{if(f.numberTargetingCheckings==null){f.numberTargetingCheckings=0}if(!this.checkIfTargetingMustBeComputed(f.targeting,f.rescheduleTargeting||(0==f.numberTargetingCheckings),d)){i={targeting:f.targeting,rescheduleTargeting:false};if(d){i.weight=f.weight}}else{if(null!=f.targetingCondition){i=this.checkTargetingCondition(a,f.targetingCondition)}else{var g=this.checkTargetingTree(a,f.leftChild,d);var b=false;if(!b){if(d){b=true}}if(!b){switch(g.targeting){case true:if(!f.orOperator){b=true}break;case false:if(f.orOperator){b=true}break;case undefined:default:b=true;break}}var h=null;if(b){h=this.checkTargetingTree(a,f.rightChild,d)}var c;switch(g.targeting){case true:if(f.orOperator){c=true}else{switch(h.targeting){case true:c=true;break;case false:c=false;break;case undefined:default:c=undefined;break}}break;case false:if(f.orOperator){switch(h.targeting){case true:c=true;break;case false:c=false;break;case undefined:default:c=undefined;break}}else{c=false}break;case undefined:default:if(f.orOperator){switch(h.targeting){case true:c=true;break;case false:c=undefined;break;case undefined:default:c=undefined;break}}else{switch(h.targeting){case true:c=undefined;break;case false:c=false;break;case undefined:default:c=undefined;break}}break}i={targeting:c,rescheduleTargeting:this.checkIfTargetingMustBeComputed(c,g.rescheduleTargeting||(b&&h.rescheduleTargeting),d)};if(d){var e;if(f.orOperator){e=Math.max(g.weight,h.weight)}else{e=g.weight+h.weight}i.weight=e}}f.targeting=i.targeting;f.rescheduleTargeting=i.rescheduleTargeting;if(d){f.weight=i.weight}}f.numberTargetingCheckings++}return i},checkTargetingCondition:function(b,g){var a;if(g.numberTargetingCheckings==null){g.numberTargetingCheckings=0}if(!this.checkIfTargetingMustBeComputed(g.targeting,g.rescheduleTargeting||(0==g.numberTargetingCheckings),undefined)){a={targeting:g.targeting,rescheduleTargeting:false}}else{var c=Kameleoon.Analyst["evaluateTargeting_"+g.type];var f;if(c){f=c(g)}else{f=null}var d,e;if(f==null){d=true;e=false}else{d=f.targeting;e=f.rescheduleTargeting;if((true!==g.include)&&(undefined!==d)){d=!d}}a={targeting:d,rescheduleTargeting:this.checkIfTargetingMustBeComputed(d,e,undefined)};g.targeting=a.targeting;g.rescheduleTargeting=a.rescheduleTargeting}if(a.targeting===true){a.weight=g.weight}else{a.weight=0}g.numberTargetingCheckings++;return a},checkIfTargetingMustBeComputed:function(b,c,a){var d=(true===c)&&((undefined===b)||((false===b)&&(true===a)));return d},initVariationCommands:function(e){if(!e){return}if(Kameleoon.Internals.editorMode){Kameleoon.Utils.domReady(function(){Kameleoon.Analyst.processVariationCommands(e)});return}Kameleoon.API.currentContainer=e.container;if(e.redirections){var b=e.redirections;for(var d=0,a=b.length;d<a;++d){if(!b[d].scope||new RegExp(b[d].scope).test(window.location.href)){if(b[d].additionalParameters){if(-1==window.location.search.indexOf(b[d].string)){if("#"!=b[d].string[0]){Kameleoon.API.processRedirect(window.location.protocol+"//"+window.location.hostname+((!window.location.port)?"":":"+window.location.port)+window.location.pathname+(window.location.search+((-1==window.location.search.indexOf("?"))?"?":"&")+b[d].string)+window.location.hash)}else{window.location.replace(window.location.protocol+"//"+window.location.hostname+((!window.location.port)?"":":"+window.location.port)+window.location.pathname+window.location.search+b[d].string)}}}else{var f=b[d].string;if(b[d].keepParameters){f+=(-1!=f.indexOf("?"))?window.location.search.replace("?","&"):window.location.search}Kameleoon.API.processRedirect(f)}}}}if(e.forceNoFlicker&&!Kameleoon.Internals.domReady){var c="";for(var d=0,a=e.elementSets.length;d<a;++d){c+=((0!=d)?", ":"")+e.elementSets[d].selector}Kameleoon.API.forceNoFlicker(c)}if(!e.styleSheetAdded){this.addCSSStyleSheet(e.builtCssCodeLevel2,e.container,null);e.styleSheetAdded=true}if(e.javaScriptCode&&!e.javaScriptCode.afterDOMReady){this.applyJavascriptCode(e)}if(Kameleoon.Internals.domReady){this.processVariationCommands(e)}else{Kameleoon.Utils.domReady(function(){Kameleoon.Analyst.processVariationCommands(e)})}},processVariationCommands:function(b){if(!b){return}var a=b.container;if(b.javaScriptCode&&b.javaScriptCode.afterDOMReady&&!b.permanentRefreshActive){this.applyJavascriptCode(b)}if(b.elementSets&&(!a||a.targeting)){this.setupDOMStructure(b,false,b.permanentRefreshActive,b.editionMode)}if(b.forceNoFlicker&&!b.permanentRefreshActive){Kameleoon.Utils.removeBlockingStyleSheet()}if(Kameleoon.Internals["enginePollerForVariation"+b.id]&&!b.permanentRefreshActive){window.clearInterval(Kameleoon.Internals["enginePollerForVariation"+b.id]);Kameleoon.Internals["enginePollerForVariation"+b.id]=null}if(!Kameleoon.Internals["enginePollerForVariation"+b.id]&&!Kameleoon.Internals.editorMode){b.permanentRefreshActive=true;Kameleoon.Internals["enginePollerForVariation"+b.id]=window.setInterval(function(){Kameleoon.Analyst.processVariationCommands.apply(Kameleoon.Analyst,[b])},Kameleoon.Internals.PAGE_LOADED_POLL_DELAY)}},applyJavascriptCode:function(a){if(a.javaScriptCode&&a.javaScriptCode.code&&!a.permanentRefreshActive&&!a.javaScriptCode.evaluated){Kameleoon.Utils.callJavaScriptCode(a.javaScriptCode.code);a.javaScriptCode.evaluated=true}},setMutationObserver:function(d){var f=document.body,e,c,b;function a(i){var j=true,g=i.id,h=i.className;if((g&&g.indexOf("kameleoon")!==-1)||(g&&g.indexOf("cke")!==-1)||(h&&h.indexOf("kameleoon")===-1)||(i.hasAttribute&&i.hasAttribute("qxclass")===true)){j=false}if(j){console.info("variationprocess:",i);Kameleoon.Analyst.applyVariationCommands.apply(Kameleoon.Analyst,[d])}}if(typeof MutationObserver==="function"){d.mutationObserver=new MutationObserver(function(g){g.forEach(function(h){b=true;e=(h.type==="characterData")?h.target.parentNode:h.target;if(h.type==="attributes"&&h.attributeName==="kameleoon"){b=false}if(b){a(e)}})});c={attributes:true,childList:true,characterData:true,subtree:true};d.mutationObserver.observe(f,c)}else{f.addEventListener("DOMSubtreeModified",function(g){e=(g.target.nodeName==="#text")?g.target.parentNode:g.target;a(e)},false)}},processTrackingScript:function(){if(Kameleoon.Internals.configuration.trackingScript&&!Kameleoon.Internals.trackingScriptProcessed&&!Kameleoon.Internals.editorMode){Kameleoon.Internals.trackingScriptProcessed=true;eval(Kameleoon.Internals.configuration.trackingScript)}},performTracking:function(containers){var containersKameleoonTrackingToTrack=[];var containersKameleoonTrackingNotToTrack=[];var containersMentalistTracking=[];for(var i=0,l=containers.length;i<l;++i){var container=containers[i];if(container.trackingPerformed||!container.registeredVariation){continue}if(!container.experimentContainer){if("reference"!=container.displayedVariation.id){Kameleoon.Internals.configuration.displayedPersonalizations.push({id:container.id,name:container.name})}if(container.api){Kameleoon.Internals.configuration.activePersonalizations.push(container.name)}Kameleoon.Internals.apiPersonalizations.update()}var variation=container.registeredVariation;if(container.mentalistEnabled){variation.name+=" (Predicteo)"}if(Kameleoon.Internals.configuration.checkTestedTrafficActive&&!container.counterActive&&container.experimentContainer){container.counterActive=true;var url="//server1.counter."+Kameleoon.Internals.DOMAIN+"/_.gif?siteCode="+Kameleoon.Internals.siteCode+"&anniversaryDay="+Kameleoon.Internals.configuration.anniversaryDay;Kameleoon.Utils.performBeaconServerCall(url);this.writeExperimentLocalData(container)}if(container.googleAnalyticsTracking){this.processGoogleAnalyticsTracking(container)}if(container.kissMetricsTracking){this.processKissMetricsTracking(container)}if(container.piwikTracking){this.processPiwikTracking(container)}if(container.comScoreTracking){this.processComScoreTracking(container)}if(container.crazyEggTracking){this.processCrazyEggTracking(container)}if(container.universalAnalyticsTracking){this.processUniversalAnalyticsTracking(container)}if(container.atInternetTracking){this.processATInternetTracking(container)}if(container.adobeOmnitureTracking){this.processAdobeOmnitureTracking(container)}if(container.webtrendsTracking){this.processWebtrendsTracking(container)}if(container.eulerianTracking){this.processEulerianTracking(container)}(container.kameleoonTracking?containersKameleoonTrackingToTrack:containersKameleoonTrackingNotToTrack).push({type:(container.experimentContainer?"EXPERIMENT":"PERSONALIZATION"),id:container.id,variationId:("reference"==variation.id?null:(container.experimentContainer?variation.id:1)),mentalistDecision:(container.mentalistEnabled?true:false)});if(container.mentalist){containersMentalistTracking.push(container)}if(container.heatMapTracking){if(document.addEventListener){document.addEventListener("mousedown",Kameleoon.Analyst.processHeatMapClick.bind(Kameleoon.Analyst,container),true)}}if(container.javaScriptTracking){try{eval(container.javaScriptTracking)}catch(exception){}}container.trackingPerformed=true}if(Kameleoon.Internals.gathererRun){Kameleoon.Gatherer.trackContainers(containersKameleoonTrackingToTrack,containersKameleoonTrackingNotToTrack)}if(containersMentalistTracking.length>0){this.processMentalistTracking(containersMentalistTracking)}},processHeatMapClick:function(b,d){if(Kameleoon.Internals.editorMode||d.kameleoonCreated||!d.preventDefault||!document.createEvent){return}var a=d.clientX,e=d.clientY;a=a-(document.documentElement.clientWidth-b.heatMapTracking.pageWidth)*0.5;a=Math.round(a);e+=document.body.scrollTop;var c="//server1.heatmap."+Kameleoon.Internals.DOMAIN+"/_.gif?x="+a+"&y="+e+"&siteCode="+Kameleoon.Internals.siteCode+"&experimentId="+b.id+"&variationId="+b.registeredVariation.id;Kameleoon.Utils.performBeaconServerCall(c)},addCSSStyleSheet:function(f,a,c){if(!f){return}var i=c?c:document;var b="kameleoonStyleSheet"+(a?("-"+a.id):"");var d=c?c.getElementById(b):null;var e="";if(d){e=d.textContent;d.parentNode.removeChild(d)}var h=i.createElement("style");h.className="KameleoonStyleSheet";h.setAttribute("id",b);h.setAttribute("rel","stylesheet");h.setAttribute("type","text/css");h.setAttribute("media","screen");var g=e+f;if(h.styleSheet){h.styleSheet.cssText=g}else{h.appendChild(document.createTextNode(g))}if(c){i.getElementsByTagName("head")[0].appendChild(h,i.getElementsByTagName("head")[0].firstChild)}else{Kameleoon.Internals.headNode.insertBefore(h,Kameleoon.Internals.headNode.firstChild)}if(a){a.loadedCSSStyleSheet=h}},removeCSSStyleSheet:function(a){if(a.loadedCSSStyleSheet){var b=a.loadedCSSStyleSheet.id.replace("kameleoonStyleSheet-","");if(-1==b.indexOf(",")){Kameleoon.Internals.headNode.removeChild(a.loadedCSSStyleSheet);a.loadedCSSStyleSheet=null}else{a.loadedCSSStyleSheet.id="kameleoonStyleSheet-"+b.replace(new RegExp(a.id+",?"),"")}}},findVariation:function(b){for(var a=0;a<Kameleoon.Internals.configuration.variations.length;++a){if(b==Kameleoon.Internals.configuration.variations[a].id){return Kameleoon.Internals.configuration.variations[a]}}return null},associateContainerAndVariation:function(a,g,f){var d=true;var e=true;if("REGISTERED_VARIATION"==f){e=false}if("DISPLAYED_VARIATION"==f){d=false}if("none"==g){a.trackingPerformed=true;g="reference";d=false}var c=this.findVariation(g);if(a&&d){a.registeredVariation={id:g}}if(c){var b=Kameleoon.Utils.clone(c);if(a&&!a.associationMade){if(d){a.registeredVariation=b;a.associationMade=true}if(e){a.displayedVariation=b}b.container=a;if(a.experimentContainer){b.experiment=a}else{b.personalization=a}}}else{a.displayedVariation={id:g}}if(a.displayedVariation&&!a.displayedVariation.elementSets){this.loadVariationData(a)}},writeExperimentLocalData:function(a){var b=a.registeredVariationId+(a.mentalistEnabled?"-mentalist":"")+"/"+a.assignmentTime+"/"+a.counterActive;Kameleoon.Utils.createLocalData("kameleoonExperiment-"+a.id,b,a.cookieDuration?a.cookieDuration:30,a.cookieDomain,null,false)},setupDOMStructure:function(e,h,d,c){var b=null;var g=[];Kameleoon.Internals.pageElementSets=Kameleoon.Internals.pageElementSets.concat(e.elementSets);b=this.performHTMLReplacements(e.elementSets,h,d,e);if(c){editor.services.EngineService.getInstance().refreshCustomizableElements()}for(var f=0,a=b.length;f<a;++f){if(h&&(b[f].options.userPosition&&"RELATIVE"!=b[f].options.userPosition.positionMode)){continue}g.push(b[f])}this.powerElements(g);return g?g.length>0:false},performHTMLReplacements:function(c,e,d,g){var h=null;var f=true;while(f){h=this.obtainElements(c,e,d,g);if(0==h.length){break}h=h.sort(function(k,i){var m=Kameleoon.Utils.obtainDepth(k.element),l=Kameleoon.Utils.obtainDepth(i.element);return m<l?-1:m>l?1:0});h=this.removeDuplicates(h);f=false;for(var b=0,a=h.length;b<a;++b){var j=h[b].options;if(j.htmlContent){f=this.changeHTMLContent(h[b],c,j.htmlContent,false,true)||f}if(j.replaceHtmlContent){f=this.changeHTMLContent(h[b],c,j.replaceHtmlContent,true,true)||f}}}for(var b=0,a=c.length;b<a;++b){if(c[b]&&c[b].removeSelector){c[b]=null}}return h},obtainElements:function(h,u,w,f){var k,v,t=[];if(this.timeOutCallback){window.clearTimeout(this.timeOutCallback)}for(var s=0,p=h.length;s<p;++s){if(null===h[s]){continue}var e=h[s].selector;var d=h[s].options;var c=null,a=document;if(d.context){c=Kameleoon.Utils.querySelectorAll(d.context);if(!c[0]){continue}c=c[0].contentWindow.document;a=c;if(f){this.addCSSStyleSheet(f.builtCssCodeLevel2,f.container,c)}}if(d.scopeURL&&!new RegExp(d.scopeURL).test(window.location.href)){k=[]}else{if(d.customSelector||d.autoGeneratedSelector||d.contentSelector){k=Kameleoon.Utils.querySelectorAll(e,c);if(d.kameleoonClass){for(var q=0,o=k.length;q<o;++q){if(-1==(" "+k[q].className+" ").indexOf(" KameleoonClass"+d.kameleoonClass+" ")){this.saveElementOriginalData(k[q]);k[q].className+=(k[q].className?" ":"")+"KameleoonClass"+d.kameleoonClass}}}if(0==k.length){if(d.kameleoonId){var b=document.getElementById("kameleoonId"+d.kameleoonId);k=b?[b]:[]}if(d.kameleoonClass){k=Kameleoon.Utils.querySelectorAll(".KameleoonClass"+d.kameleoonClass,null)}}if(0==k.length){k=Kameleoon.Utils.querySelectorAll(e,Kameleoon.Internals.virtualRootElement)}}else{switch(e.charAt(0)){case"#":var n=e.substr(1);k=[a.getElementById(e.substr(1))];if(!k[0]){var b=null;if(h[s].element){b=h[s].element}else{if(0==n.indexOf("kameleoonElement")&&a.body){if(d.domOperation){var g=Kameleoon.Utils.querySelectorAll(d.domReference,c)[0];if(g){b=a.createElement("div");Kameleoon.Internals.virtualRootElement.appendChild(b);h[s].element=b}}else{b=a.createElement("div");a.body.appendChild(b)}}}if(b){b.id=n;k=[b]}else{k=[]}}break;default:k=Kameleoon.Utils.querySelectorAll(e,c);break}}}var r=false;v=[];for(var q=0,o=k.length;q<o;++q){if(!k[q].getAttribute("kameleoon")){if(!u||undefined===d.htmlContent||Kameleoon.Utils.checkElementLoaded(k[q])){if(d.userPosition&&d.userPosition.referenceElement&&!Kameleoon.Utils.querySelectorAll(d.userPosition.referenceElement)[0]){continue}if(d.domOperation){var g=Kameleoon.Utils.querySelectorAll(d.domReference,c)[0];this.saveElementOriginalData(k[q]);k[q].kameleoonData.domTargetElement=g;if(u||w){if((!Kameleoon.Utils.checkElementLoaded(k[q])&&0!=d.selector.indexOf("#kameleoonElement"))||!Kameleoon.Utils.checkElementLoaded(k[q].kameleoonData.domTargetElement)){continue}r=true}}v.push({element:k[q],options:Kameleoon.Utils.clone(d)})}}}h[s].removeSelector=r||(w&&0<k.length&&d.autoGeneratedSelector);t=t.concat(v)}return t},powerElements:function(c){for(var b=0,a=c.length;b<a;++b){this.powerElement(c[b].element,c[b].options)}},powerElement:function(d,b){if(Kameleoon.Internals.configuration.specifyElements&&(-1==d.className.indexOf("Kameleoon"))){return}this.saveElementOriginalData(d);d.kameleoonData.powered=true;d.setAttribute("kameleoon","active");if(b.kameleoonId&&!d.id){d.id="kameleoonId"+b.kameleoonId}if(b.kameleoonClass){if(-1==(" "+d.className+" ").indexOf(" KameleoonClass"+b.kameleoonClass+" ")){d.className+=(d.className?" ":"")+"KameleoonClass"+b.kameleoonClass}}if(b.keepSpace){this.reserveSpaceForElement(d)}if(b.domOperation){var a=d.kameleoonData.domTargetElement;if(!a){var c=null;if(b.context){c=Kameleoon.Utils.querySelectorAll(b.context);c=c[0]?c[0].contentWindow.document:null}a=Kameleoon.Utils.querySelectorAll(b.domReference,c)[0]}this.processDomOperation(d,a,b.domOperation)}this.processUserPosition(d,d,b.userPosition,"inline"!=Kameleoon.Utils.obtainComputedStyle(d).display);this.setupNoLinkPropagation(b,d);this.processSpecialCases(d);this.processLinks(d,b.href)},saveElementOriginalData:function(a){if(a.kameleoonData&&a.kameleoonData.originalData){return}if(!a.kameleoonData){a.kameleoonData={}}a.kameleoonData.originalData={};if(a.style.cssText){a.kameleoonData.originalData.style=a.style.cssText}if(a.id){a.kameleoonData.originalData.id=a.id}if(a.className){a.kameleoonData.originalData.className=a.className}if(a.parentNode){a.kameleoonData.originalData.parentNode=a.parentNode}if(a.nextSibling){a.kameleoonData.originalData.nextSibling=a.nextSibling}if(a.href){a.kameleoonData.originalData.href=a.getAttribute("href")}},reserveSpaceForElement:function(a){if(!a.kameleoonData||!a.kameleoonData.originalData){this.saveElementOriginalData(a)}if(!a.kameleoonData.originalData.originalNode){var h=true;for(var e=0,b=a.childNodes.length;e<b;++e){var d=a.childNodes[e];if(d.nodeType==1){h=false}}var g=a.cloneNode(h);var f;if(Kameleoon.Internals.internetExplorer&&!Kameleoon.Internals.modernInternetExplorer){f=a.offsetWidth-1}else{f=a.getBoundingClientRect().width}Kameleoon.Utils.setStyle(g,"width",f+"px",false);if(!h){Kameleoon.Utils.setStyle(g,"height",a.clientHeight+"px",false)}var c=Kameleoon.Utils.obtainComputedStyle(a);Kameleoon.Utils.setStyle(g,"float",c.cssFloat,false);Kameleoon.Utils.setStyle(g,"margin-top",c.marginTop,false);Kameleoon.Utils.setStyle(g,"margin-bottom",c.marginBottom,false);Kameleoon.Utils.setStyle(g,"margin-left",c.marginLeft,false);Kameleoon.Utils.setStyle(g,"margin-right",c.marginRight,false);Kameleoon.Utils.setStyle(g,"overflow",c.overflow,false);Kameleoon.Utils.setStyle(g,"visibility","hidden",false);g.removeAttribute("id");g.removeAttribute("class");a.parentNode.insertBefore(g,a);a.kameleoonData.originalData.originalNode=g;Kameleoon.Utils.setStyle(a,"position","absolute",false)}},removeDuplicates:function(f){var a=[];for(var e=0,b=f.length;e<b;++e){if(undefined==f[e].element.kameleoonUnique){f[e].element.kameleoonUnique=a.length;if(f[e].options.kameleoonClass){f[e].options.kameleoonClass=[f[e].options.kameleoonClass]}a.push(f[e])}else{var c=f[e].element.kameleoonUnique;for(var d in f[e].options){if("kameleoonClass"==d){if(!a[c].options[d]){a[c].options[d]=[]}a[c].options[d].push(f[e].options[d])}else{a[c].options[d]=f[e].options[d]}}}}for(var e=0,b=a.length;e<b;++e){if(undefined!==a[e].element.kameleoonUnique){a[e].element.kameleoonUnique=undefined;a[e].element.removeAttribute("kameleoonUnique")}}return a},setupNoLinkPropagation:function(a,b){if(a.noLinkPropagation){b.setAttribute("kData","nlp")}},changeHTMLContent:function(b,f,c,a,e){var d=b.element;var i=false;var h=("input"==d.nodeName.toLowerCase()&&("button"==d.getAttribute("type")||"submit"==d.getAttribute("type")||"text"==d.getAttribute("type")));var g=h?d.value:d.innerHTML;this.saveElementOriginalData(d);if(undefined===d.kameleoonData.originalData.htmlContent){d.kameleoonData.originalData.htmlContent=g;i=true}if((!e||i)&&g!=c){if(a){b.element=this.replaceHTMLContent(d,f,c,b.options)}else{if(h){d.value=c}else{d.innerHTML=c}}}return i},replaceHTMLContent:function(j,g,e,m){var b=Kameleoon.Utils.checkElementIsInDocument(j,m);if(0==e.indexOf("kameleoonInputImage:")){this.saveElementOriginalData(j);j.kameleoonData.originalData.imgSrc=j.src;j.src=e.replace("kameleoonInputImage:","");return j}var a=document.createElement(b?j.parentNode.nodeName.toLowerCase():"div");a.innerHTML=e;var h=false;while(a.childNodes.length>0){var f=a.childNodes[0];f.kameleoonData=j.kameleoonData;f.kameleoonData.originalData.replacedElement=j;if(!h){h=f;f.id=j.id;if("copyAttributes"==h.getAttribute("kameleoon")){for(var d=0,c=j.attributes.length;d<c;++d){if("src"!=j.attributes[d].name){h.setAttribute(j.attributes[d].name,j.attributes[d].value)}}h.removeAttribute("kameleoon")}var k=j.className.match(/(KameleoonClass[^\s]*)/);if(k){f.className+=(f.className?" ":"")+k[1]}if(m.kameleoonId){f.id="kameleoonId"+m.kameleoonId}if(m.kameleoonClass&&-1==(" "+f.className+" ").indexOf(" KameleoonClass"+m.kameleoonClass+" ")){f.className+=(f.className?" ":"")+"KameleoonClass"+m.kameleoonClass}if((f.id||f.className)&&3==f.nodeType){return false}}if(b){j.parentNode.insertBefore(f,j)}if(b!==true){for(var d=0,c=g.length;d<c;++d){if(j==g[d].element){g[d].element=f}}}if(b===false){j=f;f.parentNode.removeChild(f)}}if(b){j.parentNode.removeChild(j)}return h},processUserPosition:function(b,e,a,d){if(a){switch(a.positionMode){case"ABSOLUTE_KEEP_SPACE":case"ABSOLUTE":if(d){var h=("ABSOLUTE_KEEP_SPACE"==a.positionMode)?b.kameleoonData.originalData.originalNode.offsetWidth:b.offsetWidth;if(h){Kameleoon.Utils.setStyle(e,"width",h+"px",("th"!=e.nodeName.toLowerCase()&&"td"!=e.nodeName.toLowerCase()))}}var g=null;var c=false;if(a.referenceElement){g=Kameleoon.Utils.querySelectorAll(a.referenceElement)[0];c=true}if(!g){g=document.body}if(g&&e.parentNode!=g){e.parentNode.removeChild(e);g.appendChild(e);if(!e.kameleoonData){e.kameleoonData={}}e.kameleoonData.moved=true}Kameleoon.Utils.setStyle(e,"position","absolute",false);var f=Kameleoon.Utils.obtainComputedStyle(e).left.replace("px","")/a.referenceWidth;Kameleoon.Utils.setStyle(e,"left",Math.round(f*g.offsetWidth)+"px",true);if(c){this.addRelativePositionToReferenceElement(g)}break;case"RELATIVE":Kameleoon.Utils.setStyle(e,"position","",false)}Kameleoon.Utils.setStyle(e,"top","",false);Kameleoon.Utils.setStyle(e,"left","",false);Kameleoon.Utils.setStyle(e,"right","",false);Kameleoon.Utils.setStyle(e,"bottom","",false);if(!d){Kameleoon.Utils.setStyle(e,"width","",false)}Kameleoon.Utils.setStyle(e,"height","",false)}},processDomOperation:function(d,c,a){if(!c){return}var g=d.parentNode;var b=c.parentNode;var f=d.nextSibling;while(b){if(b==d){return}b=b.parentNode}b=c.parentNode;try{if(g){g.removeChild(d)}switch(a){case"SWAP":this.saveElementOriginalData(c);b.insertBefore(d,c);b.removeChild(c);if(f){try{g.insertBefore(c,f)}catch(e){g=d.parentNode;f=d.nextSibling;g.insertBefore(c,f)}}else{g.appendChild(c)}if("left"==Kameleoon.Utils.obtainComputedStyle(d)["float"]&&"right"==Kameleoon.Utils.obtainComputedStyle(c)["float"]){d.style["float"]="right";c.style["float"]="left"}else{if("right"==Kameleoon.Utils.obtainComputedStyle(d)["float"]&&"left"==Kameleoon.Utils.obtainComputedStyle(c)["float"]){d.style["float"]="left";c.style["float"]="right"}}d.kameleoonData.swapTargetElement=c;break;case"INSERT_BEFORE":b.insertBefore(d,c);break;case"INSERT_AFTER":if(c.nextSibling){b.insertBefore(d,c.nextSibling)}else{b.appendChild(d)}break;case"INSERT_AS_CHILD":if(0==c.childNodes.length){c.appendChild(d)}else{c.insertBefore(d,c.firstChild)}break}}catch(e){}},addRelativePositionToReferenceElement:function(a){if("absolute"!=Kameleoon.Utils.obtainComputedStyle(a).position&&document.body!=a){Kameleoon.Utils.setStyle(a,"position","relative",false)}},processSpecialCases:function(a){if("body"==a.nodeName.toLowerCase()&&-1!=Kameleoon.Utils.obtainComputedStyle(a).background.indexOf("linear-gradient")){a.style.backgroundRepeat="no-repeat";if(window.innerHeight-document.documentElement.scrollHeight>0){a.style.backgroundAttachment="fixed"}}},processLinks:function(b,a){if(!a){return}if("a"==b.nodeName.toLowerCase()){b.href=a}else{b.addEventListener("click",function(){window.location.href=a});b.style.cursor="pointer"}},refreshForScreenResize:function(){for(var a=Kameleoon.poweredNodes.length,b=a-1;b>=0;--b){this.processUserPosition(Kameleoon.poweredNodes[b].originalElement,Kameleoon.poweredNodes[b].baseElement,data?data.userPosition:null,true)}}};Kameleoon.Utils={LOCAL_STORAGE_OBFUSCATED_KEYS:{kameleoonData:true},api:{mapAll:function(c,b,a){b.forEach(function(e,d){a.push(Kameleoon.Utils.api.mapItems(c,b,d))});return a},mapItems:function(c,b,a){var f={},e;e=(b.constructor===Array&&a!==undefined)?b[a]:b;for(var d in e){if(e[d]!==undefined&&e[d]!==null&&c.indexOf(d)===-1){f[d]=e[d]}}return f}},computeCurrentPageCleanAbsoluteURL:function(){return this.computeURLNoKameleoonParameters(this.computeCurrentPageAbsoluteURLNoProxyMode())},computeCurrentPageCleanRelativeURL:function(){return this.computeRelativeURL(this.computeCurrentPageCleanAbsoluteURL())},computeCurrentPageAbsoluteURLNoProxyMode:function(){if(Kameleoon.Internals.proxyMode){var d=Kameleoon.Internals.parameters.kameleoonExperimentId;if(d!=null){for(var c=0,b=Kameleoon.Internals.configuration.experiments.length;c<b;++c){var a=Kameleoon.Internals.configuration.experiments[c];if(a.id==d){return a.baseURL}}}}return window.location.href},computeURLNoKameleoonParameters:function(a){return a.replace(/(\?|&|#)kameleoon[^&#]*/g,"")},computeURLRegExpNoKameleoonParameters:function(a){return a.replace(/(\\\?|&|#)kameleoon[^&#()]*/g,"")},computeRelativeURL:function(c){var b=document.createElement("a");b.href=c;return b.pathname+b.search+b.hash},JSONParse:function(string){return(((typeof JSON!="undefined")&&JSON.parse)?JSON.parse(string):eval("("+string+")"))},JSONStringify:function(a){var c=null;if((typeof JSON!="undefined"&&JSON.stringify)&&("[]"===JSON.stringify([])||!a.toJSON)){var b=Array.prototype.toJSON;if(b){delete Array.prototype.toJSON}c=JSON.stringify(a);if(b){Array.prototype.toJSON=b}}else{if(a.toJSON&&"[]"===[].toJSON()){c=a.toJSON()}else{if((typeof JSON!="undefined"&&JSON.encode)&&"[]"===JSON.encode([])){c=JSON.encode(a)}}}return c},performBeaconServerCall:function(c,b,a){var d=new XMLHttpRequest();if(d.withCredentials!==undefined||!XDomainRequest){d.open("GET",c,true);if(b){d.onreadystatechange=b}if(a){d.onerror=a}d.send()}else{d=new XDomainRequest();d.open("get",c);if(b){d.onload=b}d.send()}},runProtectedFunction:function(b){try{b()}catch(a){if(typeof console!=="undefined"&&console.log){console.log("An error occurred in one of your Kameleoon custom JavaScript functions, please check your code.");console.log(a,a.message)}Kameleoon.API.processPageLoaded()}},obtainComputedStyle:function(a){if(window.getComputedStyle){var b=getComputedStyle(a,"");return b?b:{backgroundImage:"none"}}else{return a.currentStyle}},setStyle:function(c,f,e,b){Kameleoon.Analyst.saveElementOriginalData(c);var g=c.style.cssText;if(g){g=g.replace(/^\s+|\s+$/g,"");var a=new RegExp("(^|;)(\\s*"+f+"(.*?);)");g=g.replace(a,"$1");if(g){if(g.lastIndexOf(";")<(g.length-2)){g=g+";"}if(g.lastIndexOf(" ")!=(g.length-1)&&e){g=g+" "}}}else{g=""}var d=g+(e?(f+": "+e+(b?" !important;":";")):"");c.style.cssText=d},processMessageEvent:function(d){if(typeof d.data!=="string"){return}if("obtainTagCommanderVariableNames"==d.data){var b=[];if(window.tc_vars){for(var a in window.tc_vars){b.push(a)}}d.source.postMessage("tagCommanderVariableNames"+Kameleoon.Utils.JSONStringify(b),d.origin);return}if("checkKameleoonScriptPresent"==d.data){d.source.postMessage("kameleoonScriptPresent"+Kameleoon.Internals.siteCode,d.origin);return}if(Kameleoon.Internals.configuration.useWideDomainSupport&&(Kameleoon.Internals.postMessageOrigin==d.origin)){var c=Kameleoon.Utils.JSONParse(d.data);if(c.callbackId){var e=Kameleoon.Internals.postMessageCallbacks[c.callbackId];delete (Kameleoon.Internals.postMessageCallbacks[c.callbackId]);e&&e(c.data)}}},addPostMessageCallback:function(b){var a=Math.random().toString();Kameleoon.Internals.postMessageCallbacks[a]=b;return a},postMessageToExternalIframe:function(a){Kameleoon.Internals.externalIframe.contentWindow.postMessage("kameleoon"+a,"*")},encodeString:function(d){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var a="";var l,j,g,k,h,f,e;var c=0;d=this.encodeUTF8(d);while(c<d.length){l=d.charCodeAt(c++);j=d.charCodeAt(c++);g=d.charCodeAt(c++);k=l>>2;h=((l&3)<<4)|(j>>4);f=((j&15)<<2)|(g>>6);e=g&63;if(isNaN(j)){f=e=64}else{if(isNaN(g)){e=64}}a=a+b.charAt(k)+b.charAt(h)+b.charAt(f)+b.charAt(e)}return a},decodeString:function(d){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var a="";var l,j,g;var k,h,f,e;var c=0;d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<d.length){k=b.indexOf(d.charAt(c++));h=b.indexOf(d.charAt(c++));f=b.indexOf(d.charAt(c++));e=b.indexOf(d.charAt(c++));l=(k<<2)|(h>>4);j=((h&15)<<4)|(f>>2);g=((f&3)<<6)|e;a=a+String.fromCharCode(l);if(f!=64){a=a+String.fromCharCode(j)}if(e!=64){a=a+String.fromCharCode(g)}}a=this.decodeUTF8(a);return a},obfuscateString:function(b){var d="";for(var c=0,a=b.length;c<a;c+=1){d+=String.fromCharCode(b[c].charCodeAt(0)+16)}return d},unobfuscateString:function(d){var b="";for(var c=0,a=d.length;c<a;c+=1){b+=String.fromCharCode(d[c].charCodeAt(0)-16)}return b},encodeUTF8:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},decodeUTF8:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b},restoreStoredData:function(c){var a=this;var b=Kameleoon.Internals;if(b.configuration.useWideDomainSupport){a.postMessageToExternalIframe(a.JSONStringify({type:"get",key:"kameleoonData",callbackId:a.addPostMessageCallback(function(d){b.storedData=a.LOCAL_STORAGE_OBFUSCATED_KEYS.kameleoonData&&a.JSONParse(a.unobfuscateString(d))||d;c&&c()})}))}else{b.storedData=a.readLocalData("kameleoonData","LS",true);c&&c()}},saveStoredData:function(a){this.createLocalData("kameleoonData",Kameleoon.Internals.storedData||{},1000,null,"LS",true,a)},createLocalData:function(a,j,l,e,c,b,m,n){var i=this;var g=Kameleoon.Internals;var k=("LS"==c)?true:(("COOKIE"==c)?false:Kameleoon.Internals.configuration.useLocalStorage);if((!n)&&(!Kameleoon.Internals.saveLocalDataAllowed)){var h=k?"LS":"COOKIE";if(Kameleoon.Internals.localDataMap==null){Kameleoon.Internals.localDataMap={}}if(Kameleoon.Internals.localDataMap[h]==null){Kameleoon.Internals.localDataMap[h]={}}Kameleoon.Internals.localDataMap[h][a]={name:a,value:j,days:l,domain:e,forceLocalAccess:c,jsonFormat:b,creationTime:new Date().getTime()};if(k){m&&m()}return}if(k){var d=g.currentTime+(l*24*60*60*1000);if(g.configuration.useWideDomainSupport){i.postMessageToExternalIframe(i.JSONStringify({type:"set",key:a,data:{value:i.LOCAL_STORAGE_OBFUSCATED_KEYS[a]&&i.obfuscateString(i.JSONStringify(j))||j,date:d},callbackId:i.addPostMessageCallback(m)}))}else{var f=i.JSONStringify({value:j,date:d});localStorage.setItem(a,i.LOCAL_STORAGE_OBFUSCATED_KEYS[a]&&i.obfuscateString(f)||f);m&&m()}}else{var o="";if(l){var d=new Date();d.setTime(d.getTime()+(l*24*60*60*1000));o="; expires="+d.toGMTString()}if("CURRENT_HOST"!=e){e=e||i.obtainCurrentRootDomain();o+="; domain="+e}document.cookie=a+"="+(b?i.JSONStringify(j):j)+o+"; path=/"}},readLocalData:function(b,f,d){var s=this;var m=Kameleoon.Internals;var t=f==="LS"||f!=="COOKIE"&&m.configuration.useLocalStorage;try{if(!Kameleoon.Internals.saveLocalDataAllowed){var a=Kameleoon.Internals.localDataMap;var r=t?"LS":"COOKIE";if((a!=null)&&(a[r]!=null)&&(a[r][b]!=null)){var j=a[r][b];if(new Date().getTime()-(j.days*24*60*60*1000)>=j.creationTime){delete a[r][b]}else{return j.value}}}if(t){var j=localStorage&&localStorage.getItem(b);if(!j){return null}var l=false;if(s.LOCAL_STORAGE_OBFUSCATED_KEYS[b]){if(j.slice(0,2)==='{"'&&j.slice(-1)==="}"){l=true}else{j=s.unobfuscateString(j)}}j=s.JSONParse(j);if(m.currentTime>j.date){localStorage.removeItem(b);return null}return l&&s.JSONParse(s.decodeString(j.value))||j.value}else{var p=b+"=";var g=document.cookie.split(";");for(var h=0,k=g.length,o,q;h<k;++h){o=g[h].trim();q=o.indexOf(p);if(q===-1){continue}j=o.slice(q+p.length);return d&&s.JSONParse(j)||j}}}catch(n){}return null},eraseLocalData:function(c,e,h){var b=this;var d=Kameleoon.Internals;var g=("LS"==h)?true:(("COOKIE"==h)?false:d.configuration.useLocalStorage);if(!Kameleoon.Internals.saveLocalDataAllowed){var f=Kameleoon.Internals.localDataMap;var a=g?"LS":"COOKIE";if((f!=null)&&(f[a]!=null)&&(f[a][c]!=null)){delete f[a][c]}}if(g){if(d.configuration.useWideDomainSupport){b.postMessageToExternalIframe(b.JSONStringify({type:"remove",key:c,callbackId:b.addPostMessageCallback(null)}))}else{localStorage.removeItem(c)}}else{b.createLocalData(c,"",-1,e,"COOKIE",false,null,true)}},obtainCurrentRootDomain:function(){if(Kameleoon.Internals.currentRootDomain==null){var d=window.location.hostname.split(".");var c="";for(var b=0,a=d.length;b<a;b++){if(b>0){c="."+c}c=d[a-b-1]+c;this.createLocalData("kameleoonTestCookie","test",1,c,"COOKIE",false,undefined,true);if(this.readLocalData("kameleoonTestCookie","COOKIE",false)){this.eraseLocalData("kameleoonTestCookie",c,"COOKIE");Kameleoon.Internals.currentRootDomain=c;break}}}return Kameleoon.Internals.currentRootDomain},obtainRandomString:function(e){var b="0123456789abcdefghijklmnopqrstuvwxyz";var a="";for(var c=0;c<e;++c){var d=Math.floor(Math.random()*b.length);a+=b.substring(d,d+1)}return a},parseParameters:function(){var e={};var a=window.location.search.substring(1);if(a){a=a.split("&");for(var d=0,b=a.length;d<b;++d){var f=a[d].split("=");try{e[decodeURIComponent(f[0])]=f[1]?decodeURIComponent(f[1]):null}catch(c){e[unescape(f[0])]=f[1]?unescape(f[1]):null}}}a=window.location.hash.substring(1);if(bowser.firefox){a=window.location.toString().substring(window.location.toString().indexOf("#")+1)}if(a){a=a.split("&");for(var d=0,b=a.length;d<b;++d){var f=a[d].split("=");try{e[decodeURIComponent(f[0])]=f[1]?decodeURIComponent(f[1]):null}catch(c){e[unescape(f[0])]=f[1]?unescape(f[1]):null}}}return e},addParameterToURL:function(a,d,c){if(c){return(a+((-1==a.indexOf("#"))?"#":"&")+d)}var b="";if(-1!=a.indexOf("#")){b=a.substr(a.indexOf("#"));a=a.substr(0,a.indexOf("#"))}a+=((-1==a.indexOf("?"))?"?":"&")+d+b;return a},removeBlockingStyleSheet:function(){var a=document.getElementById("kameleoonPageLoading");if(a&&a.parentNode){a.parentNode.removeChild(a)}},domReady:function(a){if("complete"==document.readyState||"loaded"==document.readyState||("interactive"==document.readyState&&(!Kameleoon.Internals.internetExplorer||Kameleoon.Internals.modernInternetExplorer))){return a()}return document.addEventListener("DOMContentLoaded",a,false)},obtainDepth:function(b){var a=0;while(!(b.parentNode===null)){++a;b=b.parentNode}return a},collectionToArray:function(d){var a=[];for(var c=0,b=d.length;c<b;++c){a.push(d[c])}return a},getLocale:function(b){var a=null;if(navigator){if(navigator.language){a=navigator.language}else{if(navigator.browserLanguage){a=navigator.browserLanguage}else{if(navigator.systemLanguage){a=navigator.systemLanguage}else{if(navigator.userLanguage){a=navigator.userLanguage}}}}}if("fr-FR"==a){a="fr"}if("en-US"==a){a="en"}if(b&&(!a||"fr"!=a)){a="en"}return a},callJavaScriptCode:function(b){var a=document.createElement("script");a.type="text/javascript";Kameleoon.Internals.headNode.appendChild(a);if(Kameleoon.Internals.internetExplorer){a.text=b}else{a.appendChild(document.createTextNode(b))}},checkElementLoaded:function(a){if(!a||!a.parentNode){return false}return((a.nextSibling)?true:this.checkElementLoaded(a.parentNode))},checkElementIsInDocument:function(c,a){var b=null,d=document;if(a.context){b=Kameleoon.Utils.querySelectorAll(a.context);if(b[0]){d=b[0].contentWindow.document}}while(c&&c!=d.documentElement&&c!=Kameleoon.Internals.virtualRootElement){if(c.parentNode){c=c.parentNode}else{return false}}return(c==d.documentElement)?true:"VIRTUAL"},clone:function(a){return this.JSONParse(this.JSONStringify(a))},treatContainsSelector:function(a){var d={},c;function b(g,e){var f=false;if(e.innerText.indexOf(g)!==-1){f=true}return f}c=a.match(/:contains\([^]([^)]+)[^]\)/);d.containText=c[1];d.newSelector=a.replace(c[0],"");if(d.newSelector===""){d.newSelector="*"}d.check=b;return d},querySelectorAll:function(b,a){var g=false,f,h,d=[];if(a==null){a=document}if(Kameleoon.Internals.configuration.sizzle){return Sizzle(b,a)}var h=a.querySelectorAll(b);var d=[];for(var e=0,c=h.length;e<c;++e){d.push(h[e])}return d}};Kameleoon.Loader={enableKameleoonEditorListener:function(){if(!this.editorListenerEnabled){this.editorListenerEnabled=true;var a=function(b){Kameleoon.Loader.listenKeys.call(Kameleoon.Loader,b)};document.addEventListener("keyup",a,false)}},listenKeys:function(a){if(a.shiftKey){if(113==a.keyCode&&Kameleoon.Internals.configuration.abtestingSetup){Kameleoon.Internals.editorMode=true;Kameleoon.Analyst.loadKameleoonFull(function(){Kameleoon.Loader.enableKameleoonEditor.apply(Kameleoon.Loader)})}if(115==a.keyCode&&(Kameleoon.Internals.simulationMode||Kameleoon.Internals.parameters.kameleoonVariationSelection)){Kameleoon.Analyst.loadKameleoonFull(function(){Kameleoon.Loader.displayVariationSelectionPopup.apply(Kameleoon.Loader)})}}}};Kameleoon.Analyst.processATInternetTracking=function(experiment){var atInternetAlreadyLoaded=(undefined!==window.xt_mvt&&undefined!==window.xtsite);var escapedExperimentName=experiment.name.replace(/\//gi,"-").replace(/#/g,"-");var variationId=(("reference"==experiment.registeredVariation.id)?0:experiment.registeredVariation.id)+(experiment.mentalistEnabled?1000:0);var experimentData=experiment.id+"["+escapedExperimentName+"]-0-"+variationId+"["+encodeURIComponent(experiment.registeredVariation.name)+"]";var mvtData=[];var experimentDataParameter="&abmvc="+experimentData;if(experiment.factors){var k=0;for(var i=0,l=experiment.factors.length;i<l;++i){++k;var regExp=new RegExp(experiment.factors[i].name+"_(.*?)( /|\\.)");var match=regExp.exec(experiment.registeredVariation.name);var versionId=0;if(match){for(var j=0,m=experiment.factors[i].values.length;j<m;++j){if(match[1]==experiment.factors[i].values[j]){versionId=j+1;break}}}var version=match?(versionId+"["+match[1]+"]"):"0[Reference]";mvtData.push((experiment.id*10000+k)+"["+experiment.factors[i].name+"]-"+version)}}for(var i=0,l=mvtData.length;i<l;++i){experimentDataParameter+="&abmv"+(i+1)+"="+mvtData[i]}if(atInternetAlreadyLoaded&&!experiment.atInternetTracking.forceXtCoreMissing){window.xt_mvt(window.xtpage,window.xtn2,experimentData,mvtData)}else{if(experiment.atInternetTracking.xtCoreMissingScript){var atCallURL=eval("(function() {"+experiment.atInternetTracking.xtCoreMissingScript+"})();");if(atCallURL&&document.body){var mvtHitImage=document.createElement("img");mvtHitImage.src=atCallURL+experimentDataParameter+"&type=mvt";document.body.appendChild(mvtHitImage)}else{window.setTimeout(function(){Kameleoon.Analyst.processATInternetTracking.apply(Kameleoon.Analyst,[experiment])},150)}}else{if(Kameleoon.Internals.firstAtInternetCallUsed||experiment.atInternetTracking.alwaysUseMVTCall||experiment.atInternetTracking.xtCoreMissing){window.setTimeout(function(){Kameleoon.Analyst.processATInternetTracking.apply(Kameleoon.Analyst,[experiment])},150)}else{if(null!=window.xtparam){window.xtparam+=experimentDataParameter}else{window.xtparam=experimentDataParameter}Kameleoon.Internals.firstAtInternetCallUsed=true}}}};Kameleoon.Analyst.evaluateTargeting_DOM_ELEMENT=function(c){var a=undefined,b=false;if(c.value){a=(Kameleoon.Utils.querySelectorAll(c.value).length>0)}else{if(c.elementSets){a=(this.obtainElements(c.elementSets,false,false,null).length>0)}}if(!Kameleoon.Internals.domReady&&!a){a=undefined;b=true}return{targeting:a,rescheduleTargeting:b}};!function(c){var b=function(){var p="s",x={DAY:86400000,HOUR:3600000,MINUTE:60000,SECOND:1000,BASELINE_YEAR:2014,MAX_SCORE:864000000,AMBIGUITIES:{"America/Denver":["America/Mazatlan"],"America/Chicago":["America/Mexico_City"],"America/Santiago":["America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Sao_Paulo"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Europe/Helsinki","Asia/Damascus","Africa/Cairo","Asia/Gaza","Europe/Minsk"],"Pacific/Auckland":["Pacific/Fiji"],"America/Los_Angeles":["America/Santa_Isabel"],"America/New_York":["America/Havana"],"America/Halifax":["America/Goose_Bay"],"America/Godthab":["America/Miquelon"],"Asia/Dubai":["Asia/Yerevan"],"Asia/Jakarta":["Asia/Krasnoyarsk"],"Asia/Shanghai":["Asia/Irkutsk","Australia/Perth"],"Australia/Sydney":["Australia/Lord_Howe"],"Asia/Tokyo":["Asia/Yakutsk"],"Asia/Dhaka":["Asia/Omsk"],"Asia/Baku":["Asia/Yerevan"],"Australia/Brisbane":["Asia/Vladivostok"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Majuro":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk","Europe/Moscow"],"Asia/Karachi":["Asia/Yekaterinburg"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]}},k=function(l){var i=-l.getTimezoneOffset();return null!==i?i:0},a=function(){var e=k(new Date(x.BASELINE_YEAR,0,2)),i=k(new Date(x.BASELINE_YEAR,5,2)),l=e-i;return 0>l?e+",1":l>0?i+",1,"+p:e+",0"},g=function(){if("undefined"!=typeof Intl&&"undefined"!=typeof Intl.DateTimeFormat){var i=Intl.DateTimeFormat();if("undefined"!=typeof i&&"undefined"!=typeof i.resolvedOptions){return i.resolvedOptions().timeZone}}},f=function(B){for(var C=new Date(B,0,1,0,0,1,0).getTime(),E=new Date(B,12,31,23,59,59).getTime(),z=C,l=new Date(z).getTimezoneOffset(),y=null,m=null;E-86400000>z;){var t=new Date(z),D=t.getTimezoneOffset();D!==l&&(l>D&&(y=t),D>l&&(m=t),l=D),z+=86400000}return y&&m?{s:w(y).getTime(),e:w(m).getTime()}:!1},w=function j(B,D,z){"undefined"==typeof D&&(D=x.DAY,z=x.HOUR);for(var l=new Date(B.getTime()-D).getTime(),y=B.getTime()+D,m=new Date(l).getTimezoneOffset(),F=l,s=null;y-z>F;){var E=new Date(F),C=E.getTimezoneOffset();if(C!==m){s=E;break}F+=z}return D===x.DAY?j(s,x.HOUR,x.MINUTE):D===x.HOUR?j(s,x.MINUTE,x.SECOND):s},d=function(o,l,n,m){if("N/A"!==n){return n}if("Asia/Beirut"===l){if("Africa/Cairo"===m.name&&1398376800000===o[6].s&&1411678800000===o[6].e){return 0}if("Asia/Jerusalem"===m.name&&1395964800000===o[6].s&&1411858800000===o[6].e){return 0}}else{if("America/Santiago"===l){if("America/Asuncion"===m.name&&1412481600000===o[6].s&&1397358000000===o[6].e){return 0}if("America/Campo_Grande"===m.name&&1413691200000===o[6].s&&1392519600000===o[6].e){return 0}}else{if("America/Montevideo"===l){if("America/Sao_Paulo"===m.name&&1413687600000===o[6].s&&1392516000000===o[6].e){return 0}}else{if("Pacific/Auckland"===l&&"Pacific/Fiji"===m.name&&1414245600000===o[6].s&&1396101600000===o[6].e){return 0}}}}return n},v=function(E,C){for(var s=function(e){for(var i=0,l=0;l<E.length;l++){if(e.rules[l]&&E[l]){if(!(E[l].s>=e.rules[l].s&&E[l].e<=e.rules[l].e)){i="N/A";break}if(i=0,i+=Math.abs(E[l].s-e.rules[l].s),i+=Math.abs(e.rules[l].e-E[l].e),i>x.MAX_SCORE){i="N/A";break}}}return i=d(E,C,i,e)},z={},y=b.olson.dst_rules.zones,H=y.length,G=x.AMBIGUITIES[C],F=0;H>F;F++){var A=y[F],B=s(y[F]);"N/A"!==B&&(z[A.name]=B)}for(var D in z){if(z.hasOwnProperty(D)&&-1!=G.indexOf(D)){return D}}return C},q=function(t){var m=function(){for(var y=[],r=0;r<b.olson.dst_rules.years.length;r++){var n=f(b.olson.dst_rules.years[r]);y.push(n)}return y},l=function(n){for(var i=0;i<n.length;i++){if(n[i]!==!1){return !0}}return !1},o=m(),u=l(o);return u?v(o,t):t},h=function(){var i=g();return i||(i=b.olson.timezones[a()],"undefined"!=typeof x.AMBIGUITIES[i]&&(i=q(i))),{name:function(){return i}}};return{determine:h}}();b.olson=b.olson||{},b.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-660,1,s":"Pacific/Apia","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Majuro","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},b.olson.dst_rules={years:[2008,2009,2010,2011,2012,2013,2014],zones:[{name:"Africa/Cairo",rules:[{e:1219957200000,s:1209074400000},{e:1250802000000,s:1240524000000},{e:1285880400000,s:1284069600000},!1,!1,!1,{e:1411678800000,s:1406844000000}]},{name:"America/Asuncion",rules:[{e:1205031600000,s:1224388800000},{e:1236481200000,s:1255838400000},{e:1270954800000,s:1286078400000},{e:1302404400000,s:1317528000000},{e:1333854000000,s:1349582400000},{e:1364094000000,s:1381032000000},{e:1395543600000,s:1412481600000}]},{name:"America/Campo_Grande",rules:[{e:1203217200000,s:1224388800000},{e:1234666800000,s:1255838400000},{e:1266721200000,s:1287288000000},{e:1298170800000,s:1318737600000},{e:1330225200000,s:1350792000000},{e:1361070000000,s:1382241600000},{e:1392519600000,s:1413691200000}]},{name:"America/Goose_Bay",rules:[{e:1225594860000,s:1205035260000},{e:1257044460000,s:1236484860000},{e:1289098860000,s:1268539260000},{e:1320555600000,s:1299988860000},{e:1352005200000,s:1331445600000},{e:1383454800000,s:1362895200000},{e:1414904400000,s:1394344800000}]},{name:"America/Havana",rules:[{e:1224997200000,s:1205643600000},{e:1256446800000,s:1236488400000},{e:1288501200000,s:1268542800000},{e:1321160400000,s:1300597200000},{e:1352005200000,s:1333256400000},{e:1383454800000,s:1362891600000},{e:1414904400000,s:1394341200000}]},{name:"America/Mazatlan",rules:[{e:1225008000000,s:1207472400000},{e:1256457600000,s:1238922000000},{e:1288512000000,s:1270371600000},{e:1319961600000,s:1301821200000},{e:1351411200000,s:1333270800000},{e:1382860800000,s:1365325200000},{e:1414310400000,s:1396774800000}]},{name:"America/Mexico_City",rules:[{e:1225004400000,s:1207468800000},{e:1256454000000,s:1238918400000},{e:1288508400000,s:1270368000000},{e:1319958000000,s:1301817600000},{e:1351407600000,s:1333267200000},{e:1382857200000,s:1365321600000},{e:1414306800000,s:1396771200000}]},{name:"America/Miquelon",rules:[{e:1225598400000,s:1205038800000},{e:1257048000000,s:1236488400000},{e:1289102400000,s:1268542800000},{e:1320552000000,s:1299992400000},{e:1352001600000,s:1331442000000},{e:1383451200000,s:1362891600000},{e:1414900800000,s:1394341200000}]},{name:"America/Santa_Isabel",rules:[{e:1225011600000,s:1207476000000},{e:1256461200000,s:1238925600000},{e:1288515600000,s:1270375200000},{e:1319965200000,s:1301824800000},{e:1351414800000,s:1333274400000},{e:1382864400000,s:1365328800000},{e:1414314000000,s:1396778400000}]},{name:"America/Sao_Paulo",rules:[{e:1203213600000,s:1224385200000},{e:1234663200000,s:1255834800000},{e:1266717600000,s:1287284400000},{e:1298167200000,s:1318734000000},{e:1330221600000,s:1350788400000},{e:1361066400000,s:1382238000000},{e:1392516000000,s:1413687600000}]},{name:"Asia/Amman",rules:[{e:1225404000000,s:1206655200000},{e:1256853600000,s:1238104800000},{e:1288303200000,s:1269554400000},{e:1319752800000,s:1301608800000},!1,!1,{e:1414706400000,s:1395957600000}]},{name:"Asia/Damascus",rules:[{e:1225486800000,s:1207260000000},{e:1256850000000,s:1238104800000},{e:1288299600000,s:1270159200000},{e:1319749200000,s:1301608800000},{e:1351198800000,s:1333058400000},{e:1382648400000,s:1364508000000},{e:1414702800000,s:1395957600000}]},{name:"Asia/Dubai",rules:[!1,!1,!1,!1,!1,!1,!1]},{name:"Asia/Gaza",rules:[{e:1219957200000,s:1206655200000},{e:1252015200000,s:1238104800000},{e:1281474000000,s:1269640860000},{e:1312146000000,s:1301608860000},{e:1348178400000,s:1333058400000},{e:1380229200000,s:1364508000000},{e:1411678800000,s:1395957600000}]},{name:"Asia/Irkutsk",rules:[{e:1224957600000,s:1206813600000},{e:1256407200000,s:1238263200000},{e:1288461600000,s:1269712800000},!1,!1,!1,!1]},{name:"Asia/Jerusalem",rules:[{e:1223161200000,s:1206662400000},{e:1254006000000,s:1238112000000},{e:1284246000000,s:1269561600000},{e:1317510000000,s:1301616000000},{e:1348354800000,s:1333065600000},{e:1382828400000,s:1364515200000},{e:1414278000000,s:1395964800000}]},{name:"Asia/Kamchatka",rules:[{e:1224943200000,s:1206799200000},{e:1256392800000,s:1238248800000},{e:1288450800000,s:1269698400000},!1,!1,!1,!1]},{name:"Asia/Krasnoyarsk",rules:[{e:1224961200000,s:1206817200000},{e:1256410800000,s:1238266800000},{e:1288465200000,s:1269716400000},!1,!1,!1,!1]},{name:"Asia/Omsk",rules:[{e:1224964800000,s:1206820800000},{e:1256414400000,s:1238270400000},{e:1288468800000,s:1269720000000},!1,!1,!1,!1]},{name:"Asia/Vladivostok",rules:[{e:1224950400000,s:1206806400000},{e:1256400000000,s:1238256000000},{e:1288454400000,s:1269705600000},!1,!1,!1,!1]},{name:"Asia/Yakutsk",rules:[{e:1224954000000,s:1206810000000},{e:1256403600000,s:1238259600000},{e:1288458000000,s:1269709200000},!1,!1,!1,!1]},{name:"Asia/Yekaterinburg",rules:[{e:1224968400000,s:1206824400000},{e:1256418000000,s:1238274000000},{e:1288472400000,s:1269723600000},!1,!1,!1,!1]},{name:"Asia/Yerevan",rules:[{e:1224972000000,s:1206828000000},{e:1256421600000,s:1238277600000},{e:1288476000000,s:1269727200000},{e:1319925600000,s:1301176800000},!1,!1,!1]},{name:"Australia/Lord_Howe",rules:[{e:1207407600000,s:1223134200000},{e:1238857200000,s:1254583800000},{e:1270306800000,s:1286033400000},{e:1301756400000,s:1317483000000},{e:1333206000000,s:1349537400000},{e:1365260400000,s:1380987000000},{e:1396710000000,s:1412436600000}]},{name:"Australia/Perth",rules:[{e:1206813600000,s:1224957600000},!1,!1,!1,!1,!1,!1]},{name:"Europe/Helsinki",rules:[{e:1224982800000,s:1206838800000},{e:1256432400000,s:1238288400000},{e:1288486800000,s:1269738000000},{e:1319936400000,s:1301187600000},{e:1351386000000,s:1332637200000},{e:1382835600000,s:1364691600000},{e:1414285200000,s:1396141200000}]},{name:"Europe/Minsk",rules:[{e:1224979200000,s:1206835200000},{e:1256428800000,s:1238284800000},{e:1288483200000,s:1269734400000},!1,!1,!1,!1]},{name:"Europe/Moscow",rules:[{e:1224975600000,s:1206831600000},{e:1256425200000,s:1238281200000},{e:1288479600000,s:1269730800000},!1,!1,!1,!1]},{name:"Pacific/Apia",rules:[!1,!1,!1,{e:1301752800000,s:1316872800000},{e:1333202400000,s:1348927200000},{e:1365256800000,s:1380376800000},{e:1396706400000,s:1411826400000}]},{name:"Pacific/Fiji",rules:[!1,!1,{e:1269698400000,s:1287842400000},{e:1327154400000,s:1319292000000},{e:1358604000000,s:1350741600000},{e:1390050000000,s:1382796000000},{e:1421503200000,s:1414850400000}]}]},"undefined"!=typeof exports?exports.jstz=b:c.jstz=b}(this);Kameleoon.Gatherer={SCRIPT_VERSION:20160408,MIN_STORED_DATA_VERSION:20150427,DROPPED_VISITOR_CODE:"droppedvisitor",VISITOR_CODE_LENGTH:16,MAX_VISIT_IDLE_DURATION:30*60*1000,ACTIVITY_TRACKING_INTERVAL:30*1000,INTERESTS_TRACKING_TIMEOUT_AFTER_WINDOW_LOAD:2*1000,INTERESTS_TRACKING_INTERVAL:5*60*1000,INTERESTS_FRESHNESS_DURATION:7*24*60*60*1000,IMAGES_DETECTION_TEST_IMAGE:"images/common/benchmark.bmp",IMAGES_DETECTION_DEFAULT_CACHE_TIMEOUT:20,CUSTOM_DATA_TRACKING_INTERVAL:30*1000,TAB_COUNT_TRACKING_INTERVAL:15*1000,NUMBER_CLICKS_TRACKING_INTERVAL:30*1000,MAX_NUMBER_CONVERSIONS_IN_A_REQUEST:20,MAX_NUMBER_MENTALIST_ACTIONS_IN_A_REQUEST:10,MAX_NUMBER_CONTAINERS_IN_A_REQUEST:20,REFERENCE_VARIATION_ID_IN_A_REQUEST:0,MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST:2048,GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX:254,DEFAULT_CUSTOM_DATUM_SCOPE:"VISIT",CUSTOM_DATA_RETRY_DELAY_BEFORE_CUT_OFF:100,CUSTOM_DATA_CUTOFF:3*1000,OPEN_WEATHER_MAP_APPID:"c47db1e8ab50752e5f42c72f175b5210",VISITOR_DATA_FROM_SERVER_TRACKING_TIMEOUT:2*1000,DEFAULT_LOCALE_LANGUAGE_TAG:"en",ENABLE_TAB_COUNT:false,DEBUG_LEVEL:{TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5},run:function(){var trackPage=function(callback){var date=new Date();this.updateIfStartOfVisit(date,true,function(startOfVisit){this.LocalDataHandler.registerAction(function(){this.saveFieldToVisitCookieOrStoredData("timeLastActivity",date.getTime());Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addPage(date,this.obtainKeyPagesIndexes(),this.obtainReferrersIndexes(startOfVisit));Kameleoon.Visitor.saveToStoredData();if(startOfVisit){this.performGoalConversionPredictionsAtStartOfVisit()}if(Kameleoon.Internals.configuration.Gatherer.track&&((["medium","full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)||(startOfVisit&&(["light","medium","full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)))){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(date,"event=page&keyPages="+this.joinAll(this.obtainKeyPagesIndexes(),"-")+"&referrers="+this.joinAll(this.obtainReferrersIndexes(startOfVisit),"-"),startOfVisit)}}if(Kameleoon.Internals.pageCallbacks!=null){for(var k=0,n=Kameleoon.Internals.pageCallbacks.length;k<n;++k){try{Kameleoon.Internals.pageCallbacks[k](date,this.obtainKeyPagesIndexes(),this.obtainReferrersIndexes(startOfVisit))}catch(exception){}}}callback&&callback()}.bind(this),false,true,{urgent:true})}.bind(this))}.bind(this);var scheduleActivityTracking=function(){Kameleoon.Internals.Gatherer.active=false;var setActivity=function(){Kameleoon.Internals.Gatherer.active=true}.bind(this);document.addEventListener("mousemove",setActivity,false);document.addEventListener("scroll",setActivity,false);this.LocalDataHandler.registerAction(function(){this.trackActivity(Kameleoon.Internals.Gatherer.active);Kameleoon.Internals.Gatherer.active=false}.bind(this),true,false,{repeatInterval:this.ACTIVITY_TRACKING_INTERVAL})}.bind(this);var scheduleInterestsTracking=function(){var launchInterestsTrackingScheduler=function(){window.setTimeout(function(){this.LocalDataHandler.registerAction(function(){if(!bowser.gecko&&!bowser.webkit){return}var currentTime=new Date().getTime();Kameleoon.Internals.numberInterestChecks=0;Kameleoon.Internals.Gatherer.inheritedActiveInterestIndexes=[];Kameleoon.Internals.Gatherer.potentialFreshActiveInterestIndexes=[];for(var i=0,l=Kameleoon.Internals.configuration.Gatherer.interests.length;i<l;++i){if(!Kameleoon.Internals.configuration.Gatherer.interests[i].disabled){var lastVisitWithFreshActiveInterest=Kameleoon.Visitor.obtainLastVisitWithFreshActiveInterest(i);if((lastVisitWithFreshActiveInterest==null)||(Kameleoon.Internals.Visitor.currentVisit.timeStarted-lastVisitWithFreshActiveInterest.timeStarted>this.INTERESTS_FRESHNESS_DURATION)){Kameleoon.Internals.Gatherer.potentialFreshActiveInterestIndexes.push(i)}else{Kameleoon.Internals.Gatherer.inheritedActiveInterestIndexes.push(i)}}}this.trackInterests(Kameleoon.Internals.Gatherer.inheritedActiveInterestIndexes,false);Kameleoon.Internals.Gatherer.freshActiveInterestIndexes=[];var cacheTimeout=Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout;if(cacheTimeout==null){cacheTimeout=this.IMAGES_DETECTION_DEFAULT_CACHE_TIMEOUT}for(var i=0,l=Kameleoon.Internals.Gatherer.potentialFreshActiveInterestIndexes.length;i<l;++i){var currentInterestIndex=Kameleoon.Internals.Gatherer.potentialFreshActiveInterestIndexes[i];var hashes=this.obtainFieldFromStoredData("interestHashes-"+currentInterestIndex);if((!hashes)||Kameleoon.Internals.configuration.Gatherer.interests[currentInterestIndex].constantCheck){var lastCheckTime=this.obtainFieldFromStoredData("interestLastCheckTime-"+currentInterestIndex);if((lastCheckTime==null)||(currentTime-lastCheckTime>=this.INTERESTS_TRACKING_INTERVAL)){this.saveFieldToStoredData("interestLastCheckTime-"+currentInterestIndex,currentTime);var cachedHashesArray=hashes?hashes.split("|"):[];for(var j=0,m=Kameleoon.Internals.configuration.Gatherer.interestsImagesLists[currentInterestIndex].length;j<m;++j){var currentArrayHash=this.computeListHash(Kameleoon.Internals.configuration.Gatherer.interestsImagesLists[currentInterestIndex][j]);if(cachedHashesArray.indexOf(currentArrayHash)==-1){hashes=(hashes?hashes+"|":"")+currentArrayHash;this.saveFieldToStoredData("interestHashes-"+currentInterestIndex,hashes);++Kameleoon.Internals.numberInterestChecks;var iframeNode=document.createElement("iframe");iframeNode.style.display="none";iframeNode.className="KameleoonInterestDetection";var frameCode="var cacheTimeout = "+cacheTimeout+";";frameCode+="var currentInterestIndex = "+currentInterestIndex+";";frameCode+="var urls = "+JSON.stringify(Kameleoon.Internals.configuration.Gatherer.interestsImagesLists[currentInterestIndex][j])+";";frameCode+='var CoreAlgorithm={webkit:function(b){var d;var c=false;var a=function(){window.removeEventListener("message",a,false);d=new Date().getTime();var f=new Image();f.style.display="none";f.style.position="absolute";f.style.left="-9999px";f.style.top="-9999px";f.src=b;var e=function(j){if(c){--window.currentChecks;return}var h=new Date().getTime();var k=h-d;if(f.complete||f.width>0){--window.currentChecks;var g=true;if(/(\.css|\.js|\.swf)/.test(f.src)){g=true}else{if(f.width==0){g=false}}if(g){c=true;window.parent.postMessage(JSON.stringify({command:"addKameleoonInterest",index:currentInterestIndex}),"*")}window.stop();window.stop();delete f;window.removeEventListener("message",e,false)}else{if(h-d>cacheTimeout){--window.currentChecks;if(window.stop!==undefined){window.stop()}else{if(document.execCommand!==undefined){document.execCommand("Stop",false)}}delete f;window.removeEventListener("message",e,false)}else{window.postMessage("toNextMessageInterval","*")}}if(!c&&0==window.currentChecks){window.parent.postMessage(JSON.stringify({command:"finishKameleoonInterestCheck",index:currentInterestIndex}),"*")}};window.addEventListener("message",e,false);window.postMessage("","*")};window.addEventListener("message",a,false);window.postMessage("","*")}};mainCheck=CoreAlgorithm.webkit;window.currentChecks=0;for(var i=0;i<urls.length;++i){++window.currentChecks;mainCheck(urls[i])};';iframeNode.src='javascript:\'<!doctype html><html><head><meta charset="utf-8"><style>*{margin:0;padding:0;border:0;}</style></head><body><script>'+frameCode+"<\/script></body></html>'";Kameleoon.Internals.headNode.appendChild(iframeNode);break}}}}}}.bind(this),true,false,{repeatInterval:this.INTERESTS_TRACKING_INTERVAL,firstRunNow:true})}.bind(this),this.INTERESTS_TRACKING_TIMEOUT_AFTER_WINDOW_LOAD)}.bind(this);if("complete"==document.readyState){launchInterestsTrackingScheduler()}else{window.addEventListener("load",launchInterestsTrackingScheduler,false)}}.bind(this);var scheduleCustomDataTracking=function(){var obtainCustomData=function(){var obtainCustomDataVirtual=function(virtual,customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated){var hasNonReadyOrNullValues=false;for(var i=0,l=Kameleoon.Internals.configuration.Gatherer.customData.length;i<l;++i){if(Kameleoon.Internals.Gatherer.customDataTreatedByIndex[i]==null){var customDatum=Kameleoon.Internals.configuration.Gatherer.customData[i];if(!customDatum.disabled){var customDatumVirtual=customDatum.virtual;if(customDatumVirtual==null){customDatumVirtual=false}if(customDatumVirtual==virtual){var customDatumCurrentValue=Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.valueByCustomDatum[i];if((customDatumCurrentValue==null)||(!customDatum.constant)){var valueMap=this.obtainCustomDatumValueMap(i);if(valueMap!=null){var customDatumDetectedValue=valueMap.value;if(customDatumDetectedValue!=null){customDataTreated.push({name:customDatum.name,index:i});var customDatumType=customDatum.type;var customDatumIsCollection=(customDatumType=="LIST")||(customDatumType=="COUNT_LIST");if(customDatumIsCollection||(customDatumCurrentValue!=customDatumDetectedValue)){customDataIndexes.push(i);customDataValues.push(customDatumDetectedValue);customDataOverwritesIfCollection.push(valueMap.overwrite);if(Kameleoon.Internals.configuration.Gatherer.mappingIdentifier==i){var changePreviousVisits=function(visitsFromServer){for(var i=0,l=visitsFromServer.length;i<l;++i){Kameleoon.Visit.convertVisitFromServer(visitsFromServer[i])}if(visitsFromServer.length>0){this.LocalDataHandler.registerAction(function(){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.changePreviousVisits(visitsFromServer);var previousVisit=visitsFromServer[visitsFromServer.length-1];var correctedVisitorCode=previousVisit.visitorCode;var correctedVisitNumber=previousVisit.visitNumber+1;Kameleoon.Internals.Visitor.currentVisit.visitorCode=correctedVisitorCode;Kameleoon.Internals.Visitor.currentVisit.visitNumber=correctedVisitNumber;this.saveFieldToVisitCookieOrStoredData("visitorCode",correctedVisitorCode);this.saveFieldToVisitCookieOrStoredData("visitNumber",correctedVisitNumber);Kameleoon.Visitor.updateAPIAfterCurrentVisitChange();Kameleoon.Visitor.saveToStoredData();Kameleoon.Internals.configuration.Gatherer.track=Kameleoon.Internals.configuration.Gatherer.track&&(this.DROPPED_VISITOR_CODE!=correctedVisitorCode);window.setTimeout(function(){this.trackVisitorDataFromServerAndPassVisitorScopeData()}.bind(this),this.VISITOR_DATA_FROM_SERVER_TRACKING_TIMEOUT)}.bind(this),false,true,{urgent:true})}}.bind(this);Kameleoon.Utils.performBeaconServerCall(this.obtainVisitsRequestPrefix()+"siteCode="+Kameleoon.Internals.configuration.Gatherer.siteCode+"&mappingIdentifier="+i+"&mappingValueMap="+encodeURIComponent(customDatumDetectedValue),function(){if((this.readyState==4)&&(this.status==200)){changePreviousVisits(Kameleoon.Utils.JSONParse(this.responseText))}})}}}else{hasNonReadyOrNullValues=true}}else{hasNonReadyOrNullValues=true}}}}}}return hasNonReadyOrNullValues}.bind(this);var customDataIndexes=[];var customDataValues=[];var customDataOverwritesIfCollection=[];var customDataTreated=[];var hasNonReadyOrNullValues=false;hasNonReadyOrNullValues=obtainCustomDataVirtual(false,customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated)||hasNonReadyOrNullValues;hasNonReadyOrNullValues=obtainCustomDataVirtual(true,customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated)||hasNonReadyOrNullValues;return[customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated,hasNonReadyOrNullValues]}.bind(this);var registerCustomData=function(obtainCustomDataResult){var customDataIndexes=obtainCustomDataResult[0];var customDataValues=obtainCustomDataResult[1];var customDataOverwritesIfCollection=obtainCustomDataResult[2];var customDataTreated=obtainCustomDataResult[3];this.trackCustomData(customDataIndexes,customDataValues,customDataOverwritesIfCollection);for(var i=0,l=customDataTreated.length;i<l;++i){var customDatumTreated=customDataTreated[i];Kameleoon.API.state.customDataTreated[customDatumTreated.name]=true;Kameleoon.Internals.Gatherer.customDataTreatedByIndex[customDatumTreated.index]=true}}.bind(this);this.LocalDataHandler.registerAction(function(){var obtainCustomDataFirstTryStartTime=new Date().getTime();var obtainCustomDataWithRetriesBeforeCutOff=null;obtainCustomDataWithRetriesBeforeCutOff=function(){var obtainCustomDataResult=obtainCustomData();if(obtainCustomDataResult[4]&&(new Date().getTime()-obtainCustomDataFirstTryStartTime<this.CUSTOM_DATA_CUTOFF)){window.setTimeout(obtainCustomDataWithRetriesBeforeCutOff,this.CUSTOM_DATA_RETRY_DELAY_BEFORE_CUT_OFF)}else{registerCustomData(obtainCustomDataResult)}}.bind(this);obtainCustomDataWithRetriesBeforeCutOff()}.bind(this),Kameleoon.Internals.Gatherer.customDataUpdateNeedsLocalData,false,{});this.LocalDataHandler.registerAction(function(){registerCustomData(obtainCustomData())}.bind(this),Kameleoon.Internals.Gatherer.customDataUpdateNeedsLocalData,false,{repeatInterval:this.CUSTOM_DATA_TRACKING_INTERVAL})}.bind(this);var scheduleTabCountTracking=function(){if(Kameleoon.Internals.configuration.useWideDomainSupport){Kameleoon.Internals.Gatherer.tabCode=Kameleoon.Utils.obtainRandomString(16);this.LocalDataHandler.registerAction(function(){var utils=Kameleoon.Utils;utils.postMessageToExternalIframe(utils.JSONStringify({type:"tabcount",tabCode:Kameleoon.Internals.Gatherer.tabCode,deadTime:new Date().getTime()+this.TAB_COUNT_TRACKING_INTERVAL,callbackId:Kameleoon.Utils.addPostMessageCallback(this.trackTabCount)}))}.bind(this),true,false,{repeatInterval:this.TAB_COUNT_TRACKING_INTERVAL,firstRunNow:true})}}.bind(this);var scheduleNumberClicksTracking=function(){Kameleoon.Internals.Gatherer.numberClicks=0;document.addEventListener("click",function(){Kameleoon.Internals.Gatherer.numberClicks++}.bind(this),false);this.LocalDataHandler.registerAction(function(){this.trackNumberClicks(Kameleoon.Internals.Gatherer.numberClicks);Kameleoon.Internals.Gatherer.numberClicks=0}.bind(this),true,false,{repeatInterval:this.NUMBER_CLICKS_TRACKING_INTERVAL,firstRunNow:true})}.bind(this);var processMessageEvent=function(event){if(typeof event.data!=="string"){return}if((event.data.indexOf("addKameleoonInterest")>=0)||(event.data.indexOf("finishKameleoonInterestCheck")>=0)){var messageData=Kameleoon.Utils.JSONParse(event.data);if("addKameleoonInterest"==messageData.command){Kameleoon.Internals.Gatherer.freshActiveInterestIndexes.push(messageData.index)}--Kameleoon.Internals.numberInterestChecks;if(0==Kameleoon.Internals.numberInterestChecks){window.setTimeout(function(){var iframes=document.getElementsByClassName("KameleoonInterestDetection");for(var i=0,l=iframes.length;i<l;++i){var iframe=iframes.item(0);iframe.parentNode.removeChild(iframe)}this.trackInterests(Kameleoon.Internals.Gatherer.freshActiveInterestIndexes,true)}.bind(this),300)}return}}.bind(this);if(Kameleoon.API==null){Kameleoon.API={}}if(Kameleoon.API.state==null){Kameleoon.API.state={}}Kameleoon.API.state.customDataTreated={};if(Kameleoon.Internals.environment!="DEVELOPMENT"){Kameleoon.Internals.configuration.Gatherer=Kameleoon.Utils.JSONParse(Kameleoon.Utils.decodeString(Kameleoon.Internals.configuration.Gatherer))}if(Kameleoon.Internals.simulationMode&&("none"===Kameleoon.Internals.configuration.Gatherer.trackingMode)){Kameleoon.Internals.configuration.Gatherer.trackingMode="medium"}if(Kameleoon.Internals.Gatherer==null){Kameleoon.Internals.Gatherer={}}Kameleoon.Internals.Gatherer.useVisitCookie=!Kameleoon.Internals.configuration.useWideDomainSupport;Kameleoon.Internals.Gatherer.customDataTreatedByIndex={};Kameleoon.Internals.Gatherer.customDataUpdateNeedsLocalData=false;for(var i=0,l=Kameleoon.Internals.configuration.Gatherer.customData.length;i<l;++i){var customDatum=Kameleoon.Internals.configuration.Gatherer.customData[i];if(!customDatum.disabled){var customDatumScope=this.obtainCorrectedCustomDatumScope(customDatum.scope);if(("VISIT"==customDatumScope)||("VISITOR"==customDatumScope)){Kameleoon.Internals.Gatherer.customDataUpdateNeedsLocalData=true;break}}}if(Kameleoon.Internals.Visitor==null){Kameleoon.Internals.Visitor={}}this.initializeTabDataIfNecessary();if(this.obtainFieldFromTabData("valueByCustomDatum")==null){this.saveFieldToTabData("valueByCustomDatum",{})}this.initializeStoredDataIfNecessary();if(Kameleoon.Internals.Gatherer.useVisitCookie){this.initializeVisitCookieIfNecessary()}this.LocalDataHandler.init();window.addEventListener("message",processMessageEvent,false);if("https:"==window.location.protocol){var interestsImagesListsHTTPS=[];for(var i=0,l=Kameleoon.Internals.configuration.Gatherer.interestsImagesLists.length;i<l;++i){var interestsImagesListsHTTPS_i=[];for(var j=0,m=Kameleoon.Internals.configuration.Gatherer.interestsImagesLists[i].length;j<m;++j){var interestsImagesListsHTTPS_i_j=[];for(var k=0,n=Kameleoon.Internals.configuration.Gatherer.interestsImagesLists[i][j].length;k<n;++k){if(0==Kameleoon.Internals.configuration.Gatherer.interestsImagesLists[i][j][k].indexOf("https:")){interestsImagesListsHTTPS_i_j.push(Kameleoon.Internals.configuration.Gatherer.interestsImagesLists[i][j][k])}}interestsImagesListsHTTPS_i.push(interestsImagesListsHTTPS_i_j)}interestsImagesListsHTTPS.push(interestsImagesListsHTTPS_i)}Kameleoon.Internals.configuration.Gatherer.interestsImagesLists=interestsImagesListsHTTPS}if((Kameleoon.Mentalist!=null)&&(!Kameleoon.Mentalist.computeIsSecure())){Kameleoon.Mentalist=null}this.LocalDataHandler.registerAction(function(){if(Kameleoon.Internals.storedData["Kameleoon.Gatherer.startsOfVisitForCurrentPage"]!=null){var gathererStoredDataNamePrefix="Kameleoon.Gatherer.";for(var key in Kameleoon.Internals.storedData){if(key.indexOf(gathererStoredDataNamePrefix)==0){this.saveFieldToStoredData(key.slice(gathererStoredDataNamePrefix.length),Kameleoon.Internals.storedData[key]);delete Kameleoon.Internals.storedData[key]}}Kameleoon.Visitor.setupFromStoredDataOLD(false);Kameleoon.Visitor.saveToStoredData();for(var key in Kameleoon.Internals.storedData){if(key.indexOf(Kameleoon.Visitor.STORED_DATA_NAME_PREFIX)==0){delete Kameleoon.Internals.storedData[key]}}}var resetStoredData=false;try{var storedDataVersion=this.obtainFieldFromVisitCookieOrStoredData("storedDataVersion");if((storedDataVersion==null)||(storedDataVersion<this.MIN_STORED_DATA_VERSION)){resetStoredData=true}}catch(error){resetStoredData=true}if(resetStoredData){this.saveFieldToVisitCookieOrStoredData("storedDataVersion",this.SCRIPT_VERSION);this.saveFieldToVisitCookieOrStoredData("visitorCode",undefined);this.saveFieldToVisitCookieOrStoredData("visitNumber",undefined);this.saveFieldToVisitCookieOrStoredData("timeLastActivity",undefined);this.saveFieldToVisitCookieOrStoredData("timeSincePreviousVisit",undefined);this.saveFieldToVisitCookieOrStoredData("visitStaticDataSent",undefined);this.saveFieldToStoredData("weatherTracked",false)}if(Kameleoon.Internals.configuration.Gatherer.enableImagesDetectionCacheTimeoutComputation){Kameleoon.Visitor.setupFromStoredData(false);if(Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout==null){var downloadImage=function(url,cacheParameterValue,callback){var image=new Image();var timeStarted=new Date().getTime();image.onload=function(){var timeEnded=new Date().getTime();callback&&callback(timeEnded-timeStarted)};image.src=url+"?cache="+cacheParameterValue}.bind(this);var cacheParameterValue=new Date().getTime();downloadImage(Kameleoon.Internals.configuration.staticURL+this.IMAGES_DETECTION_TEST_IMAGE,cacheParameterValue,function(timeWithoutCache){downloadImage(Kameleoon.Internals.configuration.staticURL+this.IMAGES_DETECTION_TEST_IMAGE,cacheParameterValue,function(timeWithCache){this.LocalDataHandler.registerAction(function(){Kameleoon.Visitor.setupFromStoredData(false);Kameleoon.Internals.Visitor.imagesDetectionTimeWithoutCache=timeWithoutCache;Kameleoon.Internals.Visitor.imagesDetectionTimeWithCache=timeWithCache;var timeRatio=timeWithoutCache/timeWithCache;if(timeRatio>=6){Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout=2*timeWithCache}else{if(timeRatio>=4){Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout=1.75*timeWithCache}else{if(timeRatio>=2){Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout=1.5*timeWithCache}else{Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout=1.25*timeWithCache}}}Kameleoon.Visitor.saveToStoredData()}.bind(this),false,true,{})}.bind(this))}.bind(this))}}this.saveFieldToTabData("timeStartedPage",new Date().getTime());this.saveFieldToStoredData("startsOfVisitForCurrentPage",0);try{eval(Kameleoon.Internals.configuration.Gatherer.customScriptBefore)}catch(error){}trackPage(function(){scheduleActivityTracking();scheduleInterestsTracking();scheduleCustomDataTracking();if(this.ENABLE_TAB_COUNT){scheduleTabCountTracking()}scheduleNumberClicksTracking()}.bind(this))}.bind(this),false,true,{urgent:true})},trackActivity:function(b){var a=new Date();var c=function(d){this.LocalDataHandler.registerAction(function(){if(b||(!this.obtainVisitIsFinished(a))){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addActivity(a,b);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.configuration.Gatherer.track&&(["full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(a,"event=activity&active="+b,d)}}if(Kameleoon.Internals.activityCallbacks!=null){for(var e=0,g=Kameleoon.Internals.activityCallbacks.length;e<g;++e){try{Kameleoon.Internals.activityCallbacks[e](a,b)}catch(f){}}}}}.bind(this),false,true,{urgent:true})}.bind(this);if(b){this.updateIfStartOfVisit(a,false,function(d){this.LocalDataHandler.registerAction(function(){this.saveFieldToVisitCookieOrStoredData("timeLastActivity",a.getTime());if(d){this.performGoalConversionPredictionsAtStartOfVisit()}c(d)}.bind(this),false,true,{urgent:true})}.bind(this))}else{c(false)}},trackInterests:function(b,a){if(b.length>0){this.LocalDataHandler.registerAction(function(){var e=new Date();if(!this.obtainVisitIsFinished(e)){Kameleoon.Visitor.setupFromStoredData(true);var d=false;for(var g=0;g<b.length;g++){if(!Kameleoon.Visitor.obtainInterestIsActive(b[g])){d=true;break}}Kameleoon.Visitor.addInterests(b,a);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.configuration.Gatherer.track&&(["full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(e,"event=interests&activeInterests="+this.joinAll(b,"-")+"&fresh="+a,false)}}if(Kameleoon.Internals.interestsCallbacks!=null){for(var c=0,h=Kameleoon.Internals.interestsCallbacks.length;c<h;++c){try{Kameleoon.Internals.interestsCallbacks[c](e,b,a)}catch(f){}}}if(d){Kameleoon.Analyst.processAllContainers()}}}.bind(this),false,true,{})}},trackSearch:function(d,c,a){var b=new Date();this.updateIfStartOfVisit(b,false,function(e){this.LocalDataHandler.registerAction(function(){this.saveFieldToVisitCookieOrStoredData("timeLastActivity",b.getTime());if(e){this.performGoalConversionPredictionsAtStartOfVisit()}Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addSearch(b,this.obtainKeyWordsIndexes(d),c,a);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.configuration.Gatherer.track&&(["full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(b,"event=search&keyWords="+this.joinAll(this.obtainKeyWordsIndexes(d),"-")+"&numberResults="+c+"&followed="+a,e)}}if(Kameleoon.Internals.searchCallbacks!=null){for(var f=0,h=Kameleoon.Internals.searchCallbacks.length;f<h;++f){try{Kameleoon.Internals.searchCallbacks[f](b,this.obtainKeyWordsIndexes(d),c,a)}catch(g){}}}}.bind(this),false,true,{urgent:true})}.bind(this))},trackConversions:function(c,a){var b=c.length;if(b>0){this.LocalDataHandler.registerAction(function(){var g=new Date();if(!this.obtainVisitIsFinished(g)){var t=Kameleoon.Internals.configuration.Gatherer.track&&(["light","medium","full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0);(!a)&&Kameleoon.Visitor.setupFromStoredData(true);for(var s=0;s<b;s+=this.MAX_NUMBER_CONVERSIONS_IN_A_REQUEST){var m=Math.min(this.MAX_NUMBER_CONVERSIONS_IN_A_REQUEST,b-s);var r=null;if(t){if(!Kameleoon.Internals.simulationMode){r="event=conversions&number="+m}}for(var p=0;p<m;++p){var l=c[s+p];var o=l.goalId;var d=parseFloat(l.revenue);if(isNaN(d)){this.logDebugMessage("Revenue given = "+l.revenue+"; revenue set to 0.0",this.DEBUG_LEVEL.ERROR,"CustomerError");d=0}Kameleoon.Visitor.addConversion(o,d);if(t){if(!Kameleoon.Internals.simulationMode){r+=("&goalId"+p+"="+o+"&revenue"+p+"="+d)}else{var q="<UNKNOWN>";for(var h=0,f=Kameleoon.Internals.configuration.goals.length;h<f;++h){var u=Kameleoon.Internals.configuration.goals[h];if(o==u.id){q=u.name;break}}console.log('Goal converted "'+q+'"')}}if(Kameleoon.Internals.conversionCallbacks!=null){for(var h=0,f=Kameleoon.Internals.conversionCallbacks.length;h<f;++h){try{Kameleoon.Internals.conversionCallbacks[h](g,o,d)}catch(e){}}}}if(t){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(g,r,false)}}}(!a)&&Kameleoon.Visitor.saveToStoredData()}}.bind(this),(!a)&&false,(!a)&&true,{urgent:true})}},trackMentalistActions:function(a,d,b){var c=a.length;if(c>0){this.LocalDataHandler.registerAction(function(){var h=new Date();if(!this.obtainVisitIsFinished(h)){var r=Kameleoon.Internals.configuration.Gatherer.track&&(["full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0);Kameleoon.Visitor.setupFromStoredData(true);for(var q=0;q<c;q+=this.MAX_NUMBER_MENTALIST_ACTIONS_IN_A_REQUEST){var m=Math.min(this.MAX_NUMBER_MENTALIST_ACTIONS_IN_A_REQUEST,c-q);var p=null;if(r){if(!Kameleoon.Internals.simulationMode){p="event=mentalistActions&number="+m}}for(var o=0;o<m;++o){var u=q+o;var e=a[u];var s=d[u];var t=b[u];Kameleoon.Visitor.addMentalistAction(e,s,t);if(r){if(!Kameleoon.Internals.simulationMode){p+=("&actionTakenIds"+o+"="+this.joinAll(e,"-")+"&actionNotTakenIds"+o+"="+this.joinAll(s,"-")+"&mentalistDecision"+o+"="+t)}}if(Kameleoon.Internals.mentalistActionCallbacks!=null){for(var l=0,g=Kameleoon.Internals.mentalistActionCallbacks.length;l<g;++l){try{Kameleoon.Internals.mentalistActionCallbacks[l](h,e,s,t)}catch(f){}}}}if(r){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(h,p,false)}}}Kameleoon.Visitor.saveToStoredData()}}.bind(this),false,true,{urgent:true})}},trackContainers:function(a,b){if((a.length+b.length)>0){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){var d=function(m,g){var u=m.length;if(u>0){for(var s=0;s<u;s+=this.MAX_NUMBER_CONTAINERS_IN_A_REQUEST){var p=Math.min(this.MAX_NUMBER_CONTAINERS_IN_A_REQUEST,u-s);var r=null;if(g){if(!Kameleoon.Internals.simulationMode){r="event=containers&number="+p}}for(var q=0;q<p;++q){var f=m[s+q];var e=null;var t=null;switch(f.type.toUpperCase()){case"EXPERIMENT":e=Kameleoon.Visitor.addExperiment.bind(Kameleoon.Visitor);t=Kameleoon.Internals.experimentCallbacks;break;case"PERSONALIZATION":e=Kameleoon.Visitor.addPersonalization.bind(Kameleoon.Visitor);t=Kameleoon.Internals.personalizationCallbacks;break}if(e!=null){e(c,f.id,f.variationId,f.mentalistDecision)}if(g){if(!Kameleoon.Internals.simulationMode){r+=("&type"+q+"="+f.type+"&id"+q+"="+f.id+"&variationId"+q+"="+(f.variationId==null?this.REFERENCE_VARIATION_ID_IN_A_REQUEST:f.variationId)+"&mentalistDecision"+q+"="+f.mentalistDecision)}}if(t!=null){for(var o=0,l=t.length;o<l;++o){try{t[o](c,f.id,f.variationId,f.mentalistDecision)}catch(h){}}}}if(g){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(c,r,false)}}}}}.bind(this);Kameleoon.Visitor.setupFromStoredData(true);d(a,Kameleoon.Internals.configuration.Gatherer.track&&(["light","medium","full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0));d(b,false);Kameleoon.Visitor.saveToStoredData()}}.bind(this),false,true,{urgent:true})}},trackWeather:function(c,a,b){if("http:"==window.location.protocol){this.LocalDataHandler.registerAction(function(){if(!this.obtainFieldFromStoredData("weatherTracked")){var d=new Date();if(!this.obtainVisitIsFinished(d)){var e=function(f){this.LocalDataHandler.registerAction(function(){if(!this.obtainVisitIsFinished(d)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addWeather(f.main.temp,f.main.humidity,f.main.pressure,f.wind.speed,f.clouds.all,f.weather&&f.weather[0]?f.weather[0].description:null);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.configuration.Gatherer.track&&(["full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(d,"event=weather&temperature="+f.main.temp+"&humidity="+f.main.humidity+"&pressure="+f.main.pressure+"&windSpeed="+f.wind.speed+"&cloudiness="+f.clouds.all+(f.weather&&f.weather[0]?("&weatherCode="+f.weather[0].description):""),false)}}if(Kameleoon.Internals.weatherCallbacks!=null){for(var g=0,i=Kameleoon.Internals.weatherCallbacks.length;g<i;++g){try{Kameleoon.Internals.weatherCallbacks[g](d,f.main.temp,f.main.humidity,f.main.pressure,f.wind.speed,f.clouds.all,f.weather&&f.weather[0]?f.weather[0].description:null)}catch(h){}}}this.saveFieldToStoredData("weatherTracked",true)}}.bind(this),false,true,{})}.bind(this);Kameleoon.Utils.performBeaconServerCall("//api.openweathermap.org/data/2.5/weather?APPID="+this.OPEN_WEATHER_MAP_APPID+"&lat="+c+"&lon="+a,function(){if(this.readyState==4){if(this.status==200){e(Kameleoon.Utils.JSONParse(this.responseText))}b&&b()}},null)}else{b&&b()}}else{b&&b()}}.bind(this),false,true,{})}else{b&&b()}},trackCustomData:function(d,c,e,b){var a=d.length;if(a>0){this.LocalDataHandler.registerAction(function(){var x=new Date();if(!this.obtainVisitIsFinished(x)){var y=[];var f=[];var p=[];for(var w=0;w<a;w++){var j=d[w];var s=c[w];var z=e[w];if((j!=null)&&(s!=null)){var m=false;if(!m){m=(this.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX==j)}if(!m){m=((!Kameleoon.Internals.configuration.Gatherer.customData[j].constant)||(Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.valueByCustomDatum[j]==null))}if(m){y.push(j);f.push(s);p.push(z)}}}d=y;c=f;e=p;a=d.length;if(a>0){var g=[];var t=0;var h=function(){if(!Kameleoon.Internals.simulationMode){var A="event=customData&indexes="+this.joinAll(g,"-");for(var n=0,i=g.length;n<i;++n){var k=g[n];A+="&value"+k+"="+encodeURIComponent(c[n])+"&overwriteIfCollection"+k+"="+e[n]}this.sendTrackingRequest(x,A,false)}else{for(var n=0,i=g.length;n<i;++n){var k=g[n];var B=Kameleoon.Internals.configuration.Gatherer.customData[k];console.log('Custom data "'+(B?B.name:"<UNKNOWN>")+'": '+c[n])}}}.bind(this);var q=Kameleoon.Internals.configuration.Gatherer.track&&(["medium","full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0);(!b)&&Kameleoon.Visitor.setupFromStoredData(true);for(var w=0;w<a;w++){var j=d[w];var s=c[w];var z=e[w];var o=null;if(this.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX!=j){o=Kameleoon.Internals.configuration.Gatherer.customData[j]}Kameleoon.Visitor.addCustomData(j,s,z);if((this.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX!=j)&&("PAGE"==this.obtainCorrectedCustomDatumScope(o.scope))){this.obtainFieldFromTabData("valueByCustomDatum")[j]=Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.valueByCustomDatum[j]}if((this.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX==j)||(!o.localOnly)){if(q){var u=s.toString().length;if(u<=this.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST){if(t+u<=this.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST){g.push(j);t+=u}else{h();g=[];t=0}}}}if(Kameleoon.Internals.customDatumCallbacks!=null){for(var v=0,r=Kameleoon.Internals.customDatumCallbacks.length;v<r;++v){try{Kameleoon.Internals.customDatumCallbacks[v](x,j,s,z)}catch(l){}}}}(!b)&&Kameleoon.Visitor.saveToStoredData();if(g.length>0){h()}}}}.bind(this),(!b)&&false,(!b)&&Kameleoon.Internals.Gatherer.customDataUpdateNeedsLocalData,{urgent:true})}},trackTabCount:function(a){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addTabCount(a);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.configuration.Gatherer.track&&(["full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(c,"event=tabCount&tabCount="+a,false)}}if(Kameleoon.Internals.tabCountCallbacks!=null){for(var b=0,e=Kameleoon.Internals.tabCountCallbacks.length;b<e;++b){try{Kameleoon.Internals.tabCountCallbacks[b](c,a)}catch(d){}}}}}.bind(this),false,true,{})},trackProductPage:function(a){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addProductPage(a);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.configuration.Gatherer.track&&([].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(c,"event=productPage&productCode="+a,false)}}if(Kameleoon.Internals.productPageCallbacks!=null){for(var b=0,e=Kameleoon.Internals.productPageCallbacks.length;b<e;++b){try{Kameleoon.Internals.productPageCallbacks[b](c,a)}catch(d){}}}}}.bind(this),false,true,{})},trackGeolocation:function(d,b,c,e,a){this.LocalDataHandler.registerAction(function(){var g=new Date();if(!this.obtainVisitIsFinished(g)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addGeolocation(d,b,c,e,a);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.geolocationCallbacks!=null){for(var f=0,i=Kameleoon.Internals.geolocationCallbacks.length;f<i;++f){try{Kameleoon.Internals.geolocationCallbacks[f](g,d,b,c,e,a)}catch(h){}}}}}.bind(this),false,true,{})},trackNumberClicks:function(a){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addNumberClicks(a);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.Internals.configuration.Gatherer.track&&(["full"].indexOf(Kameleoon.Internals.configuration.Gatherer.trackingMode)>=0)){if(!Kameleoon.Internals.simulationMode){this.sendTrackingRequest(c,"event=numberClicks&number="+a,false)}}if(Kameleoon.Internals.numberClicksCallbacks!=null){for(var b=0,e=Kameleoon.Internals.numberClicksCallbacks.length;b<e;++b){try{Kameleoon.Internals.numberClicksCallbacks[b](c,a)}catch(d){}}}}}.bind(this),false,true,{})},sendTrackingRequest:function(c,g,e){if((!Kameleoon.Internals.simulationMode)&&(!Kameleoon.Internals.proxyMode)&&Kameleoon.Internals.configuration.Gatherer.track){var a=this.obtainFieldFromVisitCookieOrStoredData("visitStaticDataSent");var d="&siteCode="+Kameleoon.Internals.configuration.Gatherer.siteCode+"&visitorCode="+this.obtainFieldFromVisitCookieOrStoredData("visitorCode")+"&visitNumber="+this.obtainFieldFromVisitCookieOrStoredData("visitNumber")+"&startOfVisit="+(e===true)+"&keyPages="+this.joinAll(this.obtainKeyPagesIndexes(),"-")+"&referrers="+this.joinAll(this.obtainReferrersIndexes(e),"-")+"&useVisitCookie="+(Kameleoon.Internals.Gatherer.useVisitCookie===true)+"&scriptVersion="+this.SCRIPT_VERSION+"&storedDataVersion="+this.obtainFieldFromVisitCookieOrStoredData("storedDataVersion")+"&time="+c.getTime()+"&timeLastActivity="+this.obtainFieldFromVisitCookieOrStoredData("timeLastActivity");if(!a){d+="&trackingMode="+Kameleoon.Internals.configuration.Gatherer.trackingMode+"&timeSincePreviousVisit="+this.obtainFieldFromVisitCookieOrStoredData("timeSincePreviousVisit")+"&timeZoneGroups="+this.joinAll(this.obtainTimeZoneGroupsIndexes(),"-")+"&language="+this.obtainLanguageIndex()+"&browser="+this.obtainBrowserIndex()+"&browserVersion="+this.obtainBrowserVersion()+"&mobileBrowser="+this.obtainBrowserIsMobile()+"&os="+this.obtainOSIndex()+"&windowWidth="+this.obtainWindowWidth()+"&windowHeight="+this.obtainWindowHeight()+"&screenWidth="+this.obtainScreenWidth()+"&screenHeight="+this.obtainScreenHeight()+"&javaEnabled="+this.obtainJavaEnabled()+"&timeZoneId="+this.obtainTimeZoneId()+"&localeLanguageTag="+this.obtainLocaleLanguageTag()}var b=null;if(!a){var f=function(){this.LocalDataHandler.registerAction(function(){this.saveFieldToVisitCookieOrStoredData("visitStaticDataSent",true)}.bind(this),false,true,{})}.bind(this);b=function(){if((this.readyState==4)&&((this.status==200)||(this.status==204))){f()}}}Kameleoon.Utils.performBeaconServerCall(this.obtainTrackingRequestPrefix()+"publisher-adserver="+encodeURIComponent(Kameleoon.Utils.encodeString(g+d)),b,null)}},updateIfStartOfVisit:function(d,f,j){var h=this.obtainFieldFromVisitCookieOrStoredData("visitNumber");if((h==null)||this.obtainVisitIsFinished(d)){this.saveFieldToStoredData("startsOfVisitForCurrentPage",this.obtainFieldFromStoredData("startsOfVisitForCurrentPage")+1);var c;if(h==null){c=0;h=0}else{c=d.getTime()-this.obtainFieldFromVisitCookieOrStoredData("timeLastActivity");h++}this.saveFieldToVisitCookieOrStoredData("timeSincePreviousVisit",c);this.saveFieldToVisitCookieOrStoredData("visitNumber",h);this.saveFieldToStoredData("weatherTracked",false);if(h==0){var g=(Math.random()<Kameleoon.Internals.configuration.Gatherer.dropRate)?this.DROPPED_VISITOR_CODE:Kameleoon.Utils.obtainRandomString(this.VISITOR_CODE_LENGTH);this.saveFieldToVisitCookieOrStoredData("visitorCode",g);Kameleoon.Visitor.init()}else{Kameleoon.Visitor.setupFromStoredData(false)}var i=Kameleoon.Visit.create(Kameleoon.Internals.configuration.Gatherer.trackingMode,Kameleoon.Internals.configuration.Gatherer.siteCode,this.obtainFieldFromVisitCookieOrStoredData("visitorCode"),d,this.obtainFieldFromVisitCookieOrStoredData("timeSincePreviousVisit"),this.obtainFieldFromVisitCookieOrStoredData("visitNumber"),this.obtainKeyPagesIndexes(),this.obtainReferrersIndexes(true),this.obtainTimeZoneGroupsIndexes(),this.obtainLanguageIndex(),this.obtainBrowserIndex(),this.obtainBrowserVersion(),this.obtainBrowserIsMobile(),this.obtainOSIndex(),this.obtainWindowWidth(),this.obtainWindowHeight(),this.obtainScreenWidth(),this.obtainScreenHeight(),this.obtainJavaEnabled(),this.obtainTimeZoneId(),this.obtainLocaleLanguageTag());Kameleoon.Visitor.addVisit(i);if(!f){Kameleoon.Visitor.addPage(d,this.obtainKeyPagesIndexes(),this.obtainReferrersIndexes(true))}Kameleoon.Visitor.saveToStoredData();window.setTimeout(function(){this.trackVisitorDataFromServerAndPassVisitorScopeData()}.bind(this),this.VISITOR_DATA_FROM_SERVER_TRACKING_TIMEOUT);if(Kameleoon.Internals.startOfVisitCallbacks!=null){for(var e=0,b=Kameleoon.Internals.startOfVisitCallbacks.length;e<b;++e){try{Kameleoon.Internals.startOfVisitCallbacks[e](d,h)}catch(a){}}}j&&j(true)}else{j&&j(false)}},trackVisitorDataFromServerAndPassVisitorScopeData:function(){var a=function(c){if(Kameleoon.Internals.configuration.Gatherer.conversionsHistory||Kameleoon.Internals.configuration.Gatherer.customDataHistory){var b=function(d,f){var e=function(t){if(d.conversions!=null){var w=(t==null?[]:null);for(var o=0,g=d.conversions.length;o<g;++o){var l=d.conversions[o];if(t==null){var h=l.numberConversions;for(var p=0;p<h;++p){w.push({goalId:l.goalId,revenue:l.revenue})}}else{t.addConversions(l.goalId,l.numberConversions,l.revenue)}}if(t==null){this.trackConversions(w,true)}}if(d.customData!=null){var v=Kameleoon.Internals.configuration.Gatherer.customData;var q=v.length;var s=(t==null?[]:null);var u=(t==null?[]:null);var r=(t==null?[]:null);for(var o=0,g=d.customData.length;o<g;++o){var n=d.customData[o];if(t==null){s.push(n.id);u.push(n.value);r.push(true)}else{if(q>n.id){var k=this.obtainCorrectedCustomDatumScope(v[n.id].scope);if("VISITOR"==k){t.addCustomData(n.id,n.value,true)}}}}if(t==null){this.trackCustomData(s,u,r,true)}}}.bind(this);this.LocalDataHandler.registerAction(function(){Kameleoon.Visitor.setupFromStoredData(true);if(Kameleoon.Internals.Visitor.visits.length>1){var j=[];for(var h=0,g=Kameleoon.Internals.Visitor.visits.length-1;h<g;++h){var k=Kameleoon.Internals.Visitor.visits[h];j.push(k);e(k)}Kameleoon.Visitor.changePreviousVisits(j)}e(null);Kameleoon.Visitor.saveToStoredData();f&&f()}.bind(this),false,true,{urgent:true})}.bind(this);Kameleoon.Utils.performBeaconServerCall(this.obtainVisitorDataRequestPrefix()+"siteCode="+Kameleoon.Internals.configuration.Gatherer.siteCode+"&visitorCode="+this.obtainFieldFromVisitCookieOrStoredData("visitorCode")+(Kameleoon.Internals.configuration.Gatherer.conversionsHistory?"&conversions=true":"")+(Kameleoon.Internals.configuration.Gatherer.customDataHistory?"&customData=true":""),function(){if(this.readyState==4){if(this.status==200){var d=Kameleoon.Utils.JSONParse(this.responseText);if(d!=null){b(d,c)}else{c&&c()}}else{c&&c()}}},function(){c&&c()})}else{c&&c()}}.bind(this);a(function(){this.LocalDataHandler.registerAction(function(){if(Kameleoon.Internals.Visitor.visits.length>1){Kameleoon.Visitor.setupFromStoredData(true);var c=Kameleoon.Internals.Visitor.visits[Kameleoon.Internals.Visitor.visits.length-2];var h=[];var k=[];var j=[];var m=Kameleoon.Internals.configuration.Gatherer.customData;for(var g=0,d=m.length;g<d;++g){var f=m[g];if(!f.disabled){var e=this.obtainCorrectedCustomDatumScope(f.scope);if("VISITOR"==e){var b=c.wholeVisitHistory.valueByCustomDatum[g];if(b!=null){h.push(g);k.push(b);j.push(true)}}}}this.trackCustomData(h,k,j,true);Kameleoon.Visitor.saveToStoredData()}}.bind(this),false,true,{urgent:true})}.bind(this))},performGoalConversionPredictionsAtStartOfVisit:function(){if(Kameleoon.Mentalist!=null){var h={};var d=false;for(var c=0,a=Kameleoon.Internals.configuration.goals.length;c<a;++c){var b=Kameleoon.Internals.configuration.goals[c];if(b.mentalistWeight>0){var f=b.id;var e=Kameleoon.Mentalist.computeGoalConversionPredictionAtStartOfVisit(f);if(e!=null){h[f]=e;d=true}}}if(d){var g="0/";for(var f in h){g+=(f+"/");g+=(h[f].probability+"/")}this.trackCustomData([this.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX],[g],[false])}}},obtainCorrectedCustomDatumScope:function(a){if(a==null){a=this.DEFAULT_CUSTOM_DATUM_SCOPE}return a},initializeTabDataIfNecessary:function(){if(Kameleoon.Internals.Gatherer.tabData==null){Kameleoon.Internals.Gatherer.tabData={}}},obtainFieldFromTabData:function(a){return Kameleoon.Internals.Gatherer.tabData[a]},saveFieldToTabData:function(a,b){Kameleoon.Internals.Gatherer.tabData[a]=b},initializeStoredDataIfNecessary:function(){if(Kameleoon.Internals.storedData==null){Kameleoon.Internals.storedData={}}if(Kameleoon.Internals.storedData.Gatherer==null){Kameleoon.Internals.storedData.Gatherer={}}if(Kameleoon.Internals.storedData.Visitor==null){Kameleoon.Internals.storedData.Visitor={}}},obtainFieldFromStoredData:function(a){return Kameleoon.Internals.storedData.Gatherer[a]},saveFieldToStoredData:function(a,b){Kameleoon.Internals.storedData.Gatherer[a]=b},initializeVisitCookieIfNecessary:function(){this.restoreVisitCookie()},obtainFieldFromVisitCookie:function(a){return Kameleoon.Internals.Gatherer.visitCookie[a]},saveFieldToVisitCookie:function(a,b){Kameleoon.Internals.Gatherer.visitCookie[a]=b},restoreVisitCookie:function(){var d=Kameleoon.Utils.readLocalData("kameleoonVisit","COOKIE",false);if(d==null){Kameleoon.Internals.Gatherer.visitCookie={}}else{var a=d.split("/");var c=a.length;Kameleoon.Internals.Gatherer.visitCookie={};var b=0;Kameleoon.Internals.Gatherer.visitCookie.visitorCode=((c>b)&&(a[b].length>0)?a[b]:null);++b;Kameleoon.Internals.Gatherer.visitCookie.visitNumber=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.Gatherer.visitCookie.timeLastActivity=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.Gatherer.visitCookie.storedDataVersion=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.Gatherer.visitCookie.timeSincePreviousVisit=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.Gatherer.visitCookie.visitStaticDataSent=((c>b)&&(a[b].length>0)?(a[b]=="true"):null)}},saveVisitCookie:function(){var a="";if(Kameleoon.Internals.Gatherer.visitCookie.visitorCode!=null){a+=Kameleoon.Internals.Gatherer.visitCookie.visitorCode}a+="/";if(Kameleoon.Internals.Gatherer.visitCookie.visitNumber!=null){a+=Kameleoon.Internals.Gatherer.visitCookie.visitNumber}a+="/";if(Kameleoon.Internals.Gatherer.visitCookie.timeLastActivity!=null){a+=Kameleoon.Internals.Gatherer.visitCookie.timeLastActivity}a+="/";if(Kameleoon.Internals.Gatherer.visitCookie.storedDataVersion!=null){a+=Kameleoon.Internals.Gatherer.visitCookie.storedDataVersion}a+="/";if(Kameleoon.Internals.Gatherer.visitCookie.timeSincePreviousVisit!=null){a+=Kameleoon.Internals.Gatherer.visitCookie.timeSincePreviousVisit}a+="/";if(Kameleoon.Internals.Gatherer.visitCookie.visitStaticDataSent!=null){a+=Kameleoon.Internals.Gatherer.visitCookie.visitStaticDataSent}Kameleoon.Utils.createLocalData("kameleoonVisit",a,365,null,"COOKIE",false,null)},obtainFieldFromVisitCookieOrStoredData:function(a){return Kameleoon.Internals.Gatherer.useVisitCookie?this.obtainFieldFromVisitCookie(a):this.obtainFieldFromStoredData(a)},saveFieldToVisitCookieOrStoredData:function(a,b){if(Kameleoon.Internals.Gatherer.useVisitCookie){this.saveFieldToVisitCookie(a,b)}else{this.saveFieldToStoredData(a,b)}},obtainVisitIsFinished:function(a){var b=a.getTime()-this.MAX_VISIT_IDLE_DURATION;return this.obtainFieldFromVisitCookieOrStoredData("timeLastActivity")<b},obtainTrackingRequestPrefix:function(){var a;switch(Kameleoon.Internals.environment){case"DEVELOPMENT":a=(window.location.protocol=="https:")?8090:8089;break;default:a=(window.location.protocol=="https:")?443:80;break}var b=Kameleoon.Internals.configuration.Gatherer.trackingNodes;return"//"+((b&&b.length)>0?b[0]:Kameleoon.Internals.configuration.Gatherer.siteCode)+".mentalist."+Kameleoon.Internals.DOMAIN+":"+a+"/_.gif?"},obtainVisitsRequestPrefix:function(){var a;switch(Kameleoon.Internals.environment){case"DEVELOPMENT":a=(window.location.protocol=="https:")?8086:8085;break;default:a=(window.location.protocol=="https:")?8443:8080;break}return"//api-visit."+Kameleoon.Internals.DOMAIN+":"+a+"/api-visit/visits?"},obtainVisitorDataRequestPrefix:function(){var a;switch(Kameleoon.Internals.environment){case"DEVELOPMENT":a=(window.location.protocol=="https:")?8086:8085;break;default:a=(window.location.protocol=="https:")?8443:8080;break}return"//api-visit."+Kameleoon.Internals.DOMAIN+":"+a+"/api-visit/visitorData?"},obtainTimeZoneId:function(){return jstz.determine().name()},obtainTimeZoneGroupsIndexes:function(){var b=this.obtainTimeZoneId();var a=[];for(var c=0;c<Kameleoon.Internals.configuration.Gatherer.timeZoneGroups.length;c++){if((!Kameleoon.Internals.configuration.Gatherer.timeZoneGroups[c].disabled)&&this.obtainTimeZoneGroupMatches(Kameleoon.Internals.configuration.Gatherer.timeZoneGroups[c].timeZones,b)){a.push(c)}}if(a.length==0){a.push(null)}return a},obtainTimeZoneGroupMatches:function(d,b){var a=b.toUpperCase();for(var c=0;c<d.length;c++){if(d[c].toUpperCase()==a){return true}}return false},obtainLocaleLanguageTag:function(){var a=null;if(navigator){if(navigator.language){a=navigator.language}else{if(navigator.browserLanguage){a=navigator.browserLanguage}else{if(navigator.systemLanguage){a=navigator.systemLanguage}else{if(navigator.userLanguage){a=navigator.userLanguage}}}}}return a?a:this.DEFAULT_LOCALE_LANGUAGE_TAG},obtainLanguage:function(){var b=this.obtainLocaleLanguageTag();var a=b.indexOf("-");if(a>=0){return b.substring(0,a)}return b},obtainLanguageIndex:function(){var a=this.obtainLanguage().toUpperCase();for(var b=0;b<Kameleoon.Internals.configuration.Gatherer.languages.length;b++){if((!Kameleoon.Internals.configuration.Gatherer.languages[b].disabled)&&(Kameleoon.Internals.configuration.Gatherer.languages[b].code.toUpperCase()==a)){return b}}return null},obtainBrowser:function(){var a=bowser.name;if(a==""){return null}if(("Internet Explorer"==a)||("Microsoft Edge"==a)){return"Explorer"}return a},obtainBrowserIndex:function(){var a=this.obtainBrowser();if(!a){return null}var c=a.toUpperCase();for(var b=0;b<Kameleoon.Internals.configuration.Gatherer.browsers.length;b++){if((!Kameleoon.Internals.configuration.Gatherer.browsers[b].disabled)&&(Kameleoon.Internals.configuration.Gatherer.browsers[b].name.toUpperCase()==c)){return b}}return null},obtainBrowserVersion:function(){var a=bowser.version;if(a==""){return null}return a},obtainBrowserIsMobile:function(){return(bowser.mobile||bowser.tablet)===true},obtainOS:function(){if(bowser.android){return"Android"}if(bowser.ios){return"iOS"}if(bowser.windows){return"Windows"}if(bowser.mac){return"Mac"}if(bowser.linux){return"Linux"}return null},obtainOSIndex:function(){var c=this.obtainOS();if(!c){return null}var a=c.toUpperCase();for(var b=0;b<Kameleoon.Internals.configuration.Gatherer.oss.length;b++){if((!Kameleoon.Internals.configuration.Gatherer.oss[b].disabled)&&(Kameleoon.Internals.configuration.Gatherer.oss[b].name.toUpperCase()==a)){return b}}return null},obtainReferrer:function(){return document.referrer},obtainReferrerIsIgnored:function(d){var c=this.obtainReferrer();if(Kameleoon.Internals.configuration.Gatherer.directNoneReferrerOnlyFirst){if((c=="")&&(!d)){return true}}var e=window.location.pathname;var a=Kameleoon.Internals.configuration.Gatherer.noReferrerPages.length;for(var b=0;b<a;b++){if(e==Kameleoon.Internals.configuration.Gatherer.noReferrerPages[b]){return true}}return false},obtainInternalReferrerIndex:function(f){var d=this.obtainReferrer();if(d==""){return -1}var e=this.parseHostName(d);var b=Kameleoon.Utils.obtainCurrentRootDomain();if((b!=null)&&this.computeIfSuffix(e,b)){return Kameleoon.Internals.configuration.Gatherer.aliasSites.length}if(f){var a=Kameleoon.Internals.configuration.Gatherer.aliasSites.length;for(var c=0;c<a;c++){if(this.computeIfSuffix(e,Kameleoon.Internals.configuration.Gatherer.aliasSites[c])){return c}}}return -1},obtainReferrersIndexes:function(g,b){if(this.obtainReferrerIsIgnored(g)){return[-1]}var h=this.obtainInternalReferrerIndex(true);var c=this.obtainFieldFromStoredData("startsOfVisitForCurrentPage");if((c>1)||((c==1)&&(h>=0))){return[0]}if(h>=0){return[-1]}var f=[];var e=Number.NEGATIVE_INFINITY;for(var d=0;d<Kameleoon.Internals.configuration.Gatherer.referrers.length;d++){if((!Kameleoon.Internals.configuration.Gatherer.referrers[d].disabled)&&this.obtainReferrerMatches(Kameleoon.Internals.configuration.Gatherer.referrers[d])){var a=Kameleoon.Internals.configuration.Gatherer.referrers[d].priority;if(a==null){a=Number.NEGATIVE_INFINITY}if(a>=e){if(a>e){f=[];e=a}f.push(d+1)}}}if(f.length==0){f.push(null)}return f},obtainReferrerMatches:function(c){var a=c.detections;for(var b=0;b<a.length;b++){if(this.obtainReferrerDetectionMatches(a[b])){return true}}return false},obtainReferrerDetectionMatches:function(b){var a=this.obtainReferrerDetectionPartMatches(b.method,b.parameters);if(b.and){a=a&&this.obtainReferrerDetectionPartMatches(b.andMethod,b.andParameters)}return a},obtainReferrerDetectionPartMatches:function(method,parameters){switch(method.toUpperCase()){case"REFERRER_REGEX":return new RegExp(parameters).test(this.obtainReferrer());case"URL_REGEX":var regExp=new RegExp(parameters);return regExp.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())||regExp.test(Kameleoon.Utils.computeCurrentPageCleanRelativeURL());default:try{return eval(parameters)===true}catch(error){return false}}},obtainKeyPagesIndexes:function(){var d=[];for(var c=0,a=Kameleoon.Internals.configuration.Gatherer.keyPages.length;c<a;c++){var e=Kameleoon.Internals.configuration.Gatherer.keyPages[c];if(!e.disabled){var b=new RegExp(e.relativeURLRegExp);if(b.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())||b.test(Kameleoon.Utils.computeCurrentPageCleanRelativeURL())){d.push(c)}}}if(d.length==0){d.push(null)}return d},obtainKeyWordsIndexes:function(e){var d=e.split(new RegExp("\\s+"));var a=((d[0]=="")?1:0);var f=((d[d.length-1]=="")?d.length-2:d.length-1);var b=[];for(var c=a;c<=f;c++){b.push(this.obtainKeyWordIndex(d[c]))}return b},obtainKeyWordIndex:function(b){for(var a=0;a<Kameleoon.Internals.configuration.Gatherer.keyWords.length;a++){if((!Kameleoon.Internals.configuration.Gatherer.keyWords[a].disabled)&&(new RegExp(Kameleoon.Internals.configuration.Gatherer.keyWords[a].wordRegExp,"i").test(b))){return a}}return null},obtainWindowWidth:function(){var a=null;if(document.body&&document.body.offsetWidth){a=document.body.offsetWidth}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){a=document.documentElement.offsetWidth}if(window.innerWidth){a=window.innerWidth}return a},obtainWindowHeight:function(){var a=null;if(document.body&&document.body.offsetHeight){a=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetHeight){a=document.documentElement.offsetHeight}if(window.innerHeight){a=window.innerHeight}return a},obtainScreenWidth:function(){return window.screen.width},obtainScreenHeight:function(){return window.screen.height},obtainJavaEnabled:function(){return navigator.javaEnabled()===true},obtainCustomDatumValueMap:function(customDataIndex){var customDatumValueMap=null;var customDatum=Kameleoon.Internals.configuration.Gatherer.customData[customDataIndex];switch(customDatum.method.toUpperCase()){case"GTM":if(window.dataLayer&&window.dataLayer[0]&&customDatum.gtmVariableName){customDatumValueMap={value:window.dataLayer[0][customDatum.gtmVariableName],overwrite:false}}break;case"TC":if(window.tc_vars&&customDatum.tcVariableName){var tc_var=window.tc_vars[customDatum.tcVariableName];if(""==tc_var){tc_var=null}customDatumValueMap={value:tc_var,overwrite:false}}break;case"CUSTOM_CODE":try{customDatumValueMap=eval("(function() {"+customDatum.customEvalCode+"})();");if(customDatumValueMap.overwrite==null){customDatumValueMap.overwrite=false}}catch(error){}break;default:break}return customDatumValueMap},computeIfSuffix:function(b,c){var a=b.length-c.length;var d=b.indexOf(c,a);return(d>=0)&&(d==a)},computeListHash:function(c){var d=0;for(var b=0;b<c.length;++b){for(var a=0;a<c[b].length;++a){d=((d<<5)-d)+c[b].charCodeAt(a);d=d&d}}return d},joinAll:function(d,c){var a="";if(d.length>0){a+=d[0];for(var b=1;b<d.length;b++){a+=c;a+=d[b]}}return a},parseHostName:function(c){var b=document.createElement("a");b.href=c;return b.hostname},logDebugMessage:function(c,d,a){if(!d){d=this.DEBUG_LEVEL.DEBUG}if(!a){a="CommonLog"}if(d>=Kameleoon.Internals.configuration.Gatherer.debugLevel){if(Kameleoon.Internals.configuration.Gatherer.track){var b="debugMessage="+encodeURIComponent(c)+"&debugLevel="+d+"&debugLog="+a+"&visitNumber="+this.obtainFieldFromVisitCookieOrStoredData("visitNumber")+"&visitorCode="+this.obtainFieldFromVisitCookieOrStoredData("visitorCode")+"&debug=true";Kameleoon.Utils.performBeaconServerCall(this.obtainTrackingRequestPrefix()+b,null,null)}}},LocalDataHandler:{ONE_SHOT_ACTIONS_INTERVAL:1*1000,REPEATED_ACTIONS_INTERVAL:15*1000,init:function(){if(Kameleoon.Internals.Gatherer.LocalDataHandler==null){Kameleoon.Internals.Gatherer.LocalDataHandler={}}Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActions=[];Kameleoon.Internals.Gatherer.LocalDataHandler.repeatedActions=[];Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActionsLastLaunchTime=-this.ONE_SHOT_ACTIONS_INTERVAL;Kameleoon.Internals.Gatherer.LocalDataHandler.repeatedActionsLastLaunchTime=-this.REPEATED_ACTIONS_INTERVAL;Kameleoon.Internals.Gatherer.LocalDataHandler.numberWrites=0;var a=function(){var f=new Date().getTime();var h=false;var e=false;var c=[];if(Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActionsLastLaunchTime+this.ONE_SHOT_ACTIONS_INTERVAL<=f){for(var d=0,b=Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActions.length;d<b;++d){var g=Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActions[d];if(g.restoreLocalData==true){h=true}if(g.saveLocalData==true){e=true}c.push(g.actionFunction)}Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActions=[];Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActionsLastLaunchTime=f}if(Kameleoon.Internals.Gatherer.LocalDataHandler.repeatedActionsLastLaunchTime+this.REPEATED_ACTIONS_INTERVAL<=f){for(var d=0,b=Kameleoon.Internals.Gatherer.LocalDataHandler.repeatedActions.length;d<b;++d){var g=Kameleoon.Internals.Gatherer.LocalDataHandler.repeatedActions[d];if(g.lastRunTime+g.repeatInterval<=f){if(g.restoreLocalData==true){h=true}if(g.saveLocalData==true){e=true}c.push(g.actionFunction);g.lastRunTime=f}}Kameleoon.Internals.Gatherer.LocalDataHandler.repeatedActionsLastLaunchTime=f;h=true}this.launchAction(function(){for(var m=0,j=c.length;m<j;++m){try{c[m]()}catch(k){}}}.bind(this),h,e)}.bind(this);window.setInterval(a,Math.min(this.ONE_SHOT_ACTIONS_INTERVAL,this.REPEATED_ACTIONS_INTERVAL))},registerAction:function(a,e,b,d){if(d.urgent==true){this.launchAction(a,e,b)}else{var c=parseInt(d.repeatInterval);if(isNaN(c)){Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActions.push({actionFunction:a,restoreLocalData:e,saveLocalData:b})}else{if(d.firstRunNow){Kameleoon.Internals.Gatherer.LocalDataHandler.oneShotActions.push({actionFunction:a,restoreLocalData:e,saveLocalData:b})}Kameleoon.Internals.Gatherer.LocalDataHandler.repeatedActions.push({actionFunction:a,restoreLocalData:e,saveLocalData:b,repeatInterval:c,lastRunTime:new Date().getTime()})}}},launchAction:function(a,d,c){var b=function(){a();if(c){this.saveLocalData()}}.bind(this);if(d){this.restoreLocalData(b)}else{b()}},saveLocalData:function(){this.incrementNumberWrites();if(Kameleoon.Internals.Gatherer.useVisitCookie){Kameleoon.Gatherer.saveVisitCookie()}Kameleoon.Utils.saveStoredData(this.decrementNumberWrites.bind(this))},restoreLocalData:function(a){if(Kameleoon.Internals.Gatherer.LocalDataHandler.numberWrites==0){if(Kameleoon.Internals.Gatherer.useVisitCookie){Kameleoon.Gatherer.restoreVisitCookie()}Kameleoon.Utils.restoreStoredData(a)}else{a&&a()}},incrementNumberWrites:function(){Kameleoon.Internals.Gatherer.LocalDataHandler.numberWrites++},decrementNumberWrites:function(){Kameleoon.Internals.Gatherer.LocalDataHandler.numberWrites=Math.max(Kameleoon.Internals.Gatherer.LocalDataHandler.numberWrites-1,0)}}};Kameleoon.Visitor={STORED_DATA_NAME_PREFIX:"Kameleoon.Visitor.",init:function(){if(Kameleoon.Internals.Visitor==null){Kameleoon.Internals.Visitor={}}Kameleoon.Internals.Visitor.visits=[];Kameleoon.Internals.Visitor.currentVisit=null;Kameleoon.Internals.Visitor.totalVisits=0;Kameleoon.Internals.Visitor.timeStartedEldestVisit=null;Kameleoon.Internals.Visitor.imagesDetectionTimeWithoutCache=null;Kameleoon.Internals.Visitor.imagesDetectionTimeWithCache=null;Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout=null;if(Kameleoon.API==null){Kameleoon.API={}}Kameleoon.API.visits=[];Kameleoon.API.firstVisit=null;Kameleoon.API.currentVisit=null;Kameleoon.API.previousVisit=null;if(Kameleoon.API.visitor==null){Kameleoon.API.visitor={}}Kameleoon.API.visitor.totalVisits=Kameleoon.Internals.Visitor.totalVisits;Kameleoon.API.visitor.timeStartedEldestVisit=Kameleoon.Internals.Visitor.timeStartedEldestVisit;Kameleoon.API.visitor.customData={}},addVisit:function(a){Kameleoon.Internals.Visitor.visits.push(a);Kameleoon.Internals.Visitor.currentVisit=a;Kameleoon.Internals.Visitor.totalVisits++;if(Kameleoon.Internals.Visitor.timeStartedEldestVisit==null){Kameleoon.Internals.Visitor.timeStartedEldestVisit=a.timeStarted}this.updateAPIAfterCurrentVisitChange();Kameleoon.API.visitor.totalVisits=Kameleoon.Internals.Visitor.totalVisits;Kameleoon.API.visitor.timeStartedEldestVisit=Kameleoon.Internals.Visitor.timeStartedEldestVisit;var b=Kameleoon.Internals.Visitor.visits.length;var c=Math.max(1,Kameleoon.Internals.configuration.maxNumberLocalVisits);if(b>c){Kameleoon.Internals.Visitor.visits=Kameleoon.Internals.Visitor.visits.slice(b-c);Kameleoon.API.visits=Kameleoon.API.visits.slice(b-c);Kameleoon.API.firstVisit=Kameleoon.API.visits[0];if(c>1){Kameleoon.API.previousVisit=Kameleoon.API.visits[c-2]}else{Kameleoon.API.previousVisit=null}}},changePreviousVisits:function(d){if(Kameleoon.Internals.Visitor.currentVisit!=null){var b=Kameleoon.Internals.Visitor.currentVisit;this.init();for(var c=0,a=d.length;c<a;c++){this.addVisit(d[c])}this.addVisit(b)}},buildPreviousVisitsHistory:function(){var c=Kameleoon.PreviousVisitsHistory.create();for(var b=0,a=Kameleoon.Internals.Visitor.visits.length-1;b<a;++b){c.addVisit(Kameleoon.Internals.Visitor.visits[b])}return c},saveToStoredData:function(){this.saveFieldToStoredData("visits",Kameleoon.Internals.Visitor.visits);this.saveFieldToStoredData("totalVisits",Kameleoon.Internals.Visitor.totalVisits);this.saveFieldToStoredData("timeStartedEldestVisit",Kameleoon.Internals.Visitor.timeStartedEldestVisit);this.saveFieldToStoredData("imagesDetectionTimeWithoutCache",Kameleoon.Internals.Visitor.imagesDetectionTimeWithoutCache);this.saveFieldToStoredData("imagesDetectionTimeWithCache",Kameleoon.Internals.Visitor.imagesDetectionTimeWithCache);this.saveFieldToStoredData("imagesDetectionCacheTimeout",Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout)},setupFromStoredDataOLD:function(e){var a=Kameleoon.Internals.storedData[this.STORED_DATA_NAME_PREFIX+"numberVisits"];this.init();if(a==null){if(e){var f=Kameleoon.Gatherer;var d=Kameleoon.Internals.configuration.Gatherer;var c=Kameleoon.Visit.create(d.trackingMode,d.siteCode,f.obtainFieldFromVisitCookieOrStoredData("visitorCode"),new Date(),0,f.obtainFieldFromVisitCookieOrStoredData("visitNumber"),f.obtainKeyPagesIndexes(),f.obtainReferrersIndexes(true),f.obtainTimeZoneGroupsIndexes(),f.obtainLanguageIndex(),f.obtainBrowserIndex(),f.obtainBrowserVersion(),f.obtainBrowserIsMobile(),f.obtainOSIndex(),f.obtainWindowWidth(),f.obtainWindowHeight(),f.obtainScreenWidth(),f.obtainScreenHeight(),f.obtainJavaEnabled(),f.obtainTimeZoneId(),f.obtainLocaleLanguageTag());this.addVisit(c)}return e}else{for(var b=0;b<a;++b){this.addVisit(Kameleoon.Visit.createFromStoredDataOLD(this.STORED_DATA_NAME_PREFIX+"visit"+b+"."))}Kameleoon.Internals.Visitor.totalVisits=Kameleoon.Internals.storedData[this.STORED_DATA_NAME_PREFIX+"totalVisits"];if(Kameleoon.Internals.Visitor.totalVisits==null){Kameleoon.Internals.Visitor.totalVisits=a;Kameleoon.Internals.Visitor.timeStartedEldestVisit=a>0?Kameleoon.Internals.Visitor.visits[0].timeStarted:null}else{Kameleoon.Internals.Visitor.timeStartedEldestVisit=Kameleoon.Internals.storedData[this.STORED_DATA_NAME_PREFIX+"timeStartedEldestVisit"]}Kameleoon.API.visitor.totalVisits=Kameleoon.Internals.Visitor.totalVisits;Kameleoon.API.visitor.timeStartedEldestVisit=Kameleoon.Internals.Visitor.timeStartedEldestVisit;return false}},setupFromStoredData:function(e){var g=this.obtainFieldFromStoredData("visits");this.init();if(g==null){if(e){var f=Kameleoon.Gatherer;var d=Kameleoon.Internals.configuration.Gatherer;var c=Kameleoon.Visit.create(d.trackingMode,d.siteCode,f.obtainFieldFromVisitCookieOrStoredData("visitorCode"),new Date(),0,f.obtainFieldFromVisitCookieOrStoredData("visitNumber"),f.obtainKeyPagesIndexes(),f.obtainReferrersIndexes(true),f.obtainTimeZoneGroupsIndexes(),f.obtainLanguageIndex(),f.obtainBrowserIndex(),f.obtainBrowserVersion(),f.obtainBrowserIsMobile(),f.obtainOSIndex(),f.obtainWindowWidth(),f.obtainWindowHeight(),f.obtainScreenWidth(),f.obtainScreenHeight(),f.obtainJavaEnabled(),f.obtainTimeZoneId(),f.obtainLocaleLanguageTag());this.addVisit(c)}return e}else{var a=g.length;for(var b=0;b<a;++b){var c=g[b];Kameleoon.Visit.convertVisitFromStoredData(c);this.addVisit(c)}Kameleoon.Internals.Visitor.totalVisits=this.obtainFieldFromStoredData("totalVisits");if(Kameleoon.Internals.Visitor.totalVisits==null){Kameleoon.Internals.Visitor.totalVisits=a;Kameleoon.Internals.Visitor.timeStartedEldestVisit=a>0?Kameleoon.Internals.Visitor.visits[0].timeStarted:null}else{Kameleoon.Internals.Visitor.timeStartedEldestVisit=this.obtainFieldFromStoredData("timeStartedEldestVisit");Kameleoon.Internals.Visitor.imagesDetectionTimeWithoutCache=this.obtainFieldFromStoredData("imagesDetectionTimeWithoutCache");Kameleoon.Internals.Visitor.imagesDetectionTimeWithCache=this.obtainFieldFromStoredData("imagesDetectionTimeWithCache");Kameleoon.Internals.Visitor.imagesDetectionCacheTimeout=this.obtainFieldFromStoredData("imagesDetectionCacheTimeout")}Kameleoon.API.visitor.totalVisits=Kameleoon.Internals.Visitor.totalVisits;Kameleoon.API.visitor.timeStartedEldestVisit=Kameleoon.Internals.Visitor.timeStartedEldestVisit;return false}},obtainFieldFromStoredData:function(a){return Kameleoon.Internals.storedData.Visitor[a]},saveFieldToStoredData:function(a,b){Kameleoon.Internals.storedData.Visitor[a]=b},addPage:function(c,a,b){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addPage(c,a,b);this.updateAPIAfterCurrentVisitChange()}},addActivity:function(a,b){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addActivity(a,b);this.updateAPIAfterCurrentVisitChange()}},addInterests:function(b,a){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addInterests(b,a);this.updateAPIAfterCurrentVisitChange()}},addSearch:function(c,d,b,a){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addSearch(c,d,b,a);this.updateAPIAfterCurrentVisitChange()}},addConversion:function(b,a){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addConversion(b,a);this.updateAPIAfterCurrentVisitChange()}},addMentalistAction:function(b,a,c){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addMentalistAction(b,a,c);this.updateAPIAfterCurrentVisitChange()}},addExperiment:function(a,b,d,c){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addExperiment(a,b,d,c);this.updateAPIAfterCurrentVisitChange()}},addPersonalization:function(b,a,d,c){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addPersonalization(b,a,d,c);this.updateAPIAfterCurrentVisitChange()}},addWeather:function(a,c,e,b,f,d){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addWeather(a,c,e,b,f,d);this.updateAPIAfterCurrentVisitChange()}},addCustomData:function(a,c,b){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addCustomData(a,c,b);this.updateAPIAfterCurrentVisitChange()}},addTabCount:function(a){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addTabCount(a);this.updateAPIAfterCurrentVisitChange()}},addProductPage:function(a){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addProductPage(a);this.updateAPIAfterCurrentVisitChange()}},addGeolocation:function(d,b,c,e,a){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addGeolocation(d,b,c,e,a);this.updateAPIAfterCurrentVisitChange()}},addNumberClicks:function(a){if(Kameleoon.Internals.Visitor.currentVisit!=null){Kameleoon.Internals.Visitor.currentVisit.addNumberClicks(a);this.updateAPIAfterCurrentVisitChange()}},updateAPIAfterCurrentVisitChange:function(){var a=Kameleoon.Internals.Visitor.visits.length;Kameleoon.API.visits[a-1]=Kameleoon.Internals.Visitor.currentVisit.buildVisitForAPI();Kameleoon.API.firstVisit=Kameleoon.API.visits[0];Kameleoon.API.currentVisit=Kameleoon.API.visits[a-1];if(a>1){Kameleoon.API.previousVisit=Kameleoon.API.visits[a-2]}Kameleoon.API.visitor.customData={};for(var d in Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.valueByCustomDatum){if(Kameleoon.Gatherer.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX!=d){var c=Kameleoon.Internals.configuration.Gatherer.customData[d];if("VISITOR"==Kameleoon.Gatherer.obtainCorrectedCustomDatumScope(c.scope)){var g=Kameleoon.Internals.Visitor.currentVisit.wholeVisitHistory.valueByCustomDatum[d];if(c.type=="LIST"){var f=[];for(var e=0,b=g.length;e<b;++e){f.push(g[e].value)}Kameleoon.API.visitor.customData[c.name]=f}else{Kameleoon.API.visitor.customData[c.name]=g}}}}},obtainKeyPageIsVisited:function(c){for(var b=0,a=Kameleoon.Internals.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.Visitor.visits[b].obtainKeyPageIsVisited(c)){return true}}return false},obtainKeyWordIsSearched:function(c){for(var b=0,a=Kameleoon.Internals.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.Visitor.visits[b].obtainKeyWordIsSearched(c)){return true}}return false},obtainInterestIsActive:function(c){for(var b=0,a=Kameleoon.Internals.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.Visitor.visits[b].obtainInterestIsActive(c,null)){return true}}return false},obtainReferrerIsPresent:function(c){for(var b=0,a=Kameleoon.Internals.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.Visitor.visits[b].obtainReferrerIsPresent(c)){return true}}return false},obtainLastVisitWithFreshActiveInterest:function(c){for(var b=Kameleoon.Internals.Visitor.visits.length-1;b>=0;--b){var a=Kameleoon.Internals.Visitor.visits[b];if(a.obtainInterestIsActive(c,true)){return a}}return null},obtainNumberConversions:function(c){var a=0;for(var b=Kameleoon.Internals.Visitor.visits.length-1;b>=0;--b){a+=Kameleoon.Internals.Visitor.visits[b].obtainNumberConversions(c)}return a},obtainContainerIsActive:function(d,h,f,e,c){var a=Kameleoon.Internals.Visitor.visits.length;if(a>0){if(f){if(Kameleoon.Internals.Visitor.visits[a-1][c](d,h)){return true}}if(e){for(var g=0,b=a-1;g<b;++g){if(Kameleoon.Internals.Visitor.visits[g][c](d,h)){return true}}}}return false},obtainExperimentIsActive:function(c,d,b,a){return this.obtainContainerIsActive(c,d,b,a,"obtainExperimentIsActive")},obtainPersonalizationIsActive:function(a,d,c,b){return this.obtainContainerIsActive(a,d,c,b,"obtainPersonalizationIsActive")},obtainContainerNumberActivations:function(g,j,a,c,m,k,d){var e=Kameleoon.Internals.Visitor.visits.length;var h=0;if(e>0){if(m){h+=Kameleoon.Internals.Visitor.visits[e-1][d](g,j,a,c)}if(k){for(var f=0,b=e-1;f<b;++f){h+=Kameleoon.Internals.Visitor.visits[f][d](g,j,a,c)}}}return h},obtainExperimentNumberActivations:function(d,f,e,c,b,a){return this.obtainContainerNumberActivations(d,f,e,c,b,a,"obtainExperimentNumberActivations")},obtainPersonalizationNumberActivations:function(a,f,e,d,c,b){return this.obtainContainerNumberActivations(a,f,e,d,c,b,"obtainPersonalizationNumberActivations")}};Kameleoon.Visit={create:function(v,i,b,r,c,q,j,a,h,n,t,k,l,e,u,g,o,s,d,p,m){var f={};f.trackingMode=v;f.siteCode=i;f.visitorCode=b;f.timeStarted=r.getTime();f.timeLastActivity=r.getTime();f.actionsTakenIds=[];f.actionsNotTakenIds=[];f.actionsTakenIdsWithMentalistDecision={};f.actionsNotTakenIdsWithMentalistDecision={};f.wholeVisitHistory=Kameleoon.VisitHistory.create(r);f.actionTakenHistoryByActionId={};f.actionNotTakenHistoryByActionId={};f.timeSincePreviousVisit=c;f.visitNumber=q;f.landingPages=j;f.firstReferrers=this.replaceReferrersIfInternal(a);f.timeZoneGroups=h;f.language=n;f.browser=t;f.browserVersion=k;f.mobileBrowser=l;f.os=e;f.windowWidth=u;f.windowHeight=g;f.screenWidth=o;f.screenHeight=s;f.javaEnabled=d;f.conversionCountByGoalId={};f.revenueCountByGoalId={};f.variationIdByExperimentId={};f.mentalistDecisionByExperimentId={};f.timesByVariationIdByExperimentId={};f.variationIdByPersonalizationId={};f.mentalistDecisionByPersonalizationId={};f.timesByVariationIdByPersonalizationId={};f.weatherCode=null;f.productPageProductCodes={};f.timeZoneId=p;f.localeLanguageTag=m;f.originalReferrer=document.referrer;f.originalLandingPage=Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL();f.country=null;f.region=null;f.city=null;f.latitude=null;f.longitude=null;this.createBinds(f);return f},createFromStoredDataOLD:function(g){var f=function(i,h){b[i]=Kameleoon.Internals.storedData[g+i];b[i]=(b[i]===undefined?h:b[i])}.bind(this);var b={};f("trackingMode",Kameleoon.Internals.configuration.Gatherer.trackingMode);f("siteCode",Kameleoon.Internals.configuration.Gatherer.siteCode);f("visitorCode","");f("timeStarted",0);f("timeLastActivity",0);f("actionsTakenIds",[]);f("actionsNotTakenIds",[]);f("actionsTakenIdsWithMentalistDecision",{});f("actionsNotTakenIdsWithMentalistDecision",{});b.wholeVisitHistory=Kameleoon.VisitHistory.createFromStoredDataOLD(g+"wholeVisitHistory.");b.actionTakenHistoryByActionId={};for(var d=0,a=b.actionsTakenIds.length;d<a;d++){var c=b.actionsTakenIds[d];b.actionTakenHistoryByActionId[c]=Kameleoon.VisitHistory.createFromStoredDataOLD(g+"actionTakenId"+c+".")}b.actionNotTakenHistoryByActionId={};for(var d=0,a=b.actionsNotTakenIds.length;d<a;d++){var e=b.actionsNotTakenIds[d];b.actionNotTakenHistoryByActionId[e]=Kameleoon.VisitHistory.createFromStoredDataOLD(g+"actionNotTakenId"+e+".")}f("timeSincePreviousVisit",0);f("visitNumber",0);f("landingPages",[null]);f("firstReferrers",[null]);f("timeZoneGroups",[null]);f("language",null);f("browser",null);f("browserVersion",null);f("mobileBrowser",false);f("os",null);f("windowWidth",null);f("windowHeight",null);f("screenWidth",null);f("screenHeight",null);f("javaEnabled",false);f("conversionCountByGoalId",{});f("revenueCountByGoalId",{});f("variationIdByExperimentId",{});f("mentalistDecisionByExperimentId",{});f("timesByVariationIdByExperimentId",{});f("variationIdByPersonalizationId",{});f("mentalistDecisionByPersonalizationId",{});f("timesByVariationIdByPersonalizationId",{});f("weatherCode",null);f("productPageProductCodes",{});f("timeZoneId","UTC");f("localeLanguageTag","en");f("originalReferrer",null);f("originalLandingPage",null);f("country",null);f("region",null);f("city",null);f("latitude",null);f("longitude",null);this.createBinds(b);return b},convertVisitFromStoredData:function(d){var c=function(f,e){d[f]=(d[f]===undefined?e:d[f])}.bind(this);c("trackingMode",Kameleoon.Internals.configuration.Gatherer.trackingMode);c("siteCode",Kameleoon.Internals.configuration.Gatherer.siteCode);c("visitorCode","");c("timeStarted",0);c("timeLastActivity",0);c("actionsTakenIds",[]);c("actionsNotTakenIds",[]);c("actionsTakenIdsWithMentalistDecision",{});c("actionsNotTakenIdsWithMentalistDecision",{});Kameleoon.VisitHistory.convertVisitHistoryFromStoredData(d.wholeVisitHistory);for(var a in d.actionTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromStoredData(d.actionTakenHistoryByActionId[a])}for(var b in d.actionNotTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromStoredData(d.actionNotTakenHistoryByActionId[b])}c("timeSincePreviousVisit",0);c("visitNumber",0);c("landingPages",[null]);c("firstReferrers",[null]);c("timeZoneGroups",[null]);c("language",null);c("browser",null);c("browserVersion",null);c("mobileBrowser",false);c("os",null);c("windowWidth",null);c("windowHeight",null);c("screenWidth",null);c("screenHeight",null);c("javaEnabled",false);c("conversionCountByGoalId",{});c("revenueCountByGoalId",{});c("variationIdByExperimentId",{});c("mentalistDecisionByExperimentId",{});c("timesByVariationIdByExperimentId",{});c("variationIdByPersonalizationId",{});c("mentalistDecisionByPersonalizationId",{});c("timesByVariationIdByPersonalizationId",{});c("weatherCode",null);c("productPageProductCodes",{});c("timeZoneId","UTC");c("localeLanguageTag","en");c("originalReferrer",null);c("originalLandingPage",null);c("country",null);c("region",null);c("city",null);c("latitude",null);c("longitude",null);this.createBinds(d)},convertVisitFromServer:function(f){var e=f.actionsTakenIdsWithMentalistDecision;f.actionsTakenIdsWithMentalistDecision={};for(var c=0,a=e.length;c<a;++c){f.actionsTakenIdsWithMentalistDecision[e[c]]=true}var h=f.actionsNotTakenIdsWithMentalistDecision;f.actionsNotTakenIdsWithMentalistDecision={};for(var c=0,a=h.length;c<a;++c){f.actionsNotTakenIdsWithMentalistDecision[h[c]]=true}Kameleoon.VisitHistory.convertVisitHistoryFromServer(f.wholeVisitHistory);for(var b in f.actionTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromServer(f.actionTakenHistoryByActionId[b])}for(var d in f.actionNotTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromServer(f.actionNotTakenHistoryByActionId[d])}var g=f.productPageProductCodes;f.productPageProductCodes={};for(var c=0,a=g.length;c<a;++c){f.productPageProductCodes[g[c]]=true}this.createBinds(f)},computeReferrersIsInternal:function(a){return(a.length==1)&&(a[0]==-1)},replaceReferrersIfInternal:function(a){if(this.computeReferrersIsInternal(a)){return[null]}return a},addContainer:function(c,f,i,j,g,h,b,a){if((g[f]===undefined)||(a&&(i!=null)&&(g[f]==null))){g[f]=i;h[f]=j}var e=b[f];if(e==null){e={};b[f]=e}var d=e[i];if(d==null){d=[];e[i]=d}d.push(c.getTime())},computeContainerIsActive:function(a,c,b){return(c===b[a])},computeContainerNumberActivations:function(j,m,a,d,b){var k=0;var g=b[j];if(g!=null){var e=g[m];if(e!=null){for(var f=0,c=e.length;f<c;++f){var h=a-e[f];if((h>=0)&&((d==null)||(d<0)||(h<=d))){k++}}}}return k},createBinds:function(a){a.buildVisitForAPI=function(){var f=Kameleoon.Internals.configuration;var d=Kameleoon.Internals.configuration.Gatherer;var n=this.wholeVisitHistory;var h={};h.visitorCode=this.visitorCode;h.timeStarted=this.timeStarted;h.timeLastActivity=this.timeLastActivity;h.timeSincePreviousVisit=this.timeSincePreviousVisit;h.visitNumber=this.visitNumber;if(d.languages.length>0){h.language=(this.language==null)?"<OTHER / UNKNOWN>":d.languages[this.language].code}h.environment={};h.environment.browser=(this.browser==null)?"<OTHER / UNKNOWN>":d.browsers[this.browser].name;h.environment.browserVersion=this.browserVersion;h.environment.mobileBrowser=this.mobileBrowser;h.environment.os=(this.os==null)?"<OTHER / UNKNOWN>":d.oss[this.os].name;h.environment.windowWidth=this.windowWidth;h.environment.windowHeight=this.windowHeight;h.environment.screenWidth=this.screenWidth;h.environment.screenHeight=this.screenHeight;h.environment.timeZone=this.timeZoneId;h.acquisition={};h.acquisition.landingPages=[];for(var s=0,r=this.landingPages.length;s<r;s++){var m=this.landingPages[s];h.acquisition.landingPages.push((m==null)?"<OTHER / UNKNOWN>":d.keyPages[m].name)}h.acquisition.referrers=[];for(var s=0,r=this.firstReferrers.length;s<r;s++){var b=this.firstReferrers[s];h.acquisition.referrers.push((b==null)?"<OTHER / UNKNOWN>":(b==0?"<RESTART>":d.referrers[b-1].name))}h.weather={};h.weather.temperature=n.temperature;h.weather.humidity=n.humidity;h.weather.pressure=n.pressure;h.weather.windSpeed=n.windSpeed;h.weather.cloudiness=n.cloudiness;h.weather.code=this.weatherCode;h.customData={};for(var p in n.valueByCustomDatum){if(Kameleoon.Gatherer.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX!=p){var k=d.customData[p];var z=n.valueByCustomDatum[p];if(k.type=="LIST"){var u=[];for(var s=0,r=z.length;s<r;++s){u.push(z[s].value)}h.customData[k.name]=u}else{h.customData[k.name]=z}}}h.conversions=[];if(f.goals){for(var s=0,r=f.goals.length;s<r;++s){var j=f.goals[s];var c=this.conversionCountByGoalId[j.id];if((c!=null)&&(c>0)){var w=this.revenueCountByGoalId[j.id];if(w==null){w=0}h.conversions.push({goalName:j.name,goalId:j.id,count:c,revenue:w})}}}h.activeExperiments=[];if(f.experiments){for(var s=0,r=f.experiments.length;s<r;++s){var g=f.experiments[s];var t=g.id;var x=g.registeredVariationId;if(x){var o={id:t,name:g.name,variationId:x};var v=Kameleoon.Analyst.findVariation(x);if(v){o.variationName=v.name}if(this.mentalistDecisionByExperimentId[t]){o.mentalistDecision=true}h.activeExperiments.push(o)}}}h.activePersonalizations=[];if(f.personalizations){for(var s=0,r=f.personalizations.length;s<r;++s){var y=f.personalizations[s];var q=y.id;var x=this.variationIdByPersonalizationId[q];if(null!=x){var o={id:q,name:y.name};if(this.mentalistDecisionByPersonalizationId[q]){o.mentalistDecision=true}h.activePersonalizations.push(o)}}}h.productPageProductCodes={};for(var e in this.productPageProductCodes){h.productPageProductCodes[e]=this.productPageProductCodes[e]}h.interests=[];for(var A in n.freshByActiveInterest){h.interests.push(d.interests[A].name)}if(this.originalReferrer!=null){h.acquisition.originalReferrer=this.originalReferrer}if(this.originalLandingPage!=null){h.acquisition.originalLandingPage=this.originalLandingPage}h.geolocation={};if(this.country!=null){h.geolocation.country=this.country}if(this.region!=null){h.geolocation.region=this.region}if(this.city!=null){h.geolocation.city=this.city}if(this.latitude!=null){h.geolocation.latitude=this.latitude}if(this.longitude!=null){h.geolocation.longitude=this.longitude}h.pageViews=n.timesStartedPages.length;h.timeSpent=this.timeLastActivity-this.timeStarted;return h};a.addPage=function(d,b,c){this.addActivity(d,true);this.wholeVisitHistory.addPage(d,b,c)};a.addActivity=function(b,c){if(c){this.timeLastActivity=b.getTime()}this.wholeVisitHistory.addActivity(b,c)};a.addInterests=function(c,b){this.wholeVisitHistory.addInterests(c,b)};a.addSearch=function(d,e,c,b){this.addActivity(d,true);this.wholeVisitHistory.addSearch(d,e,c,b)};a.addConversion=function(c,b){this.addConversions(c,1,b)};a.addConversions=function(g,e,b){var c=this.conversionCountByGoalId[g];if(c==null){c=0}var f=c+e;if(f>0){this.conversionCountByGoalId[g]=f;var d=this.revenueCountByGoalId[g];if(d==null){d=0}this.revenueCountByGoalId[g]=Math.max(0,d+b)}else{delete (this.conversionCountByGoalId[g]);delete (this.revenueCountByGoalId[g])}};a.addMentalistAction=function(c,b,d){this.privateAddMentalistAction(c,d,this.actionsTakenIds,this.actionsTakenIdsWithMentalistDecision,this.actionTakenHistoryByActionId);this.privateAddMentalistAction(b,d,this.actionsNotTakenIds,this.actionsNotTakenIdsWithMentalistDecision,this.actionNotTakenHistoryByActionId)};a.privateAddMentalistAction=function(g,h,c,f,b){for(var e=0,d=g.length;e<d;++e){var j=g[e];if((this.actionTakenHistoryByActionId[j]==null)&&(this.actionNotTakenHistoryByActionId[j]==null)){c.push(j);if(h){f[j]=true}b[j]=Kameleoon.VisitHistory.createCopy(this.wholeVisitHistory)}}};a.addExperiment=function(b,c,e,d){Kameleoon.Visit.addContainer(b,c,e,d,this.variationIdByExperimentId,this.mentalistDecisionByExperimentId,this.timesByVariationIdByExperimentId,false)};a.addPersonalization=function(c,b,e,d){Kameleoon.Visit.addContainer(c,b,e,d,this.variationIdByPersonalizationId,this.mentalistDecisionByPersonalizationId,this.timesByVariationIdByPersonalizationId,true)};a.addWeather=function(b,d,f,c,g,e){this.wholeVisitHistory.addWeather(b,d,f,c,g);if(this.weatherCode==null){this.weatherCode=e}};a.addCustomData=function(b,d,c){this.wholeVisitHistory.addCustomData(b,d,c)};a.addTabCount=function(b){this.wholeVisitHistory.addTabCount(b)};a.addProductPage=function(b){this.productPageProductCodes[b]=true};a.addGeolocation=function(e,c,d,f,b){this.country=e;this.region=c;this.city=d;this.latitude=f;this.longitude=b};a.addNumberClicks=function(b){this.wholeVisitHistory.addNumberClicks(b)};a.obtainKeyPageIsVisited=function(b){return this.wholeVisitHistory.obtainKeyPageIsVisited(b)};a.obtainKeyWordIsSearched=function(b){return this.wholeVisitHistory.obtainKeyWordIsSearched(b)};a.obtainInterestIsActive=function(c,b){return this.wholeVisitHistory.obtainInterestIsActive(c,b)};a.obtainReferrerIsPresent=function(b){return this.wholeVisitHistory.obtainReferrerIsPresent(b)};a.obtainNumberConversions=function(c){var b=this.conversionCountByGoalId[c];return(b==null?0:b)};a.obtainMeanPageDuration=function(){var c=new Date();var b=Kameleoon.OnlineMeanAndDeviation.createFromDifferences(this.wholeVisitHistory.timesStartedPages,false,true,true);b.update([c.getTime()-this.wholeVisitHistory.timesStartedPages[this.wholeVisitHistory.timesStartedPages.length-1]]);return b.mean[0]};a.obtainExperimentIsActive=function(b,c){return Kameleoon.Visit.computeContainerIsActive(b,c,this.variationIdByExperimentId)};a.obtainExperimentNumberActivations=function(c,e,d,b){return Kameleoon.Visit.computeContainerNumberActivations(c,e,d,b,this.timesByVariationIdByExperimentId)};a.obtainPersonalizationIsActive=function(b,c){return Kameleoon.Visit.computeContainerIsActive(b,c,this.variationIdByPersonalizationId)};a.obtainPersonalizationNumberActivations=function(b,e,d,c){return Kameleoon.Visit.computeContainerNumberActivations(b,e,d,c,this.timesByVariationIdByPersonalizationId)}}};Kameleoon.VisitHistory={create:function(b){var a={};a.timesStartedPages=[];a.timesReferrers=[];a.timesSearches=[];a.keyPages=[];a.searchesNumberResults=[];a.searchesFollowed=[];a.timeLastActivity=b.getTime();a.timeLastInactivity=b.getTime();a.referrers=[];a.keyWords=[];a.freshByActiveInterest={};a.maxTabCount=null;a.numberClicks=0;a.temperature=null;a.humidity=null;a.pressure=null;a.windSpeed=null;a.cloudiness=null;a.valueByCustomDatum={};this.createBinds(a);return a},createCopy:function(c){var a={};a.timesStartedPages=c.timesStartedPages.slice(0);a.timesReferrers=c.timesReferrers.slice(0);a.timesSearches=c.timesSearches.slice(0);a.keyPages=[];for(var b=0;b<c.keyPages.length;b++){a.keyPages.push(c.keyPages[b].slice(0))}a.searchesNumberResults=c.searchesNumberResults.slice(0);a.searchesFollowed=c.searchesFollowed.slice(0);a.timeLastActivity=c.timeLastActivity;a.timeLastInactivity=c.timeLastInactivity;a.referrers=[];for(var b=0;b<c.referrers.length;b++){a.referrers.push(c.referrers[b].slice(0))}a.keyWords=[];for(var b=0;b<c.keyWords.length;b++){a.keyWords.push(c.keyWords[b].slice(0))}a.freshByActiveInterest={};for(var b in c.freshByActiveInterest){a.freshByActiveInterest[b]=c.freshByActiveInterest[b]}a.maxTabCount=c.maxTabCount;a.numberClicks=c.numberClicks;a.temperature=c.temperature;a.humidity=c.humidity;a.pressure=c.pressure;a.windSpeed=c.windSpeed;a.cloudiness=c.cloudiness;a.valueByCustomDatum={};for(var b in c.valueByCustomDatum){a.valueByCustomDatum[b]=c.valueByCustomDatum[b]}this.createBinds(a);return a},createFromStoredDataOLD:function(f){var e=function(i,h){a[i]=Kameleoon.Internals.storedData[f+i];a[i]=(a[i]===undefined?h:a[i])}.bind(this);var a={};e("timesStartedPages",[]);e("timesReferrers",[]);e("timesSearches",[]);e("keyPages",[]);var b=a.timesSearches.length;var g=[];var d=[];for(var c=0;c<b;c++){g[c]=0;d[c]=false}e("searchesNumberResults",g);e("searchesFollowed",d);e("timeLastActivity",0);e("timeLastInactivity",0);e("referrers",[]);e("keyWords",[]);e("freshByActiveInterest",{});e("maxTabCount",null);e("numberClicks",null);e("temperature",null);e("humidity",null);e("pressure",null);e("windSpeed",null);e("cloudiness",null);e("valueByCustomDatum",{});this.createBinds(a);return a},convertVisitHistoryFromStoredData:function(a){var e=function(h,g){a[h]=(a[h]===undefined?g:a[h])}.bind(this);e("timesStartedPages",[]);e("timesReferrers",[]);e("timesSearches",[]);e("keyPages",[]);var b=a.timesSearches.length;var f=[];var d=[];for(var c=0;c<b;c++){f[c]=0;d[c]=false}e("searchesNumberResults",f);e("searchesFollowed",d);e("timeLastActivity",0);e("timeLastInactivity",0);e("referrers",[]);e("keyWords",[]);e("freshByActiveInterest",{});e("maxTabCount",null);e("numberClicks",null);e("temperature",null);e("humidity",null);e("pressure",null);e("windSpeed",null);e("cloudiness",null);e("valueByCustomDatum",{});this.createBinds(a)},convertVisitHistoryFromServer:function(a){this.createBinds(a)},mergeCustomDataValueForCollection:function(f,e){if(e!=null){if(e instanceof Array){for(var d=0,b=e.length;d<b;++d){this.mergeCustomDataValueForCollection(f,e[d])}}else{var c,a;if(e.value!=null){c=e.value;a=e.count;if(a==null){a=1}}else{c=e;a=1}this.mergeCountCustomDataValueForCollection(f,c,a)}}},mergeCountCustomDataValueForCollection:function(f,d,c){for(var e=0,b=f.length;e<b;++e){var a=f[e];if(a.value===d){a.count+=c;return}}f.push({value:d,count:c})},createBinds:function(a){a.addPage=function(d,b,c){this.timesStartedPages.push(d.getTime());this.keyPages.push(b);if(this.obtainShouldStoreReferrers(c)){this.timesReferrers.push(d.getTime());this.referrers.push(Kameleoon.Visit.replaceReferrersIfInternal(c));return true}return false};a.obtainShouldStoreReferrers=function(b){return(this.referrers.length==0)||(!Kameleoon.Visit.computeReferrersIsInternal(b))};a.addActivity=function(b,c){if(c){this.timeLastActivity=b.getTime()}else{this.timeLastInactivity=b.getTime()}};a.addInterests=function(e,c){for(var d=0,b=e.length;d<b;d++){this.freshByActiveInterest[e[d]]=c}};a.addSearch=function(d,e,c,b){this.timesSearches.push(d.getTime());this.keyWords.push(e);this.searchesNumberResults.push(c);this.searchesFollowed.push(b)};a.addTabCount=function(b){if((this.maxTabCount==null)||(b>this.maxTabCount)){this.maxTabCount=b}};a.addNumberClicks=function(b){if(this.numberClicks!=null){this.numberClicks+=b}};a.addWeather=function(b,d,e,c,f){if(this.temperature==null){this.temperature=b}if(this.humidity==null){this.humidity=d}if(this.pressure==null){this.pressure=e}if(this.windSpeed==null){this.windSpeed=c}if(this.cloudiness==null){this.cloudiness=f}};a.addCustomData=function(b,f,e){if(f!=null){if(Kameleoon.Gatherer.GOAL_CONVERSION_PREDICTIONS_CUSTOM_DATUM_INDEX!=b){var c=Kameleoon.Internals.configuration.Gatherer.customData[b].type;var d=(c=="LIST")||(c=="COUNT_LIST");if(d){if(e||(this.valueByCustomDatum[b]==null)){this.valueByCustomDatum[b]=[]}Kameleoon.VisitHistory.mergeCustomDataValueForCollection(this.valueByCustomDatum[b],f)}else{this.valueByCustomDatum[b]=f}}else{this.valueByCustomDatum[b]=f}}};a.obtainKeyPageIsVisited=function(g){for(var e=0,c=this.keyPages.length;e<c;e++){var f=this.keyPages[e];for(var d=0,b=f.length;d<b;d++){if(g==f[d]){return true}}}return false};a.obtainKeyWordIsSearched=function(g){for(var e=0,c=this.keyWords.length;e<c;e++){var f=this.keyWords[e];for(var d=0,b=f.length;d<b;d++){if(g==f[d]){return true}}}return false};a.obtainInterestIsActive=function(c,b){if(b==null){return this.freshByActiveInterest[c]!=null}return this.freshByActiveInterest[c]==b};a.obtainReferrerIsPresent=function(f){var g=(f==null?null:f+1);for(var e=0,c=this.referrers.length;e<c;e++){var h=this.referrers[e];for(var d=0,b=h.length;d<b;d++){if(h[d]==g){return true}}}return false}}};Kameleoon.PreviousVisitsHistory={create:function(){var a={};a.timesStartedVisits=[];a.timesLastActivityVisits=[];a.timesStartedPages=[];a.timesReferrers=[];a.timesSearches=[];a.keyPages=[];a.searchesNumberResults=[];a.searchesFollowed=[];a.referrers=[];a.keyWords=[];a.activeInterests={};a.conversionCountByGoalId={};a.revenueCountByGoalId={};a.maxTabCountsVisits=[];a.numberClicksVisits=[];a.temperatureVisits=[];a.humidityVisits=[];a.pressureVisits=[];a.windSpeedVisits=[];a.cloudinessVisits=[];a.valueByCustomDatumVisits=[];this.createBinds(a);return a},createBinds:function(a){a.addVisit=function(e){var f=e.wholeVisitHistory;this.timesStartedVisits.push(e.timeStarted);this.timesLastActivityVisits.push(e.timeLastActivity);this.timesStartedPages=this.timesStartedPages.concat(f.timesStartedPages);this.timesReferrers=this.timesReferrers.concat(f.timesReferrers);this.timesSearches=this.timesSearches.concat(f.timesSearches);this.keyPages=this.keyPages.concat(f.keyPages);this.searchesNumberResults=this.searchesNumberResults.concat(f.searchesNumberResults);this.searchesFollowed=this.searchesFollowed.concat(f.searchesFollowed);this.referrers=this.referrers.concat(f.referrers);this.keyWords=this.keyWords.concat(f.keyWords);for(var d in f.freshByActiveInterest){this.activeInterests[d]=true}for(var g in e.conversionCountByGoalId){var b=this.conversionCountByGoalId[g];if(b==null){b=0}this.conversionCountByGoalId[g]=b+e.conversionCountByGoalId[g]}for(var g in e.revenueCountByGoalId){var c=this.revenueCountByGoalId[g];if(c==null){c=0}this.revenueCountByGoalId[g]=c+e.revenueCountByGoalId[g]}this.maxTabCountsVisits.push(f.maxTabCount);this.numberClicksVisits.push(f.numberClicks);this.temperatureVisits.push(f.temperature);this.humidityVisits.push(f.humidity);this.pressureVisits.push(f.pressure);this.windSpeedVisits.push(f.windSpeed);this.cloudinessVisits.push(f.cloudiness);this.valueByCustomDatumVisits.push(f.valueByCustomDatum)};a.obtainInterestIsActive=function(b){return this.activeInterests[b]}}};Kameleoon.OnlineMeanAndDeviation={create:function(c){var a={};a.dimension=c;a.mean=[];a.m2=[];a.deviation=[];for(var b=0;b<c;++b){a.mean[b]=0;a.m2[b]=0;a.deviation[b]=0}a.numberUpdates=0;this.createBinds(a);return a},createFromDifferences:function(h,j,f,g){var a=this.create(1);var e=h.length;var c=0;if(c<e){var d=h[c];c++;while(c<e){var b=h[c];c++;var k=b-d;if(((k<0)&&j)||((k==0)&&f)||((k>0)&&g)){a.update([k])}d=b}}return a},createFromValues:function(c){var b=this.create(1);for(var d=0,a=c.length;d<a;d++){b.update([c[d]])}return b},createFromBooleanValues:function(c){var b=this.create(1);for(var d=0,a=c.length;d<a;d++){b.update([c[d]?1:0])}return b},createBinds:function(a){a.update=function(b){this.numberUpdates++;for(var c=0;c<this.dimension;++c){var d=b[c]-this.mean[c];this.mean[c]=this.mean[c]+(d/this.numberUpdates);this.m2[c]=this.m2[c]+(d*(b[c]-this.mean[c]));this.deviation[c]=Math.sqrt(this.m2[c]/this.numberUpdates)}}}};
Kameleoon.Internals = {"requestedVariations":{},"configuration":{"siteCode":"r9u0567aww","memberCode":"0","abtestingSetup":true,"variations":[{"name":"Pourcentage en haut","id":119936,"builtCssCodeLevel2":"\n/* START 324121 */\n\n.KameleoonClass324121 {\n\tborder: none !important;\n\tletter-spacing: normal !important;\n\topacity: 1.0 !important;\n\t-ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)\";\n\tfilter: alpha(opacity=100);\n\tbackground-color: transparent !important;\n\tbackground-image: none !important;\n\tcolor: #a2a9ae !important;\n\ttext-align: left !important;\n\tfont-size: 18px !important;\n\tpadding-top: 5px !important;\n\tpadding-bottom: 0px !important;\n\tpadding-left: 15px !important;\n\tpadding-right: 0px !important;\n\tmargin-top: 70px !important;\n\tmargin-bottom: 0px !important;\n\tmargin-left: 0px !important;\n\tmargin-right: 0px !important;\n\tz-index: auto !important;\n}\n\n/* END 324121 */\n\n\n/* START 324123 */\n\n#habillagepub {\n\tborder: none !important;\n\tletter-spacing: normal !important;\n\topacity: 1.0 !important;\n\t-ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)\";\n\tfilter: alpha(opacity=100);\n\tbackground-color: transparent !important;\n\tbackground-image: none !important;\n\tcolor: #16212c !important;\n\tfont-size: 13px !important;\n\tpadding: 0px !important;\n\tmargin: 0px !important;\n\tz-index: auto !important;\n}\n\n/* END 324123 */\n\n\n/* START 324124 */\n\n#teaser_article {\n\tpadding-top: 10px !important;\n\tpadding-bottom: 0px !important;\n\tpadding-left: 0px !important;\n\tpadding-right: 0px !important;\n}\n\n/* END 324124 */\n\n","elementSets":[{"selector":"#teaser_article .normal","options":{"kameleoonClass":324121,"customSelector":true,"domOperation":"INSERT_BEFORE","domReference":"#teaser_article > p:first-child","selector":".KameleoonClass324121"}},{"selector":"#habillagepub","options":{"domOperation":"SWAP","domReference":"#teaser_article > p:first-child + div > div:first-child > figure:first-child > img:first-child + figcaption > h3:first-child + span","selector":"#habillagepub"}},{"selector":"#teaser_article","options":{"selector":"#teaser_article"}}]},{"id":"reference","name":"Reference","builtCssCodeLevel2":"","elementSets":[]}],"experiments":[{"id":30218,"name":"Test bloc article restreint","baseURL":"http://www.lemonde.fr/referendum-sur-le-brexit/article/2016/06/28/brexit-l-inquietante-impreparation-du-vainqueur-boris-johnson_4959301_4872498.html","variations":[{"name":"Reference","id":"reference","deviation":0.4},{"name":"Pourcentage en haut","id":119936,"deviation":0.4}],"experimentContainer":true,"multiVariateTest":false,"executeCodeForReference":true,"atInternetTracking":{"alwaysUseMVTCall":false},"kameleoonTracking":{"mainGoalMasterId":25487,"mainGoalId":25488,"mainGoalName":"clic bloc article restreint","mainGoal":{"id":25488,"name":"clic bloc article restreint","type":"CLICK","multipleConversions":false,"url":null,"matchType":"null","pageViews":null,"timeSpent":null,"mentalistWeight":0.0,"masterGoalId":25487,"experimentId":30218,"selector":{"mode":"ID","value":"teaser_article","context":null,"scopeURL":null,"readableValue":"#teaser_article"},"category":null,"action":null,"attached":false,"attachedGoalId":null,"attachedGoalName":null,"googleAnalyticsEventTracking":false,"universalAnalyticsEventTracking":false,"atInternetEventTracking":false,"adobeOmnitureEventTracking":true,"eulerianEventTracking":true,"webtrendsEventTracking":true,"heatMapEventTracking":true,"kissMetricsEventTracking":true,"piwikEventTracking":true,"crazyEggEventTracking":true,"comScoreEventTracking":true,"reportingScriptEventTracking":true}},"targetingSegment":{"targetingCondition":{"type":"DOM_ELEMENT","disabled":false,"weight":1,"value":"#teaser_article","include":true}}}],"personalizations":[],"disableWhenTimeout":false,"disableVisitWhenTimeout":false,"personalizationsDeviation":1.0,"personalizationSetup":false,"pausedExperiments":[],"geolocation":false,"weather":false,"goals":[{"id":25641,"name":"Clic_lien WE+","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25487,"name":"clic bloc article restreint","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25637,"name":"clic-voir-toutes-les-offres","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25447,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"mentalistWeight":0.0},{"id":25638,"name":"Clic CTA_Hp Abo","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25449,"name":"Confirmation d'achat","type":"URL","multipleConversions":false,"url":"(.*)onestepcheckout/onestep/success/(.*)","mentalistWeight":0.0},{"id":25636,"name":"inscription_resultats_bac_brevet","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":21815,"name":"TestAB::Lig1_Slms","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25454,"name":"test","type":"CUSTOM","multipleConversions":false,"mentalistWeight":0.0},{"id":21814,"name":"Liens_bloc_meme_sujet","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25462,"name":"New event tracker","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25463,"name":"appel_jelec","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25478,"name":"Click_Vacances_Homepage","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0},{"id":25448,"name":"Formulaire achat","type":"URL","multipleConversions":false,"url":"(.*)glm_onestepcheckout/onestep/(.*)","mentalistWeight":0.0},{"id":25488,"name":"clic bloc article restreint","type":"CLICK","multipleConversions":false,"mentalistWeight":0.0,"masterGoalId":25487,"masterGoalName":"clic bloc article restreint","linkedExperimentId":30218},{"id":25490,"name":"Confirmation d'achat","type":"URL","multipleConversions":false,"url":"(.*)onestepcheckout/onestep/success/(.*)","mentalistWeight":0.0,"masterGoalId":25449,"masterGoalName":"Confirmation d'achat","linkedExperimentId":30218},{"id":25489,"name":"Formulaire achat","type":"URL","multipleConversions":false,"url":"(.*)glm_onestepcheckout/onestep/(.*)","mentalistWeight":0.0,"masterGoalId":25448,"masterGoalName":"Formulaire achat","linkedExperimentId":30218}],"checkTestedTrafficActive":false,"trackingScript":"//JavaScript code here;\ntry { var kameleoonEventTrackerCallback25641 = function(event) {  if (window.xt_med) { window.xt_med('C', '', 'Clic_lien+WE%2B', 'A');} Kameleoon.API.processConversion(25641);};Kameleoon.API.runWhenElementPresent('#js-menu-container + div + div > div:first-child > div:first-child > div:first-child + div + div > p:first-child + p > a:first-child', function() { var elements = Kameleoon.Utils.querySelectorAll('#js-menu-container + div + div > div:first-child > div:first-child > div:first-child + div + div > p:first-child + p > a:first-child');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25641, true); }; }, false, null);var kameleoonEventTrackerCallback25487 = function(event) {   Kameleoon.API.processConversion(25487);};Kameleoon.API.runWhenElementPresent('#teaser_article', function() { var elements = Kameleoon.Utils.querySelectorAll('#teaser_article');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25487, true); }; }, false, null);var kameleoonEventTrackerCallback25637 = function(event) {   Kameleoon.API.processConversion(25637);};Kameleoon.API.runWhenElementPresent('.formules-pied', function() { var elements = Kameleoon.Utils.querySelectorAll('.formules-pied');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25637, true); }; }, false, null);var kameleoonEventTrackerCallback25638 = function(event) {   Kameleoon.API.processConversion(25638);};Kameleoon.API.runWhenElementPresent('._action', function() { var elements = Kameleoon.Utils.querySelectorAll('._action');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25638, true); }; }, false, null);var kameleoonEventTrackerCallback25636 = function(event) {   Kameleoon.API.processConversion(25636);};Kameleoon.API.runWhenElementPresent('#js_campus_alertes > div:first-child + div + div + strong + button', function() { var elements = Kameleoon.Utils.querySelectorAll('#js_campus_alertes > div:first-child + div + div + strong + button');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25636, true); }; }, false, null);var kameleoonEventTrackerCallback21815 = function(event) {  if (window.xt_med) { window.xt_med('C', '', 'TestAB%3A%3ALig1_Slms', 'N');} Kameleoon.API.processConversion(21815);};Kameleoon.API.runWhenElementPresent('#teaser_article + script + noscript + aside + aside', function() { var elements = Kameleoon.Utils.querySelectorAll('#teaser_article + script + noscript + aside + aside');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback21815, true); }; }, false, null);var kameleoonEventTrackerCallback21814 = function(event) {  if (window.xt_med) { window.xt_med('C', '48', 'Liens_bloc_meme_sujet', 'N');} Kameleoon.API.processConversion(21814);};Kameleoon.API.runWhenElementPresent('.meme_sujet li a', function() { var elements = Kameleoon.Utils.querySelectorAll('.meme_sujet li a');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback21814, true); }; }, false, null);var kameleoonEventTrackerCallback25462 = function(event) {   Kameleoon.API.processConversion(25462);};Kameleoon.API.runWhenElementPresent('#bt_recrut_abo', function() { var elements = Kameleoon.Utils.querySelectorAll('#bt_recrut_abo');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25462, true); }; }, false, null);var kameleoonEventTrackerCallback25463 = function(event) {  if (window.xt_med) { window.xt_med('C', '', 'appel_jelec', 'A');} Kameleoon.API.processConversion(25463);};Kameleoon.API.runWhenElementPresent('#appel_jelec', function() { var elements = Kameleoon.Utils.querySelectorAll('#appel_jelec');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25463, true); }; }, false, null);var kameleoonEventTrackerCallback25478 = function(event) {   Kameleoon.API.processConversion(25478);};Kameleoon.API.runWhenElementPresent('body.accueil . col_droite #bt_recrut_abo', function() { var elements = Kameleoon.Utils.querySelectorAll('body.accueil . col_droite #bt_recrut_abo');for (var i = 0, l = elements.length; i < l; ++i) { elements[i].addEventListener('mousedown', kameleoonEventTrackerCallback25478, true); }; }, false, null);} catch (exception) { console.log('An error occurred in your custom JavaScript Kameleoon tracking function, please check your code.'); console.log(exception, exception.message); }","sizzle":true,"maxNumberLocalVisits":25,"staticURL":"//static.kameleoon.com/"}};
Kameleoon.Internals.configuration.Gatherer = "eyJzaXRlQ29kZSI6InI5dTA1Njdhd3ciLCJ0cmFja2luZ05vZGVzIjpbXSwidHJhY2tpbmdNb2RlIjoibWVkaXVtIiwiY29udmVyc2lvbnNIaXN0b3J5IjpmYWxzZSwiY3VzdG9tRGF0YUhpc3RvcnkiOmZhbHNlLCJkZWJ1Z0xldmVsIjo0LCJlbmFibGVJbWFnZXNEZXRlY3Rpb25DYWNoZVRpbWVvdXRDb21wdXRhdGlvbiI6ZmFsc2UsImludGVyZXN0cyI6W10sImludGVyZXN0c0ltYWdlc0xpc3RzIjpbXSwidGltZVpvbmVHcm91cHMiOltdLCJsYW5ndWFnZXMiOltdLCJicm93c2VycyI6W3sibmFtZSI6IkNIUk9NRSIsImRpc2FibGVkIjpmYWxzZX0seyJuYW1lIjoiRVhQTE9SRVIiLCJkaXNhYmxlZCI6ZmFsc2V9LHsibmFtZSI6IkZJUkVGT1giLCJkaXNhYmxlZCI6ZmFsc2V9LHsibmFtZSI6IlNBRkFSSSIsImRpc2FibGVkIjpmYWxzZX0seyJuYW1lIjoiT1BFUkEiLCJkaXNhYmxlZCI6ZmFsc2V9XSwib3NzIjpbeyJuYW1lIjoiV0lORE9XUyIsImRpc2FibGVkIjpmYWxzZX0seyJuYW1lIjoiTUFDIiwiZGlzYWJsZWQiOmZhbHNlfSx7Im5hbWUiOiJJT1MiLCJkaXNhYmxlZCI6ZmFsc2V9LHsibmFtZSI6IkxJTlVYIiwiZGlzYWJsZWQiOmZhbHNlfSx7Im5hbWUiOiJBTkRST0lEIiwiZGlzYWJsZWQiOmZhbHNlfV0sImFsaWFzU2l0ZXMiOltdLCJub1JlZmVycmVyUGFnZXMiOltdLCJkaXJlY3ROb25lUmVmZXJyZXJPbmx5Rmlyc3QiOmZhbHNlLCJyZWZlcnJlcnMiOltdLCJrZXlQYWdlcyI6W10sImtleVdvcmRzIjpbXSwidHJhY2siOnRydWUsImZ1bGxUcmFja2luZ01vZGUiOmZhbHNlLCJydW5NZW50YWxpc3QiOmZhbHNlLCJsZWFybmVyV2l0aEhpZGRlbkxheWVyIjpmYWxzZSwiZHJvcFJhdGUiOjAuMCwiY3VzdG9tRGF0YSI6W10sImN1c3RvbVNjcmlwdEJlZm9yZSI6IiJ9";
!function(a,b){this[a]=b()}("bowser",function(){var b=true;function a(f){function j(s){var r=f.match(s);return(r&&r.length>1&&r[1])||""}function n(s){var r=f.match(s);return(r&&r.length>1&&r[2])||""}var p=j(/(ipod|iphone|ipad)/i).toLowerCase(),o=/like android/i.test(f),g=!o&&/android/i.test(f),k=/CrOS/.test(f),h=j(/edge\/(\d+(\.\d+)?)/i),e=j(/version\/(\d+(\.\d+)?)/i),m=/tablet/i.test(f),d=!m&&/[^-]mobi/i.test(f),q;if(/opera|opr/i.test(f)){q={name:"Opera",opera:b,version:e||j(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}}else{if(/yabrowser/i.test(f)){q={name:"Yandex Browser",yandexbrowser:b,version:e||j(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}}else{if(/windows phone/i.test(f)){q={name:"Windows Phone",windowsphone:b};if(h){q.msedge=b;q.version=h}else{q.msie=b;q.version=j(/iemobile\/(\d+(\.\d+)?)/i)}}else{if(/msie|trident/i.test(f)){q={name:"Internet Explorer",msie:b,version:j(/(?:msie |rv:)(\d+(\.\d+)?)/i)}}else{if(k){q={name:"Chrome",chromeBook:b,chrome:b,version:j(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else{if(/chrome.+? edge/i.test(f)){q={name:"Microsoft Edge",msedge:b,version:h}}else{if(/chrome|crios|crmo/i.test(f)){q={name:"Chrome",chrome:b,version:j(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else{if(/sailfish/i.test(f)){q={name:"Sailfish",sailfish:b,version:j(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}}else{if(/seamonkey\//i.test(f)){q={name:"SeaMonkey",seamonkey:b,version:j(/seamonkey\/(\d+(\.\d+)?)/i)}}else{if(/firefox|iceweasel/i.test(f)){q={name:"Firefox",firefox:b,version:j(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)};if(/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(f)){q.firefoxos=b}}else{if(/silk/i.test(f)){q={name:"Amazon Silk",silk:b,version:j(/silk\/(\d+(\.\d+)?)/i)}}else{if(g){q={name:"Android",version:e}}else{if(/phantom/i.test(f)){q={name:"PhantomJS",phantom:b,version:j(/phantomjs\/(\d+(\.\d+)?)/i)}}else{if(/blackberry|\bbb\d+/i.test(f)||/rim\stablet/i.test(f)){q={name:"BlackBerry",blackberry:b,version:e||j(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}}else{if(/(web|hpw)os/i.test(f)){q={name:"WebOS",webos:b,version:e||j(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)};/touchpad\//i.test(f)&&(q.touchpad=b)}else{if(/bada/i.test(f)){q={name:"Bada",bada:b,version:j(/dolfin\/(\d+(\.\d+)?)/i)}}else{if(/tizen/i.test(f)){q={name:"Tizen",tizen:b,version:j(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||e}}else{if(/safari/i.test(f)){q={name:"Safari",safari:b,version:e}}else{q={name:j(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)}}}}}}}}}}}}}}}}}}}if(!q.msedge&&/(apple)?webkit/i.test(f)){q.name=q.name||"Webkit";q.webkit=b;if(!q.version&&e){q.version=e}}else{if(!q.opera&&/gecko\//i.test(f)){q.name=q.name||"Gecko";q.gecko=b;q.version=q.version||j(/gecko\/(\d+(\.\d+)?)/i)}}if(!q.msedge&&(g||q.silk)){q.android=b}else{if(p){q[p]=b;q.ios=b}}var i="";if(q.windowsphone){i=j(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i)}else{if(p){i=j(/os (\d+([_\s]\d+)*) like mac os x/i);i=i.replace(/[_\s]/g,".")}else{if(g){i=j(/android[ \/-](\d+(\.\d+)*)/i)}else{if(q.webos){i=j(/(?:web|hpw)os\/(\d+(\.\d+)*)/i)}else{if(q.blackberry){i=j(/rim\stablet\sos\s(\d+(\.\d+)*)/i)}else{if(q.bada){i=j(/bada\/(\d+(\.\d+)*)/i)}else{if(q.tizen){i=j(/tizen[\/\s](\d+(\.\d+)*)/i)}}}}}}}if(i){q.osversion=i}var l=i.split(".")[0];if(m||p=="ipad"||(g&&(l==3||(l==4&&!d)))||q.silk){q.tablet=b}else{if(d||p=="iphone"||p=="ipod"||g||q.blackberry||q.webos||q.bada){q.mobile=b}}if(q.msedge||(q.msie&&q.version>=10)||(q.yandexbrowser&&q.version>=15)||(q.chrome&&q.version>=20)||(q.firefox&&q.version>=20)||(q.safari&&q.version>=6)||(q.opera&&q.version>=10)||(q.ios&&q.osversion&&q.osversion.split(".")[0]>=6)||(q.blackberry&&q.version>=10.1)){q.a=b}else{if((q.msie&&q.version<10)||(q.chrome&&q.version<20)||(q.firefox&&q.version<20)||(q.safari&&q.version<6)||(q.opera&&q.version<10)||(q.ios&&q.osversion&&q.osversion.split(".")[0]<6)){q.c=b}else{q.x=b}}if(f.indexOf("Win")!=-1){q.windows=true}if(f.indexOf("Mac")!=-1){q.mac=true}if(f.indexOf("Linux")!=-1){q.linux=true}return q}var c=a(typeof navigator!=="undefined"?navigator.userAgent:"");c.test=function(e){for(var f=0;f<e.length;++f){var d=e[f];if(typeof d==="string"){if(d in c){return true}}}return false};c._detect=a;return c});!function(aN){var aM,aL,aK,aI,aH,aG,aF,aE,aC,aB,aA,az,ay,aw,av,au,at,ar,aq,ap="sizzle"+1*new Date,ao=aN.document,an=0,am=0,al=bm(),ak=bm(),bk=bm(),bi=function(d,c){return d===c&&(aA=!0),0},bh=1<<31,bg={}.hasOwnProperty,bf=[],bd=bf.pop,bc=bf.push,ba=bf.push,a9=bf.slice,a8=function(f,e){for(var h=0,g=f.length;g>h;h++){if(f[h]===e){return h}}return -1},a6="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",a5="[\\x20\\t\\r\\n\\f]",a4="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",a3="\\["+a5+"*("+a4+")(?:"+a5+"*([*^$|!~]?=)"+a5+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+a4+"))|)"+a5+"*\\]",a2=":("+a4+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+a3+")*)|.*)\\)|)",a1=new RegExp(a5+"+","g"),aZ=new RegExp("^"+a5+"+|((?:^|[^\\\\])(?:\\\\.)*)"+a5+"+$","g"),aY=new RegExp("^"+a5+"*,"+a5+"*"),aX=new RegExp("^"+a5+"*([>+~]|"+a5+")"+a5+"*"),aW=new RegExp("="+a5+"*([^\\]'\"]*?)"+a5+"*\\]","g"),aV=new RegExp(a2),aU=new RegExp("^"+a4+"$"),aT={ID:new RegExp("^#("+a4+")"),CLASS:new RegExp("^\\.("+a4+")"),TAG:new RegExp("^("+a4+"|[*])"),ATTR:new RegExp("^"+a3),PSEUDO:new RegExp("^"+a2),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+a5+"*(even|odd|(([+-]|)(\\d*)n|)"+a5+"*(?:([+-]|)"+a5+"*(\\d+)|))"+a5+"*\\)|)","i"),bool:new RegExp("^(?:"+a6+")$","i"),needsContext:new RegExp("^"+a5+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+a5+"*((?:-\\d)?\\d*)"+a5+"*\\)|)(?=[^-]|$)","i")},aS=/^(?:input|select|textarea|button)$/i,aR=/^h\d$/i,aQ=/^[^{]+\{\s*\[native \w/,bo=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aP=/[+~]/,bl=/'|\\/g,a0=new RegExp("\\\\([\\da-f]{1,6}"+a5+"?|("+a5+")|.)","ig"),ax=function(f,e,h){var g="0x"+e-65536;return g!==g||h?e:0>g?String.fromCharCode(g+65536):String.fromCharCode(g>>10|55296,1023&g|56320)},ag=function(){az()};try{ba.apply(bf=a9.call(ao.childNodes),ao.childNodes),bf[ao.childNodes.length].nodeType}catch(ac){ba={apply:bf.length?function(d,c){bc.apply(d,a9.call(c))}:function(f,e){var h=f.length,g=0;while(f[h++]=e[g++]){}f.length=h-1}}}function bq(B,z,u,t){var q,p,n,m,i,g,c,D,C,A;if(u=u||[],"string"!=typeof B||!B||z&&(m=z.nodeType)&&1!==m&&9!==m&&11!==m){return u}if(!t&&((z?z.ownerDocument||z:ao)!==ay&&az(z),av)){if(z=z||ay,m=z.nodeType,11!==m&&(q=bo.exec(B))){if(n=q[1]){if(9===m){if(p=z.getElementById(n),!p||!p.parentNode){return u}if(p.id===n){return u.push(p),u}}else{if(z.ownerDocument&&(p=z.ownerDocument.getElementById(n))&&aq(z,p)&&p.id===n){return u.push(p),u}}}else{if(q[2]){return ba.apply(u,z.getElementsByTagName(B)),u}if((n=q[3])&&aL.getElementsByClassName){return ba.apply(u,z.getElementsByClassName(n)),u}}}if(!(!aL.qsa||bk[B+" "]||au&&au.test(B))){if(D=c=ap,C=z,A=1!==m&&B,1===m&&"object"!==z.nodeName.toLowerCase()){g=aG(B),(c=z.getAttribute("id"))?D=c.replace(bl,"\\$&"):z.setAttribute("id",D),D="[id='"+D+"'] ",i=g.length;while(i--){g[i]=D+ae(g[i])}C=aP.test(B)&&aJ(z.parentNode)||z,A=g.join(",")}if(A){try{return ba.apply(u,C.querySelectorAll(A)),u}catch(v){}finally{c||z.removeAttribute("id")}}}}return aE(B.replace(aZ,"$1"),z,u,t)}function bm(){var d=[];function c(b,a){return d.push(b+" ")>aK.cacheLength&&delete c[d.shift()],c[b+" "]=a}return c}function a7(b){return b[ap]=!0,b}function aD(e){var d=ay.createElement("div");try{return !!e(d)}catch(f){return !1}finally{d.parentNode&&d.parentNode.removeChild(d),d=null}}function ah(f,d){var h=f.split("|"),g=f.length;while(g--){aK.attrHandle[h[g]]=d}}function ad(f,e){var h=e&&f,g=h&&1===f.nodeType&&1===e.nodeType&&(~e.sourceIndex||bh)-(~f.sourceIndex||bh);if(g){return g}if(h){while(h=h.nextSibling){if(h===e){return -1}}}return f?1:-1}function br(b){return function(a){var d=a.nodeName.toLowerCase();return"input"===d&&a.type===b}}function bn(b){return function(a){var d=a.nodeName.toLowerCase();return("input"===d||"button"===d)&&a.type===b}}function be(b){return a7(function(a){return a=+a,a7(function(l,k){var j,i=b([],l.length,a),h=i.length;while(h--){l[j=i[h]]&&(l[j]=!(k[j]=l[j]))}})})}function aJ(b){return b&&"undefined"!=typeof b.getElementsByTagName&&b}aL=bq.support={},bq.expando=ap,aH=bq.isXML=function(d){var c=d&&(d.ownerDocument||d).documentElement;return c?"HTML"!==c.nodeName:!1},az=bq.setDocument=function(d){var c,h,f=d?d.ownerDocument||d:ao;return f!==ay&&9===f.nodeType&&f.documentElement?(ay=f,aw=f.documentElement,h=f.defaultView,h&&h!==h.top&&(h.addEventListener?h.addEventListener("unload",ag,!1):h.attachEvent&&h.attachEvent("onunload",ag)),av=!aH(f),aL.attributes=aD(function(b){return b.className="i",!b.getAttribute("className")}),aL.getElementsByTagName=aD(function(b){return b.appendChild(f.createComment("")),!b.getElementsByTagName("*").length}),aL.getElementsByClassName=aQ.test(f.getElementsByClassName),aL.getById=aD(function(b){return aw.appendChild(b).id=ap,!f.getElementsByName||!f.getElementsByName(ap).length}),aL.getById?(aK.find.ID=function(g,e){if("undefined"!=typeof e.getElementById&&av){var i=e.getElementById(g);return i&&i.parentNode?[i]:[]}},aK.filter.ID=function(g){var e=g.replace(a0,ax);return function(b){return b.getAttribute("id")===e}}):(delete aK.find.ID,aK.filter.ID=function(g){var e=g.replace(a0,ax);return function(b){var i="undefined"!=typeof b.getAttributeNode&&b.getAttributeNode("id");return i&&i.value===e}}),aK.find.TAG=aL.getElementsByTagName?function(g,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(g):aL.qsa?e.querySelectorAll(g):void 0}:function(i,g){var m,l=[],k=0,j=g.getElementsByTagName(i);if("*"===i){while(m=j[k++]){1===m.nodeType&&l.push(m)}return l}return j},aK.find.CLASS=aL.getElementsByClassName&&function(g,e){return av?e.getElementsByClassName(g):void 0},at=[],au=[],(aL.qsa=aQ.test(f.querySelectorAll))&&(aD(function(b){aw.appendChild(b).innerHTML="<a id='"+ap+"'></a><select id='"+ap+"-\r\\' msallowcapture=''><option selected=''></option></select>",b.querySelectorAll("[msallowcapture^='']").length&&au.push("[*^$]="+a5+"*(?:''|\"\")"),b.querySelectorAll("[selected]").length||au.push("\\["+a5+"*(?:value|"+a6+")"),b.querySelectorAll("[id~="+ap+"-]").length||au.push("~="),b.querySelectorAll(":checked").length||au.push(":checked"),b.querySelectorAll("a#"+ap+"+*").length||au.push(".#.+[+~]")}),aD(function(g){var e=f.createElement("input");e.setAttribute("type","hidden"),g.appendChild(e).setAttribute("name","D"),g.querySelectorAll("[name=d]").length&&au.push("name"+a5+"*[*^$|!~]?="),g.querySelectorAll(":enabled").length||au.push(":enabled",":disabled"),g.querySelectorAll("*,:x"),au.push(",.*:")})),(aL.matchesSelector=aQ.test(ar=aw.matches||aw.webkitMatchesSelector||aw.mozMatchesSelector||aw.oMatchesSelector||aw.msMatchesSelector))&&aD(function(b){aL.disconnectedMatch=ar.call(b,"div"),ar.call(b,"[s!='']:x"),at.push("!=",a2)}),au=au.length&&new RegExp(au.join("|")),at=at.length&&new RegExp(at.join("|")),c=aQ.test(aw.compareDocumentPosition),aq=c||aQ.test(aw.contains)?function(g,e){var j=9===g.nodeType?g.documentElement:g,i=e&&e.parentNode;return g===i||!(!i||1!==i.nodeType||!(j.contains?j.contains(i):g.compareDocumentPosition&&16&g.compareDocumentPosition(i)))}:function(g,e){if(e){while(e=e.parentNode){if(e===g){return !0}}}return !1},bi=c?function(g,e){if(g===e){return aA=!0,0}var i=!g.compareDocumentPosition-!e.compareDocumentPosition;return i?i:(i=(g.ownerDocument||g)===(e.ownerDocument||e)?g.compareDocumentPosition(e):1,1&i||!aL.sortDetached&&e.compareDocumentPosition(g)===i?g===f||g.ownerDocument===ao&&aq(ao,g)?-1:e===f||e.ownerDocument===ao&&aq(ao,e)?1:aB?a8(aB,g)-a8(aB,e):0:4&i?-1:1)}:function(j,g){if(j===g){return aA=!0,0}var p,o=0,n=j.parentNode,m=g.parentNode,l=[j],k=[g];if(!n||!m){return j===f?-1:g===f?1:n?-1:m?1:aB?a8(aB,j)-a8(aB,g):0}if(n===m){return ad(j,g)}p=j;while(p=p.parentNode){l.unshift(p)}p=g;while(p=p.parentNode){k.unshift(p)}while(l[o]===k[o]){o++}return o?ad(l[o],k[o]):l[o]===ao?-1:k[o]===ao?1:0},f):ay},bq.matches=function(d,c){return bq(d,null,null,c)},bq.matchesSelector=function(f,c){if((f.ownerDocument||f)!==ay&&az(f),c=c.replace(aW,"='$1']"),!(!aL.matchesSelector||!av||bk[c+" "]||at&&at.test(c)||au&&au.test(c))){try{var h=ar.call(f,c);if(h||aL.disconnectedMatch||f.document&&11!==f.document.nodeType){return h}}catch(g){}}return bq(c,ay,null,[f]).length>0},bq.contains=function(d,c){return(d.ownerDocument||d)!==ay&&az(d),aq(d,c)},bq.attr=function(d,c){(d.ownerDocument||d)!==ay&&az(d);var h=aK.attrHandle[c.toLowerCase()],g=h&&bg.call(aK.attrHandle,c.toLowerCase())?h(d,c,!av):void 0;return void 0!==g?g:aL.attributes||!av?d.getAttribute(c):(g=d.getAttributeNode(c))&&g.specified?g.value:null},bq.error=function(b){throw new Error("Syntax error, unrecognized expression: "+b)},bq.uniqueSort=function(g){var c,j=[],i=0,h=0;if(aA=!aL.detectDuplicates,aB=!aL.sortStable&&g.slice(0),g.sort(bi),aA){while(c=g[h++]){c===g[h]&&(i=j.push(h))}while(i--){g.splice(j[i],1)}}return aB=null,g},aI=bq.getText=function(g){var e,j="",i=0,h=g.nodeType;if(h){if(1===h||9===h||11===h){if("string"==typeof g.textContent){return g.textContent}for(g=g.firstChild;g;g=g.nextSibling){j+=aI(g)}}else{if(3===h||4===h){return g.nodeValue}}}else{while(e=g[i++]){j+=aI(e)}}return j},aK=bq.selectors={cacheLength:50,createPseudo:a7,match:aT,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(b){return b[1]=b[1].replace(a0,ax),b[3]=(b[3]||b[4]||b[5]||"").replace(a0,ax),"~="===b[2]&&(b[3]=" "+b[3]+" "),b.slice(0,4)},CHILD:function(b){return b[1]=b[1].toLowerCase(),"nth"===b[1].slice(0,3)?(b[3]||bq.error(b[0]),b[4]=+(b[4]?b[5]+(b[6]||1):2*("even"===b[3]||"odd"===b[3])),b[5]=+(b[7]+b[8]||"odd"===b[3])):b[3]&&bq.error(b[0]),b},PSEUDO:function(e){var d,f=!e[6]&&e[2];return aT.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":f&&aV.test(f)&&(d=aG(f,!0))&&(d=f.indexOf(")",f.length-d)-f.length)&&(e[0]=e[0].slice(0,d),e[2]=f.slice(0,d)),e.slice(0,3))}},filter:{TAG:function(d){var c=d.replace(a0,ax).toLowerCase();return"*"===d?function(){return !0}:function(b){return b.nodeName&&b.nodeName.toLowerCase()===c}},CLASS:function(d){var c=al[d+" "];return c||(c=new RegExp("(^|"+a5+")"+d+"("+a5+"|$)"))&&al(d,function(b){return c.test("string"==typeof b.className&&b.className||"undefined"!=typeof b.getAttribute&&b.getAttribute("class")||"")})},ATTR:function(e,d,f){return function(b){var a=bq.attr(b,e);return null==a?"!="===d:d?(a+="","="===d?a===f:"!="===d?a!==f:"^="===d?f&&0===a.indexOf(f):"*="===d?f&&a.indexOf(f)>-1:"$="===d?f&&a.slice(-f.length)===f:"~="===d?(" "+a.replace(a1," ")+" ").indexOf(f)>-1:"|="===d?a===f||a.slice(0,f.length+1)===f+"-":!1):!0}},CHILD:function(j,i,p,o,n){var m="nth"!==j.slice(0,3),l="last"!==j.slice(-4),k="of-type"===i;return 1===o&&0===n?function(b){return !!b.parentNode}:function(y,x,w){var v,u,t,h,g,f,e=m!==l?"nextSibling":"previousSibling",d=y.parentNode,a=k&&y.nodeName.toLowerCase(),z=!w&&!k;if(d){if(m){while(e){t=y;while(t=t[e]){if(k?t.nodeName.toLowerCase()===a:1===t.nodeType){return !1}}f=e="only"===j&&!f&&"nextSibling"}return !0}if(f=[l?d.firstChild:d.lastChild],l&&z){u=d[ap]||(d[ap]={}),v=u[j]||[],g=v[0]===an&&v[1],h=v[0]===an&&v[2],t=g&&d.childNodes[g];while(t=++g&&t&&t[e]||(h=g=0)||f.pop()){if(1===t.nodeType&&++h&&t===y){u[j]=[an,g,h];break}}}else{if(z&&(v=(y[ap]||(y[ap]={}))[j])&&v[0]===an){h=v[1]}else{while(t=++g&&t&&t[e]||(h=g=0)||f.pop()){if((k?t.nodeName.toLowerCase()===a:1===t.nodeType)&&++h&&(z&&((t[ap]||(t[ap]={}))[j]=[an,h]),t===y)){break}}}}return h-=n,h===o||h%o===0&&h/o>=0}}},PSEUDO:function(f,d){var h,g=aK.pseudos[f]||aK.setFilters[f.toLowerCase()]||bq.error("unsupported pseudo: "+f);return g[ap]?g(d):g.length>1?(h=[f,f,"",d],aK.setFilters.hasOwnProperty(f.toLowerCase())?a7(function(b,k){var j,i=g(b,d),e=i.length;while(e--){j=a8(b,i[e]),b[j]=!(k[j]=i[e])}}):function(b){return g(b,0,h)}):g}},pseudos:{not:a7(function(f){var e=[],h=[],g=aF(f.replace(aZ,"$1"));return g[ap]?a7(function(i,d,n,m){var l,k=g(i,null,m,[]),j=i.length;while(j--){(l=k[j])&&(i[j]=!(d[j]=l))}}):function(b,d,c){return e[0]=b,g(e,null,c,h),e[0]=null,!h.pop()}}),has:a7(function(b){return function(a){return bq(b,a).length>0}}),contains:a7(function(b){return b=b.replace(a0,ax),function(a){return(a.textContent||a.innerText||aI(a)).indexOf(b)>-1}}),lang:a7(function(b){return aU.test(b||"")||bq.error("unsupported lang: "+b),b=b.replace(a0,ax).toLowerCase(),function(a){var d;do{if(d=av?a.lang:a.getAttribute("xml:lang")||a.getAttribute("lang")){return d=d.toLowerCase(),d===b||0===d.indexOf(b+"-")}}while((a=a.parentNode)&&1===a.nodeType);return !1}}),target:function(a){var d=aN.location&&aN.location.hash;return d&&d.slice(1)===a.id},root:function(b){return b===aw},focus:function(b){return b===ay.activeElement&&(!ay.hasFocus||ay.hasFocus())&&!!(b.type||b.href||~b.tabIndex)},enabled:function(b){return b.disabled===!1},disabled:function(b){return b.disabled===!0},checked:function(d){var c=d.nodeName.toLowerCase();return"input"===c&&!!d.checked||"option"===c&&!!d.selected},selected:function(b){return b.parentNode&&b.parentNode.selectedIndex,b.selected===!0},empty:function(b){for(b=b.firstChild;b;b=b.nextSibling){if(b.nodeType<6){return !1}}return !0},parent:function(b){return !aK.pseudos.empty(b)},header:function(b){return aR.test(b.nodeName)},input:function(b){return aS.test(b.nodeName)},button:function(d){var c=d.nodeName.toLowerCase();return"input"===c&&"button"===d.type||"button"===c},text:function(d){var c;return"input"===d.nodeName.toLowerCase()&&"text"===d.type&&(null==(c=d.getAttribute("type"))||"text"===c.toLowerCase())},first:be(function(){return[0]}),last:be(function(d,c){return[c-1]}),eq:be(function(e,d,f){return[0>f?f+d:f]}),even:be(function(e,d){for(var f=0;d>f;f+=2){e.push(f)}return e}),odd:be(function(e,d){for(var f=1;d>f;f+=2){e.push(f)}return e}),lt:be(function(f,e,h){for(var g=0>h?h+e:h;--g>=0;){f.push(g)}return f}),gt:be(function(f,e,h){for(var g=0>h?h+e:h;++g<e;){f.push(g)}return f})}},aK.pseudos.nth=aK.pseudos.eq;for(aM in {radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){aK.pseudos[aM]=br(aM)}for(aM in {submit:!0,reset:!0}){aK.pseudos[aM]=bn(aM)}function ai(){}ai.prototype=aK.filters=aK.pseudos,aK.setFilters=new ai,aG=bq.tokenize=function(t,s){var r,q,p,o,n,m,l,d=ak[t+" "];if(d){return s?0:d.slice(0)}n=t,m=[],l=aK.preFilter;while(n){(!r||(q=aY.exec(n)))&&(q&&(n=n.slice(q[0].length)||n),m.push(p=[])),r=!1,(q=aX.exec(n))&&(r=q.shift(),p.push({value:r,type:q[0].replace(aZ," ")}),n=n.slice(r.length));for(o in aK.filter){!(q=aT[o].exec(n))||l[o]&&!(q=l[o](q))||(r=q.shift(),p.push({value:r,type:o,matches:q}),n=n.slice(r.length))}if(!r){break}}return s?n.length:n?bq.error(t):ak(t,m).slice(0)};function ae(f){for(var e=0,h=f.length,g="";h>e;e++){g+=f[e].value}return g}function bs(h,g,l){var k=g.dir,j=l&&"parentNode"===k,i=am++;return g.first?function(a,e,d){while(a=a[k]){if(1===a.nodeType||j){return h(a,e,d)}}}:function(a,n,m){var f,e,d=[an,i];if(m){while(a=a[k]){if((1===a.nodeType||j)&&h(a,n,m)){return !0}}}else{while(a=a[k]){if(1===a.nodeType||j){if(e=a[ap]||(a[ap]={}),(f=e[k])&&f[0]===an&&f[1]===i){return d[2]=f[2]}if(e[k]=d,d[2]=h(a,n,m)){return !0}}}}}}function bp(b){return b.length>1?function(a,h,g){var f=b.length;while(f--){if(!b[f](a,h,g)){return !1}}return !0}:b[0]}function bj(g,f,j){for(var i=0,h=f.length;h>i;i++){bq(g,f[i],j)}return j}function aO(t,s,r,q,p){for(var o,n=[],m=0,l=t.length,k=null!=s;l>m;m++){(o=t[m])&&(!r||r(o,q,p))&&(n.push(o),k&&s.push(m))}return n}function aj(h,g,l,k,j,i){return k&&!k[ap]&&(k=aj(k)),j&&!j[ap]&&(j=aj(j,i)),a7(function(z,y,x,w){var v,u,t,s=[],e=[],d=y.length,c=z||bj(g||"*",x.nodeType?[x]:x,[]),b=!h||!z&&g?c:aO(c,s,h,x,w),a=l?j||(z?h:d||k)?[]:y:b;if(l&&l(b,a,x,w),k){v=aO(a,e),k(v,[],x,w),u=v.length;while(u--){(t=v[u])&&(a[e[u]]=!(b[e[u]]=t))}}if(z){if(j||h){if(j){v=[],u=a.length;while(u--){(t=a[u])&&v.push(b[u]=t)}j(null,a=[],v,w)}u=a.length;while(u--){(t=a[u])&&(v=j?a8(z,t):s[u])>-1&&(z[v]=!(y[v]=t))}}}else{a=aO(a===y?a.splice(d,a.length):a),j?j(null,y,a,w):ba.apply(y,a)}})}function af(v){for(var u,t,s,r=v.length,q=aK.relative[v[0].type],p=q||aK.relative[" "],o=q?1:0,n=bs(function(b){return b===u},p,!0),j=bs(function(b){return a8(u,b)>-1},p,!0),d=[function(b,h,g){var f=!q&&(g||h!==aC)||((u=h).nodeType?n(b,h,g):j(b,h,g));return u=null,f}];r>o;o++){if(t=aK.relative[v[o].type]){d=[bs(bp(d),t)]}else{if(t=aK.filter[v[o].type].apply(null,v[o].matches),t[ap]){for(s=++o;r>s;s++){if(aK.relative[v[s].type]){break}}return aj(o>1&&bp(d),o>1&&ae(v.slice(0,o-1).concat({value:" "===v[o-2].type?"*":""})).replace(aZ,"$1"),t,s>o&&af(v.slice(o,s)),r>s&&af(v=v.slice(s)),r>s&&ae(v))}d.push(t)}}return bp(d)}function aa(g,d){var j=d.length>0,i=g.length>0,h=function(B,A,z,w,n){var m,e,c,b=0,a="0",H=B&&[],G=[],F=aC,E=B||i&&aK.find.TAG("*",n),D=an+=null==F?1:Math.random()||0.1,C=E.length;for(n&&(aC=A!==ay&&A);a!==C&&null!=(m=E[a]);a++){if(i&&m){e=0,A||(m.ownerDocument||m)===ay||(az(m),A=ay);while(c=g[e++]){if(c(m,A,z)){w.push(m);break}}n&&(an=D)}j&&((m=!c&&m)&&b--,B&&H.push(m))}if(b+=a,j&&a!==b){e=0;while(c=d[e++]){c(H,G,A,z)}if(B){if(b>0){while(a--){H[a]||G[a]||(G[a]=bd.call(w))}}G=aO(G)}ba.apply(w,G),n&&!B&&G.length>0&&b+d.length>1&&bq.uniqueSort(w)}return n&&(an=D,aC=F),H};return j?a7(h):h}aF=bq.compile=function(h,g){var l,k=[],j=[],i=bk[h+" "];if(!i){g||(g=aG(h)),l=g.length;while(l--){i=af(g[l]),i[ap]?k.push(i):j.push(i)}i=bk(h,aa(j,k)),i.selector=h}return i},aE=bq.select=function(v,u,t,s){var r,q,p,h,g,d="function"==typeof v&&v,c=!s&&aG(v=d.selector||v);if(t=t||[],1===c.length){if(q=c[0]=c[0].slice(0),q.length>2&&"ID"===(p=q[0]).type&&aL.getById&&9===u.nodeType&&av&&aK.relative[q[1].type]){if(u=(aK.find.ID(p.matches[0].replace(a0,ax),u)||[])[0],!u){return t}d&&(u=u.parentNode),v=v.slice(q.shift().value.length)}r=aT.needsContext.test(v)?0:q.length;while(r--){if(p=q[r],aK.relative[h=p.type]){break}if((g=aK.find[h])&&(s=g(p.matches[0].replace(a0,ax),aP.test(q[0].type)&&aJ(u.parentNode)||u))){if(q.splice(r,1),v=s.length&&ae(q),!v){return ba.apply(t,s),t}break}}}return(d||aF(v,c))(s,u,!av,t,aP.test(v)&&u&&aJ(u.parentNode)||u),t},aL.sortStable=ap.split("").sort(bi).join("")===ap,aL.detectDuplicates=!!aA,az(),aL.sortDetached=aD(function(b){return 1&b.compareDocumentPosition(ay.createElement("div"))}),aD(function(b){return b.innerHTML="<a href='#'></a>","#"===b.firstChild.getAttribute("href")})||ah("type|href|height|width",function(e,d,f){return f?void 0:e.getAttribute(d,"type"===d.toLowerCase()?1:2)}),aL.attributes&&aD(function(b){return b.innerHTML="<input/>",b.firstChild.setAttribute("value",""),""===b.firstChild.getAttribute("value")})||ah("value",function(e,d,f){return f||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),aD(function(b){return null==b.getAttribute("disabled")})||ah(a6,function(f,e,h){var g;return h?void 0:f[e]===!0?e.toLowerCase():(g=f.getAttributeNode(e))&&g.specified?g.value:null}),("function"==typeof define&&define.amd&&false)?define(function(){return bq}):"undefined"!=typeof module&&module.exports?module.exports=bq:aN.Sizzle=bq}(window);Kameleoon.Analyst.load();}